<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>LEARNING STATISTICS WITH JAMOVI - 13&nbsp; Comparing several means (one-way ANOVA)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./14-Factorial-ANOVA.html" rel="next">
<link href="./12-Correlation-and-linear-regression.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['S$','S$'], ["\\[","\\]"] ]
      processEscapes: true
    }
  });
</script>
    

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="LEARNING STATISTICS WITH JAMOVI - 13&nbsp; Comparing several means (one-way ANOVA)">
<meta property="og:description" content="">
<meta property="og:image" content="https://davidfoxcroft.github.io/lsj-book/images/fig13-1.png">
<meta property="og:site-name" content="LEARNING STATISTICS WITH JAMOVI">
<meta property="og:image:height" content="2813">
<meta property="og:image:width" content="4500">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./10-Categorical-data-analysis.html">Statistical tools</a></li><li class="breadcrumb-item"><a href="./13-Comparing-several-means-one-way-ANOVA.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Comparing several means (one-way ANOVA)</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">LEARNING STATISTICS WITH JAMOVI</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/davidfoxcroft/lsj-book/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./LEARNING-STATISTICS-WITH-JAMOVI.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Beginnings</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Why-do-we-learn-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Why do we learn statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-A-brief-introduction-to-research-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A brief introduction to research design</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">An introduction to jamovi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-Getting-started-with-jamovi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Getting started with jamovi</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Working with data</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-Descriptive-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Descriptive statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-Drawing-graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Drawing graphs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-Pragmatic-matters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Pragmatic matters</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Statistical theory</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Prelude-Part-IV.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prelude</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-Introduction-to-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introduction to probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-Estimating-unknown-quantities-from-a-sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Estimating unknown quantities from a sample</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-Hypothesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Hypothesis testing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Statistical tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Categorical-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Categorical data analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-Comparing-two-means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Comparing two means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-Correlation-and-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Correlation and linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-Comparing-several-means-one-way-ANOVA.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Comparing several means (one-way ANOVA)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-Factorial-ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Factorial ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-Factor-Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Factor Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Endings, alternatives and prospects</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-Bayesian-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Bayesian statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Epilogue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Epilogue</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./References.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./obp-team.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the team</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#an-illustrative-data-set" id="toc-an-illustrative-data-set" class="nav-link active" data-scroll-target="#an-illustrative-data-set"><span class="header-section-number">13.1</span> An illustrative data set</a></li>
  <li><a href="#sec-How-ANOVA-works" id="toc-sec-How-ANOVA-works" class="nav-link" data-scroll-target="#sec-How-ANOVA-works"><span class="header-section-number">13.2</span> How ANOVA works</a>
  <ul class="collapse">
  <li><a href="#two-formulas-for-the-variance-of-y" id="toc-two-formulas-for-the-variance-of-y" class="nav-link" data-scroll-target="#two-formulas-for-the-variance-of-y"><span class="header-section-number">13.2.1</span> Two formulas for the variance of <span class="math inline">\(Y\)</span></a></li>
  <li><a href="#from-variances-to-sums-of-squares" id="toc-from-variances-to-sums-of-squares" class="nav-link" data-scroll-target="#from-variances-to-sums-of-squares"><span class="header-section-number">13.2.2</span> From variances to sums of squares</a></li>
  <li><a href="#from-sums-of-squares-to-the-f-test" id="toc-from-sums-of-squares-to-the-f-test" class="nav-link" data-scroll-target="#from-sums-of-squares-to-the-f-test"><span class="header-section-number">13.2.3</span> From sums of squares to the <span class="math inline">\(F\)</span>-test</a></li>
  <li><a href="#a-worked-example" id="toc-a-worked-example" class="nav-link" data-scroll-target="#a-worked-example"><span class="header-section-number">13.2.4</span> A worked example</a></li>
  </ul></li>
  <li><a href="#running-an-anova-in-jamovi" id="toc-running-an-anova-in-jamovi" class="nav-link" data-scroll-target="#running-an-anova-in-jamovi"><span class="header-section-number">13.3</span> Running an ANOVA in jamovi</a>
  <ul class="collapse">
  <li><a href="#using-jamovi-to-specify-your-anova" id="toc-using-jamovi-to-specify-your-anova" class="nav-link" data-scroll-target="#using-jamovi-to-specify-your-anova"><span class="header-section-number">13.3.1</span> Using jamovi to specify your ANOVA</a></li>
  </ul></li>
  <li><a href="#effect-size" id="toc-effect-size" class="nav-link" data-scroll-target="#effect-size"><span class="header-section-number">13.4</span> Effect size</a></li>
  <li><a href="#multiple-comparisons-and-post-hoc-tests" id="toc-multiple-comparisons-and-post-hoc-tests" class="nav-link" data-scroll-target="#multiple-comparisons-and-post-hoc-tests"><span class="header-section-number">13.5</span> Multiple comparisons and post hoc tests</a>
  <ul class="collapse">
  <li><a href="#running-pairwise-t-tests" id="toc-running-pairwise-t-tests" class="nav-link" data-scroll-target="#running-pairwise-t-tests"><span class="header-section-number">13.5.1</span> Running “pairwise” <span class="math inline">\(t\)</span>-tests</a></li>
  <li><a href="#corrections-for-multiple-testing" id="toc-corrections-for-multiple-testing" class="nav-link" data-scroll-target="#corrections-for-multiple-testing"><span class="header-section-number">13.5.2</span> Corrections for multiple testing</a></li>
  <li><a href="#bonferroni-corrections" id="toc-bonferroni-corrections" class="nav-link" data-scroll-target="#bonferroni-corrections"><span class="header-section-number">13.5.3</span> Bonferroni corrections</a></li>
  <li><a href="#holm-corrections" id="toc-holm-corrections" class="nav-link" data-scroll-target="#holm-corrections"><span class="header-section-number">13.5.4</span> Holm corrections</a></li>
  <li><a href="#writing-up-the-post-hoc-test" id="toc-writing-up-the-post-hoc-test" class="nav-link" data-scroll-target="#writing-up-the-post-hoc-test"><span class="header-section-number">13.5.5</span> Writing up the post hoc test</a></li>
  </ul></li>
  <li><a href="#the-assumptions-of-one-way-anova" id="toc-the-assumptions-of-one-way-anova" class="nav-link" data-scroll-target="#the-assumptions-of-one-way-anova"><span class="header-section-number">13.6</span> The assumptions of one-way ANOVA</a>
  <ul class="collapse">
  <li><a href="#sec-Checking-the-homogeneity-of-variance-assumption" id="toc-sec-Checking-the-homogeneity-of-variance-assumption" class="nav-link" data-scroll-target="#sec-Checking-the-homogeneity-of-variance-assumption"><span class="header-section-number">13.6.1</span> Checking the homogeneity of variance assumption</a></li>
  <li><a href="#running-the-levene-test-in-jamovi" id="toc-running-the-levene-test-in-jamovi" class="nav-link" data-scroll-target="#running-the-levene-test-in-jamovi"><span class="header-section-number">13.6.2</span> Running the Levene test in jamovi</a></li>
  <li><a href="#removing-the-homogeneity-of-variance-assumption" id="toc-removing-the-homogeneity-of-variance-assumption" class="nav-link" data-scroll-target="#removing-the-homogeneity-of-variance-assumption"><span class="header-section-number">13.6.3</span> Removing the homogeneity of variance assumption</a></li>
  <li><a href="#sec-Checking-the-normality-assumption" id="toc-sec-Checking-the-normality-assumption" class="nav-link" data-scroll-target="#sec-Checking-the-normality-assumption"><span class="header-section-number">13.6.4</span> Checking the normality assumption</a></li>
  <li><a href="#removing-the-normality-assumption" id="toc-removing-the-normality-assumption" class="nav-link" data-scroll-target="#removing-the-normality-assumption"><span class="header-section-number">13.6.5</span> Removing the normality assumption</a></li>
  <li><a href="#the-logic-behind-the-kruskal-wallis-test" id="toc-the-logic-behind-the-kruskal-wallis-test" class="nav-link" data-scroll-target="#the-logic-behind-the-kruskal-wallis-test"><span class="header-section-number">13.6.6</span> The logic behind the Kruskal-Wallis test</a></li>
  <li><a href="#additional-details" id="toc-additional-details" class="nav-link" data-scroll-target="#additional-details"><span class="header-section-number">13.6.7</span> Additional details</a></li>
  <li><a href="#how-to-run-the-kruskal-wallis-test-in-jamovi" id="toc-how-to-run-the-kruskal-wallis-test-in-jamovi" class="nav-link" data-scroll-target="#how-to-run-the-kruskal-wallis-test-in-jamovi"><span class="header-section-number">13.6.8</span> How to run the Kruskal-Wallis test in jamovi</a></li>
  </ul></li>
  <li><a href="#repeated-measures-one-way-anova" id="toc-repeated-measures-one-way-anova" class="nav-link" data-scroll-target="#repeated-measures-one-way-anova"><span class="header-section-number">13.7</span> Repeated measures one-way ANOVA</a>
  <ul class="collapse">
  <li><a href="#repeated-measures-anova-in-jamovi" id="toc-repeated-measures-anova-in-jamovi" class="nav-link" data-scroll-target="#repeated-measures-anova-in-jamovi"><span class="header-section-number">13.7.1</span> Repeated measures ANOVA in jamovi</a></li>
  </ul></li>
  <li><a href="#the-friedman-non-parametric-repeated-measures-anova-test" id="toc-the-friedman-non-parametric-repeated-measures-anova-test" class="nav-link" data-scroll-target="#the-friedman-non-parametric-repeated-measures-anova-test"><span class="header-section-number">13.8</span> The Friedman non-parametric repeated measures ANOVA test</a></li>
  <li><a href="#sec-On-the-relationship-between-ANOVA-and-the-Student-t-test" id="toc-sec-On-the-relationship-between-ANOVA-and-the-Student-t-test" class="nav-link" data-scroll-target="#sec-On-the-relationship-between-ANOVA-and-the-Student-t-test"><span class="header-section-number">13.9</span> On the relationship between ANOVA and the Student <span class="math inline">\(t\)</span>-test</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">13.10</span> Summary</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/davidfoxcroft/lsj-book/edit/main/13-Comparing-several-means-one-way-ANOVA.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/davidfoxcroft/lsj-book/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header">
<h1 class="title display-7"><span id="sec-Comparing-several-means-one-way-ANOVA" class="quarto-section-identifier"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Comparing several means (one-way ANOVA)</span></span></h1>

</header>

<p>This chapter introduces one of the most widely used tools in psychological statistics, known as “the analysis of variance”, but usually referred to as ANOVA. The basic technique was developed by Sir Ronald Fisher in the early 20th century and it is to him that we owe the rather unfortunate terminology. The term ANOVA is a little misleading, in two respects. Firstly, although the name of the technique refers to variances, ANOVA is concerned with investigating differences in means. Secondly, there are several different things out there that are all referred to as ANOVAs, some of which have only a very tenuous connection to one another. Later on in the book we’ll encounter a range of different ANOVA methods that apply in quite different situations, but for the purposes of this chapter we’ll only consider the simplest form of ANOVA, in which we have several different groups of observations, and we’re interested in finding out whether those groups differ in terms of some outcome variable of interest. This is the question that is addressed by a one-way ANOVA.</p>
<p>The structure of this chapter is as follows: first I’ll introduce a fictitious data set that we’ll use as a running example throughout the chapter. After introducing the data, I’ll describe the mechanics of how a one-way ANOVA actually works <a href="#sec-How-ANOVA-works">How ANOVA works</a> and then focus on how you can run one in jamovi <a href="#running-an-anova-in-jamovi">Running an ANOVA in jamovi</a>. These two sections are the core of the chapter.</p>
<p>The remainder of the chapter discusses a range of important topics that inevitably arise when running an ANOVA, namely how to calculate effect sizes, post hoc tests and corrections for multiple comparisons and the assumptions that ANOVA relies upon. We’ll also talk about how to check those assumptions and some of the things you can do if the assumptions are violated. Then we’ll cover repeated measures ANOVA.</p>
<section id="an-illustrative-data-set" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="an-illustrative-data-set"><span class="header-section-number">13.1</span> An illustrative data set</h2>
<p>Suppose you’ve become involved in a clinical trial in which you are testing a new antidepressant drug called <em>Joyzepam</em>. In order to construct a fair test of the drug’s effectiveness, the study involves three separate drugs to be administered. One is a placebo, and the other is an existing antidepressant / anti-anxiety drug called <em>Anxifree</em>. A collection of 18 participants with moderate to severe depression are recruited for your initial testing. Because the drugs are sometimes administered in conjunction with psychological therapy, your study includes 9 people undergoing cognitive behavioural therapy (CBT) and 9 who are not. Participants are randomly assigned (doubly blinded, of course) a treatment, such that there are 3 CBT people and 3 no-therapy people assigned to each of the 3 drugs. A psychologist assesses the mood of each person after a 3-month run with each drug, and the overall improvement in each person’s mood is assessed on a scale ranging from <span class="math inline">\(-5\)</span> to <span class="math inline">\(+5\)</span>. With that as the study design, let’s now load up the data file in <em>clinicaltrial.csv</em> . We can see that this data set contains the three variables drug, therapy and mood.gain.</p>
<p>For the purposes of this chapter, what we’re really interested in is the effect of drug on mood.gain. The first thing to do is calculate some descriptive statistics and draw some graphs. In the <a href="04-Descriptive-statistics.html"><span>Chapter&nbsp;4</span></a> chapter we showed you how to do this, and some of the descriptive statistics we can calculate in jamovi are shown in <a href="#fig-fig13-1">Figure&nbsp;<span>13.1</span></a>. As the plot makes clear, there is a larger improvement in mood for participants in the Joyzepam group than for either the Anxifree group or the placebo group. The Anxifree group shows a larger mood gain than the control group, but the difference isn’t as large. The question that we want to answer is are these difference “real”, or are they just due to chance?</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-1" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig13-1.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi screenshot displaying clinical trial results. The interface shows variable selection, descriptive statistics with mean and standard deviation for mood gain across three drugs, and a box plot graph comparing the mood gain for each drug."></p>
<figcaption class="figure-caption">Figure&nbsp;13.1. Descriptives for mood gain, and box plots by drug administered</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-How-ANOVA-works" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="sec-How-ANOVA-works"><span class="header-section-number">13.2</span> How ANOVA works</h2>
<p>In order to answer the question posed by our clinical trial data we’re going to run a one-way ANOVA. I’m going to start by showing you how to do it the hard way, building the statistical tool from the ground up and showing you how you could do it if you didn’t have access to any of the cool built-in ANOVA functions in jamovi. And I hope you’ll read it carefully, try to do it the long way once or twice to make sure you really understand how ANOVA works.</p>
<p>The experimental design that I described in the previous section strongly suggests that we’re interested in comparing the average mood change for the three different drugs. In that sense, we’re talking about an analysis similar to the <span class="math inline">\(t\)</span>-test (see <a href="11-Comparing-two-means.html"><span>Chapter&nbsp;11</span></a>) but involving more than two groups. If we let <span class="math inline">\(\mu_P\)</span> denote the population mean for the mood change induced by the placebo, and let <span class="math inline">\(\mu_A\)</span> and <span class="math inline">\(\mu_J\)</span> denote the corresponding means for our two drugs, Anxifree and Joyzepam, then the (somewhat pessimistic) null hypothesis that we want to test is that all three population means are identical. That is, neither of the two drugs is any more effective than a placebo. We can write out this null hypothesis as:</p>
<p><span class="math display">\[H_0: \text{ it is true that } \mu_P=\mu_A=\mu_J\]</span></p>
<p>As a consequence, our alternative hypothesis is that at least one of the three different treatments is different from the others. It’s a bit tricky to write this mathematically, because (as we’ll discuss) there are quite a few different ways in which the null hypothesis can be false. So for now we’ll just write the alternative hypothesis like this:</p>
<p><span class="math display">\[H_1: \text{ it } \underline{ is \text{ } not } \text{ true that } \mu_P=\mu_A=\mu_J\]</span></p>
<p>This null hypothesis is a lot trickier to test than any of the ones we’ve seen previously. Given the title of this chapter, a sensible guess for how to test this would be to “do an ANOVA”, but it’s not particularly clear why “analysis of variances” will help us learn anything useful about the means. In fact, this is one of the biggest conceptual difficulties that people have when first encountering ANOVA. To see how this works, let’s start by talking about variances, specifically between group variability and within-group variability (<a href="#fig-fig13-2">Figure&nbsp;<span>13.2</span></a>).</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-2" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="13-Comparing-several-means-one-way-ANOVA_files/figure-html/fig-fig13-2-1.png" class="img-fluid figure-img" style="width:80.0%" alt="Two graphs. (a) &quot;Between-group variation&quot; shows three overlapping bell curves for groups 1, 2, and 3 with horizontal arrows between peaks. (b) &quot;Within-group variation&quot; has three same-position bell curves with horizontal arrows within each curve's peak."></p>
<figcaption class="figure-caption">Figure&nbsp;13.2. Graphical illustration of “between groups” variation (panel (a)) and “within groups” variation (panel (b)). On the left the arrows show the differences in the group means. On the right the arrows highlight the variability within each group</figcaption>
</figure>
</div>
</div>
</div>
<section id="two-formulas-for-the-variance-of-y" class="level3" data-number="13.2.1">
<h3 data-number="13.2.1" class="anchored" data-anchor-id="two-formulas-for-the-variance-of-y"><span class="header-section-number">13.2.1</span> Two formulas for the variance of <span class="math inline">\(Y\)</span></h3>
<p>First, let’s start by introducing some notation. We’ll use <span class="math inline">\(G\)</span> to refer to the total number of groups. For our data set there are three drugs, so there are <span class="math inline">\(G = 3\)</span> groups. Next, we’ll use <span class="math inline">\(N\)</span> to refer to the total sample size; there are a total of <span class="math inline">\(N = 18\)</span> people in our data set. Similarly, let’s use <span class="math inline">\(N_k\)</span> to denote the number of people in the <span class="math inline">\(k\)</span>-th group. In our fake clinical trial, the sample size is <span class="math inline">\(N_k = 6\)</span> for all three groups.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Finally, we’ll use <span class="math inline">\(Y\)</span> to denote the outcome variable. In our case, <span class="math inline">\(Y\)</span> refers to mood change. Specifically, we’ll use <span class="math inline">\(Y_{ik}\)</span> to refer to the mood change experienced by the <span class="math inline">\(i\)</span>-th member of the <span class="math inline">\(k\)</span>-th group. Similarly, we’ll use <span class="math inline">\(\bar{Y}\)</span> to be the average mood change, taken across all 18 people in the experiment, and <span class="math inline">\(\bar{Y}_k\)</span> to refer to the average mood change experienced by the 6 people in group <span class="math inline">\(k\)</span>.</p>
<p>Now that we’ve got our notation sorted out we can start writing down formulas. To start with, let’s recall the formula for the variance that we used in <a href="04-Descriptive-statistics.html#sec-Measures-of-variability"><span>Section&nbsp;4.2</span></a>, way back in those kinder days when we were just doing descriptive statistics. The sample variance of <span class="math inline">\(Y\)</span> is defined as follows: <span class="math display">\[Var(Y)=\frac{1}{N}\sum_{k=1}^{G}\sum_{i=1}^{N_k}(Y_{ik}-\bar{Y})^2\]</span> This formula looks pretty much identical to the formula for the variance in <a href="04-Descriptive-statistics.html#sec-Measures-of-variability"><span>Section&nbsp;4.2</span></a>. The only difference is that this time around I’ve got two summations here: I’m summing over groups (i.e., values for <span class="math inline">\(k\)</span>) and over the people within the groups (i.e., values for <span class="math inline">\(i\)</span>). This is purely a cosmetic detail. If I’d instead used the notation <span class="math inline">\(Y_p\)</span> to refer to the value of the outcome variable for person <span class="math inline">\(p\)</span> in the sample, then I’d only have a single summation. The only reason that we have a double summation here is that I’ve classified people into groups, and then assigned numbers to people within groups.</p>
<p>A concrete example might be useful here. Let’s consider <a href="#tbl-tab13-1">Table&nbsp;<span>13.1</span></a>, in which we have a total of <span class="math inline">\(N = 5\)</span> people sorted into <span class="math inline">\(G = 2\)</span> groups. Arbitrarily, let’s say that the “cool” people are group 1 and the “uncool” people are group 2. It turns out that we have three cool people (<span class="math inline">\(N_1 = 3\)</span>) and two uncool people (<span class="math inline">\(N_2 = 2\)</span>).</p>
<p>Notice that I’ve constructed two different labelling schemes here. We have a “person” variable <span class="math inline">\(p\)</span> so it would be perfectly sensible to refer to <span class="math inline">\(Y_p\)</span> as the grumpiness of the <span class="math inline">\(p\)</span>-th person in the sample. For instance, the table shows that Tim is the fourth so we’d say <span class="math inline">\(p = 4\)</span>. So, when talking about the grumpiness <span class="math inline">\(Y\)</span> of this “Tim” person, whoever he might be, we could refer to his grumpiness by saying that <span class="math inline">\(Y_p = 91\)</span>, for person <span class="math inline">\(p = 4\)</span>.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-1" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab13-1"><caption>Table&nbsp;13.1.  <p>Grumpiness for people in cool and uncool groups</p> </caption>
<colgroup><col><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">name</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">person \(P\)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">group</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">group num. \(k\)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">index in group</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">grumpiness \( Y_{ik} \) or \( Y_p \)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Ann</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">cool</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">20</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Ben</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">cool</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">55</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Cat</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">cool</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">21</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Tim</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">uncool</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">91</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Egg</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">uncool</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">22</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>However, that’s not the only way we could refer to Tim. As an alternative we could note that Tim belongs to the “uncool” group (<span class="math inline">\(k = 2\)</span>), and is in fact the first person listed in the uncool group (<span class="math inline">\(i = 1\)</span>). So it’s equally valid to refer to Tim’s grumpiness by saying that <span class="math inline">\(Y_{ik} = 91\)</span>, where <span class="math inline">\(k = 2\)</span> and <span class="math inline">\(i = 1\)</span>. In other words, each person <span class="math inline">\(p\)</span> corresponds to a unique <span class="math inline">\(ik\)</span> combination, and so the formula that I gave above is actually identical to our original formula for the variance, which would be:</p>
<p><span class="math display">\[Var(Y)=\frac{1}{N}\sum_{p=1}^{N}(Y_p-\bar{Y})^2\]</span></p>
<p>In both formulas, all we’re doing is summing over all of the observations in the sample. Most of the time we would just use the simpler <span class="math inline">\(Y_p\)</span> notation; the equation using <span class="math inline">\(Y_p\)</span> is clearly the simpler of the two. However, when doing an ANOVA it’s important to keep track of which participants belong in which groups, and we need to use the <span class="math inline">\(Y_{ik}\)</span> notation to do this.</p>
</section>
<section id="from-variances-to-sums-of-squares" class="level3" data-number="13.2.2">
<h3 data-number="13.2.2" class="anchored" data-anchor-id="from-variances-to-sums-of-squares"><span class="header-section-number">13.2.2</span> From variances to sums of squares</h3>
<p>Okay, now that we’ve got a good grasp on how the variance is calculated, let’s define something called the <strong>total sum of squares</strong>, which is denoted <span class="math inline">\(SStot\)</span>. This is very simple. Instead of averaging the squared deviations, which is what we do when calculating the variance, we just add them up.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>When we talk about analysing variances in the context of ANOVA, what we’re really doing is working with the total sums of squares rather than the actual variance.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>Next, we can define a third notion of variation which captures only the differences between groups. We do this by looking at the differences between the group means <span class="math inline">\(\bar{Y}_k\)</span> and grand mean <span class="math inline">\(\bar{Y}\)</span>.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>It’s not too difficult to show that the total variation among people in the experiment <span class="math inline">\(SS_{tot}\)</span> is actually the sum of the differences between the groups <span class="math inline">\(SS_b\)</span> and the variation inside the groups <span class="math inline">\(SS_w\)</span>. That is:</p>
<p><span class="math display">\[SS_w+SS_b=SS_{tot}\]</span></p>
<p>Okay, so what have we found out? We’ve discovered that the total variability associated with the outcome variable (<span class="math inline">\(SS_{tot}\)</span>) can be mathematically carved up into the sum of “the variation due to the differences in the sample means for the different groups” (<span class="math inline">\(SS_b\)</span>) plus “all the rest of the variation” (<span class="math inline">\(SS_w\)</span>).<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>How does that help me find out whether the groups have different population means? Um. Wait. Hold on a second. Now that I think about it, this is exactly what we were looking for. If the null hypothesis is true then you’d expect all the sample means to be pretty similar to each other, right? And that would imply that you’d expect <span class="math inline">\(SS_b\)</span> to be really small, or at least you’d expect it to be a lot smaller than “the variation associated with everything else”, <span class="math inline">\(SS_w\)</span>. Hmm. I detect a hypothesis test coming on.</p>
</section>
<section id="from-sums-of-squares-to-the-f-test" class="level3" data-number="13.2.3">
<h3 data-number="13.2.3" class="anchored" data-anchor-id="from-sums-of-squares-to-the-f-test"><span class="header-section-number">13.2.3</span> From sums of squares to the <span class="math inline">\(F\)</span>-test</h3>
<p>As we saw in the last section, the qualitative idea behind ANOVA is to compare the two sums of squares values <span class="math inline">\(SS_b\)</span> and <span class="math inline">\(SS_w\)</span> to each other. If the between-group variation <span class="math inline">\(SS_b\)</span> is large relative to the within-group variation <span class="math inline">\(SS_w\)</span> then we have reason to suspect that the population means for the different groups aren’t identical to each other. In order to convert this into a workable hypothesis test, there’s a little bit of “fiddling around” needed. What I’ll do is first show you what we do to calculate our test statistic, the <strong><span class="math inline">\(F\)</span>-ratio</strong>, and then try to give you a feel for why we do it this way.</p>
<p>In order to convert our <span class="math inline">\(SS\)</span> values into an <span class="math inline">\(F\)</span>-ratio the first thing we need to calculate is the <strong>degrees of freedom</strong> associated with the <span class="math inline">\(SS_b\)</span> and <span class="math inline">\(SS_w\)</span> values. As usual, the degrees of freedom corresponds to the number of unique “data points” that contribute to a particular calculation, minus the number of “constraints” that they need to satisfy. For the within groups variability what we’re calculating is the variation of the individual observations (<span class="math inline">\(N\)</span> data points) around the group means (<span class="math inline">\(G\)</span> constraints). In contrast, for the between groups variability we’re interested in the variation of the group means (<span class="math inline">\(G\)</span> data points) around the grand mean (1 constraint). Therefore, the degrees of freedom here are:</p>
<p><span class="math display">\[df_b=G-1\]</span> <span class="math display">\[df_w=N-G\]</span></p>
<p>Okay, that seems simple enough. What we do next is convert our summed squares value into a “mean squares” value, which we do by dividing by the degrees of freedom:</p>
<p><span class="math display">\[MS_b=\frac{SS_b}{df_b}\]</span> <span class="math display">\[MS_w=\frac{SS_w}{df_w}\]</span></p>
<p>Finally, we calculate the <span class="math inline">\(F\)</span>-ratio by dividing the between groups <span class="math inline">\(MS\)</span> by the within groups <span class="math inline">\(MS\)</span>:</p>
<p><span class="math display">\[F=\frac{MS_b}{MS_w}\]</span></p>
<p>At a very general level, the intuition behind the <span class="math inline">\(F\)</span>-statistic is straightforward. Bigger values of <span class="math inline">\(F\)</span> means that the between groups variation is large relative to the within groups variation. As a consequence, the larger the value of <span class="math inline">\(F\)</span> the more evidence we have against the null hypothesis. But how large does <span class="math inline">\(F\)</span> have to be in order to actually reject <span class="math inline">\(H_0\)</span>? In order to understand this, you need a slightly deeper understanding of what ANOVA is and what the mean squares values actually are.</p>
<p>The next section discusses that in a bit of detail, but for readers that aren’t interested in the details of what the test is actually measuring I’ll cut to the chase. In order to complete our hypothesis test we need to know the sampling distribution for <span class="math inline">\(F\)</span> if the null hypothesis is true. Not surprisingly, the sampling distribution for the <span class="math inline">\(F\)</span>-statistic under the null hypothesis is an <span class="math inline">\(F\)</span>-distribution. If you recall our discussion of the <span class="math inline">\(F\)</span>-distribution in <a href="07-Introduction-to-probability.html"><span>Chapter&nbsp;7</span></a>, the <span class="math inline">\(F\)</span>-distribution has two parameters, corresponding to the two degrees of freedom involved. The first one <span class="math inline">\(df_1\)</span> is the between groups degrees of freedom <span class="math inline">\(df_b\)</span>, and the second one <span class="math inline">\(df_2\)</span> is the within groups degrees of freedom <span class="math inline">\(df_w\)</span>.</p>
<p>A summary of all the key quantities involved in a one-way ANOVA, including the formulas showing how they are calculated, is shown in <a href="#tbl-tab13-2">Table&nbsp;<span>13.2</span></a>.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-2" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab13-2"><caption>Table&nbsp;13.2.  <p>All of the key quantities involved in an ANOVA organised into a
“standard” ANOVA table. The formulas for all quantities (except the
<span class="math inline"><em>p</em></span>-value which has a very ugly
formula and would be nightmarishly hard to calculate without a computer)
are shown</p> </caption>
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">between groups</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">within groups</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">\( df \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(  df_b=G-1  \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(  df_w=N-G  \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">sum of squares</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(  SS_b=\sum_{k=1}^{G} N_k  (\bar{Y}_k-\bar{Y})^2  \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(  SS_w=\sum_{k=1}^{G} \sum_{i=1}^{N_k}   (Y_{ik}-\bar{Y}_k)^2  \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">mean squares</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(  MS_b=\frac{SS_b}{df_b}  \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(  MS_w=\frac{SS_w}{df_w}  \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">\( F \)-statistic</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(  F=\frac{MS_b}{df_b}  \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">-</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">\(p\)-value</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">[complicated]</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">-</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>[Additional technical detail<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>]</p>
</section>
<section id="a-worked-example" class="level3" data-number="13.2.4">
<h3 data-number="13.2.4" class="anchored" data-anchor-id="a-worked-example"><span class="header-section-number">13.2.4</span> A worked example</h3>
<p>The previous discussion was fairly abstract and a little on the technical side, so I think that at this point it might be useful to see a worked example. For that, let’s go back to the clinical trial data that I introduced at the start of the chapter. The descriptive statistics that we calculated at the beginning tell us our group means: an average mood gain of <span class="math inline">\(0.45\)</span> for the placebo, <span class="math inline">\(0.72\)</span> for Anxifree, and <span class="math inline">\(1.48\)</span> for Joyzepam. With that in mind, let’s party like it’s 1899<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> and start doing some pencil and paper calculations. I’ll only do this for the first <span class="math inline">\(5\)</span> observations because it’s not bloody <span class="math inline">\(1899\)</span> and I’m very lazy. Let’s start by calculating <span class="math inline">\(SS_w\)</span>, the within-group sums of squares. First, let’s draw up a nice table to help us with our calculations (<a href="#tbl-tab13-3">Table&nbsp;<span>13.3</span></a>).</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-3" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab13-3"><caption>Table&nbsp;13.3.  <p>A worked example…1</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">group \( k \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">outcome \( Y_{ik} \)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.5</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.3</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.1</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.6</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.4</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>At this stage, the only thing I’ve included in the table is the raw data itself. That is, the grouping variable (i.e., drug) and outcome variable (i.e.&nbsp;mood.gain) for each person. Note that the outcome variable here corresponds to the <span class="math inline">\(\bar{Y}_{ik}\)</span> value in our equation previously. The next step in the calculation is to write down, for each person in the study, the corresponding group mean, <span class="math inline">\(\bar{Y}_k\)</span>. This is slightly repetitive but not particularly difficult since we already calculated those group means when doing our descriptive statistics, see <a href="#tbl-tab13-4">Table&nbsp;<span>13.4</span></a>.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-4" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab13-4"><caption>Table&nbsp;13.4.  <p>A worked example…2</p> </caption>
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">group \( k \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">outcome \( Y_{ik} \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">group mean \( \bar{Y}_k \)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.5</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.45</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.45</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.45</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.6</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.72</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.4</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.72</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Now that we’ve written those down, we need to calculate, again for every person, the deviation from the corresponding group mean. That is, we want to subtract <span class="math inline">\(Y_{ik} - \bar{Y}_k\)</span>. After we’ve done that, we need to square everything. When we do that, here’s what we get (<a href="#tbl-tab13-5">Table&nbsp;<span>13.5</span></a>).</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-5" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab13-5"><caption>Table&nbsp;13.5.  <p>A worked example…3</p> </caption>
<colgroup><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">group \( k \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">outcome \( Y_{ik} \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">group mean  \( \bar{Y}_k \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">dev. from group mean  \( Y_{ik} - \bar{Y}_k \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">squared deviation \(  (Y_{ik}-\bar{Y}_k)^2 \)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.5</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.45</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.05</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.0025</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.45</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">-0.15</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.0225</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.45</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">-0.35</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.1225</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.6</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.72</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">-0.12</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.0136</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.4</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.72</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">-0.32</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.1003</td></tr>
</tbody></table>

</div>
</div>
</div>
<p><br>
</p>
<p>The last step is equally straightforward. In order to calculate the within-group sum of squares we just add up the squared deviations across all observations:</p>
<p><span class="math display">\[
\begin{split}
SS_w &amp; = 0.0025 + 0.0225 + 0.1225 + 0.0136 + 0.1003 \\
&amp; = 0.2614
\end{split}
\]</span></p>
<p>Of course, if we actually wanted to get the right answer we’d need to do this for all 18 observations in the data set, not just the first five. We could continue with the pencil and paper calculations if we wanted to, but it’s pretty tedious. Alternatively, it’s not too hard to do this in a dedicated spreadsheet programme such as OpenOffice or Excel. Try and do it yourself. The one that I did, in Excel, is in the file clinicaltrial_anova.xls. When you do it you should end up with a within-group sum of squares value of <span class="math inline">\(1.39\)</span>.</p>
<p>Okay. Now that we’ve calculated the within groups variation, <span class="math inline">\(SS_w\)</span>, it’s time to turn our attention to the between-group sum of squares, <span class="math inline">\(SS_b\)</span>. The calculations for this case are very similar. The main difference is that instead of calculating the differences between an observation Yik and a group mean <span class="math inline">\(\bar{Y}_k\)</span> for all of the observations, we calculate the differences between the group means <span class="math inline">\(\bar{Y}_k\)</span> and the grand mean <span class="math inline">\(\bar{Y}\)</span> (in this case <span class="math inline">\(0.88\)</span>) for all of the groups (<a href="#tbl-tab13-6">Table&nbsp;<span>13.6</span></a>).</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-6" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab13-6"><caption>Table&nbsp;13.6.  <p>A worked example…4</p> </caption>
<colgroup><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">group \( k \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">group mean \( \bar{Y}_k \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">grand mean  \( \bar{Y} \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">deviation  \( \bar{Y}_k - \bar{Y} \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">squared deviation \(  ( \bar{Y}_k-\bar{Y})^2 \)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.45</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.88</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">-0.43</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.19</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.72</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.88</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">-0.16</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.03</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">joyzepam</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1.48</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.88</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.60</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.36</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>However, for the between group calculations we need to multiply each of these squared deviations by <span class="math inline">\(N_k\)</span>, the number of observations in the group. We do this because every observation in the group (all <span class="math inline">\(N_k\)</span> of them) is associated with a between group difference. So if there are six people in the placebo group and the placebo group mean differs from the grand mean by <span class="math inline">\(0.19\)</span>, then the total between group variation associated with these six people is <span class="math inline">\(6 \times 0.19 = 1.14\)</span>. So we have to extend our little table of calculations (<a href="#tbl-tab13-7">Table&nbsp;<span>13.7</span></a>).</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-7" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab13-7"><caption>Table&nbsp;13.7.  <p>A worked example…5</p> </caption>
<colgroup><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">group \( k \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">...</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">squared deviations  \( (\bar{Y}_k-\bar{Y})^2 \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">sample size  \( N_k \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">weighted squared dev   \(  N_k (\bar{Y}_k-\bar{Y})^2 \)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">...</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.19</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1.14</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">...</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.03</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.18</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">joyzepam</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">...</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.36</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">2.16</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>And so now our between group sum of squares is obtained by summing these “weighted squared deviations” over all three groups in the study:</p>
<p><span class="math display">\[\begin{aligned} SS_b &amp; = 1.14 + 0.18 + 2.16 \\ &amp;= 3.48 \end{aligned}\]</span></p>
<p>As you can see, the between group calculations are a lot shorter.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> Now that we’ve calculated our sums of squares values, <span class="math inline">\(SS_b\)</span> and <span class="math inline">\(SS_w\)</span>, the rest of the ANOVA is pretty painless. The next step is to calculate the degrees of freedom. Since we have <span class="math inline">\(G = 3\)</span> groups and <span class="math inline">\(N = 18\)</span> observations in total our degrees of freedom can be calculated by simple subtraction:</p>
<p><span class="math display">\[
\begin{split}
df_b &amp; = G-1 = 2 \\
df_w &amp; = N-G = 15
\end{split}
\]</span></p>
<p>Next, since we’ve now calculated the values for the sums of squares and the degrees of freedom, for both the within groups variability and the between groups variability, we can obtain the mean square values by dividing one by the other:</p>
<p><span class="math display">\[
\begin{split}
MS_b &amp; = \frac{SS_b}{df_b} = \frac{3.48}{2} = 1.74 \\
MS_w &amp; = \frac{SS_w}{df_w} = \frac{1.39}{15} = 0.09
\end{split}
\]</span></p>
<p>We’re almost done. The mean square values can be used to calculate the <span class="math inline">\(F\)</span>-value, which is the test statistic that we’re interested in. We do this by dividing the between groups <span class="math inline">\(MS\)</span> value by the within groups <span class="math inline">\(MS\)</span> value:</p>
<p><span class="math display">\[
\begin{split}
F &amp; = \frac{MS_b}{MS_w}  = \frac{1.74}{0.09} \\
&amp; = 19.3
\end{split}
\]</span></p>
<p>Woohooo! Now that we have our test statistic, the last step is to find out whether the test itself gives us a significant result. As discussed in <a href="09-Hypothesis-testing.html"><span>Chapter&nbsp;9</span></a> what we’d do in the old days is open up a statistics textbook and in a huge lookup table we would find the threshold <span class="math inline">\(F\)</span>-value corresponding to a particular value of alpha (the null hypothesis rejection region), e.g.&nbsp;<span class="math inline">\(0.05\)</span>, <span class="math inline">\(0.01\)</span> or <span class="math inline">\(0.001\)</span>, for 2 and 15 degrees of freedom. Doing it this way would give us a threshold <span class="math inline">\(F\)</span>-value for an alpha of <span class="math inline">\(0.001\)</span> of <span class="math inline">\(11.34\)</span>. As this is less than our calculated <span class="math inline">\(F\)</span>-value we say that <span class="math inline">\(p &lt; 0.001\)</span>. But nowadays fancy stats software calculates the exact <span class="math inline">\(p\)</span>-value for you, which is <span class="math inline">\(0.000071\)</span>. So, unless we’re being <em>extremely</em> conservative about our type I error rate, we’re pretty much guaranteed to reject the null hypothesis.</p>
<p>At this point, we’re basically done. Having completed our calculations, it’s traditional to organise all these numbers into an ANOVA table like the one in Table 13.1. For our clinical trial data, the ANOVA table would look like <a href="#tbl-tab13-8">Table&nbsp;<span>13.8</span></a>.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-8" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab13-8"><caption>Table&nbsp;13.8.  <p>The ANOVA results table</p> </caption>
<colgroup><col><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">\( df \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">sum of squares</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">mean squares</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">\(F\)-statistic</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(p\)-value</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">between groups</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">3.48</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1.74</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">19.3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.000071</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">within groups</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">15</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1.39</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.09</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">-</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">-</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>These days, you’ll probably never have much reason to want to construct one of these tables yourself, but you will find that almost all statistical software (jamovi included) tends to organise the output of an ANOVA into a table like this, so it’s a good idea to get used to reading them. However, although the software will output a full ANOVA table, there’s almost never a good reason to include the whole table in your write up. A pretty standard way of reporting the stats block for this result would be to write something like this:</p>
<blockquote class="blockquote">
<p>One-way ANOVA showed a significant effect of drug on mood gain (<span class="math inline">\(F(2,15) = 19.3, p &lt; .001\)</span>).</p>
</blockquote>
<p>Sigh. So much work for one short sentence.</p>
</section>
</section>
<section id="running-an-anova-in-jamovi" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="running-an-anova-in-jamovi"><span class="header-section-number">13.3</span> Running an ANOVA in jamovi</h2>
<p>I’m pretty sure I know what you’re thinking after reading the last section, especially if you followed my advice and did all of that by pencil and paper (i.e., in a spreadsheet) yourself. Doing the ANOVA calculations yourself sucks. There’s quite a lot of calculations that we needed to do along the way, and it would be tedious to have to do this over and over again every time you wanted to do an ANOVA.</p>
<section id="using-jamovi-to-specify-your-anova" class="level3" data-number="13.3.1">
<h3 data-number="13.3.1" class="anchored" data-anchor-id="using-jamovi-to-specify-your-anova"><span class="header-section-number">13.3.1</span> Using jamovi to specify your ANOVA</h3>
<p>To make life easier for you, jamovi can do ANOVA…hurrah! Go to the ‘ANOVA’ – ‘ANOVA’ analysis, and move the mood.gain variable across so it is in the ‘Dependent Variable’ box, and then move the drug variable across so it is in the ‘Fixed Factors’ box. This should give the results as shown in <a href="#fig-fig13-3">Figure&nbsp;<span>13.3</span></a>.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> Note I have also checked the <span class="math inline">\(\eta^2\)</span> checkbox, pronounced “eta” squared, under the ‘Effect Size’ option and this is also shown on the results table. We will come back to effect sizes a bit later.</p>
<p>The jamovi results table shows you the sums of squares values, the degrees of freedom, and a couple of other quantities that we’re not really interested in right now. Notice, however, that jamovi doesn’t use the names “between group” and “within group”. Instead, it tries to assign more meaningful names. In our particular example, the between groups variance corresponds to the effect that the drug has on the outcome variable, and the within groups variance corresponds to the “leftover” variability so it calls that the residuals.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-3" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig13-3.png" class="img-fluid figure-img" style="width:80.0%" alt="A table from jamovi titled &quot;ANOVA - mood.gain&quot; displays results for an ANOVA test with the columns:- &quot;Sum of Squares,&quot; &quot;df,&quot; &quot;Mean Square,&quot; &quot;F,&quot; &quot;p,&quot; and &quot;η².&quot; The rows present data for &quot;drug&quot; with values (3.45, 2, 1.73, 18.61, 0.00009, 0.71) and &quot;Residuals&quot; with values (1.39, 15, 0.09)"></p>
<figcaption class="figure-caption">Figure&nbsp;13.3. jamovi results table for ANOVA of mood gain by drug administered</figcaption>
</figure>
</div>
</div>
</div>
<p>If we compare these numbers to the numbers that I calculated by hand in <a href="#a-worked-example">A worked example</a>, you can see that they’re more or less the same, apart from rounding errors. The between groups sums of squares is <span class="math inline">\(SS_b = 3.45\)</span>, the within groups sums of squares is <span class="math inline">\(SS_w = 1.39\)</span>, and the degrees of freedom are <span class="math inline">\(2\)</span> and <span class="math inline">\(15\)</span> respectively. We also get the <span class="math inline">\(F\)</span>-value and the <span class="math inline">\(p\)</span>-value and, again, these are more or less the same, give or take rounding errors, to the numbers that we calculated ourselves when doing it the long and tedious way.</p>
</section>
</section>
<section id="effect-size" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="effect-size"><span class="header-section-number">13.4</span> Effect size</h2>
<p>There’s a few different ways you could measure the effect size in an ANOVA, but the most commonly used measures are <span class="math inline">\(\eta^2\)</span> (eta squared) and partial <span class="math inline">\(\eta^2\)</span>. For a one-way analysis of variance they’re identical to each other, so for the moment I’ll just explain <span class="math inline">\(\eta^2\)</span>. The definition of <span class="math inline">\(\eta^2\)</span> is actually really simple:</p>
<p><span class="math display">\[\eta^2=\frac{SS_b}{SS_{tot}}\]</span></p>
<p>That’s all it is. So when I look at the ANOVA table in <a href="#fig-fig13-3">Figure&nbsp;<span>13.3</span></a>, I see that <span class="math inline">\(SS_b = 3.45\)</span> and <span class="math inline">\(SS_tot = 3.45 + 1.39 = 4.84\)</span>. Thus we get an <span class="math inline">\(\eta^2\)</span> value of:</p>
<p><span class="math display">\[\eta^2=\frac{3.45}{4.84}=0.71\]</span></p>
<p>The interpretation of <span class="math inline">\(\eta^2\)</span> is equally straightforward. It refers to the proportion of the variability in the outcome variable (mood.gain) that can be explained in terms of the predictor (drug). A value of <span class="math inline">\(\eta^2=0\)</span> means that there is no relationship at all between the two, whereas a value of <span class="math inline">\(\eta^2=1\)</span> means that the relationship is perfect. Better yet, the <span class="math inline">\(\eta^2\)</span> value is very closely related to <span class="math inline">\(R^2\)</span>, as discussed previously in <a href="12-Correlation-and-linear-regression.html#sec-The-R2-value"><span>Section&nbsp;12.6.1</span></a>, and has an equivalent interpretation. Although many statistics textbooks suggest <span class="math inline">\(\eta^2\)</span> as the default effect size measure in ANOVA, there’s an interesting blog post<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> by Daniel Lakens suggesting that eta-squared is perhaps not the best measure of effect size in real-world data analysis, because it can be a biased estimator. Usefully, there is also an option in jamovi to specify omega-squared (<span class="math inline">\(\omega^2\)</span>), which is less biased, alongside eta-squared.</p>
</section>
<section id="multiple-comparisons-and-post-hoc-tests" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="multiple-comparisons-and-post-hoc-tests"><span class="header-section-number">13.5</span> Multiple comparisons and post hoc tests</h2>
<p>Any time you run an ANOVA with more than two groups and you end up with a significant effect, the first thing you’ll probably want to ask is which groups are actually different from one another. In our drugs example, our null hypothesis was that all three drugs (placebo, Anxifree and Joyzepam) have the exact same effect on mood. But if you think about it, the null hypothesis is actually claiming three different things all at once here. Specifically, it claims that:</p>
<ul>
<li>Your competitor’s drug (Anxifree) is no better than a placebo (i.e., <span class="math inline">\(\mu_A = \mu_P\)</span>)</li>
<li>Your drug (Joyzepam) is no better than a placebo (i.e., <span class="math inline">\(\mu_J = \mu_P\)</span>)</li>
<li>Anxifree and Joyzepam are equally effective (i.e., <span class="math inline">\(\mu_J = \mu_A\)</span>)</li>
</ul>
<p>If any one of those three claims is false, then the null hypothesis is also false. So, now that we’ve rejected our null hypothesis, we’re thinking that at least one of those things isn’t true. But which ones? All three of these propositions are of interest. Since you certainly want to know if your new drug Joyzepam is better than a placebo, it would be nice to know how well it stacks up against an existing commercial alternative (i.e., Anxifree). It would even be useful to check the performance of Anxifree against the placebo. Even if Anxifree has already been extensively tested against placebos by other researchers, it can still be very useful to check that your study is producing similar results to earlier work.</p>
<p>When we characterise the null hypothesis in terms of these three distinct propositions, it becomes clear that there are eight possible “states of the world” that we need to distinguish between (<a href="#tbl-tab13-9">Table&nbsp;<span>13.9</span></a>).</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-9" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab13-9"><caption>Table&nbsp;13.9.  <p>The null hypothesis and eight possible “states of the world”</p> </caption>
<colgroup><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">possibility:</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">is \( \mu_P = \mu_A \)?</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">is \( \mu_P = \mu_J \)?</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">is \( \mu_A = \mu_J \)?</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">which hypothesis?</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \checkmark \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \checkmark \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \checkmark \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">null</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \checkmark \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \checkmark \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">alternative</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \checkmark \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \checkmark \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">alternative</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \checkmark \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">alternative</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \checkmark \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \checkmark \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \checkmark \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">alternative</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \checkmark \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">alternative</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">7</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \checkmark \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">alternative</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">8</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">alternative</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>By rejecting the null hypothesis, we’ve decided that we don’t believe that #1 is the true state of the world. The next question to ask is, which of the other seven possibilities <em>do</em> we think is right? When faced with this situation, it’s usually helps to look at the data. For instance, if we look at the plots in <a href="#fig-fig13-1">Figure&nbsp;<span>13.1</span></a>, it’s tempting to conclude that Joyzepam is better than the placebo and better than Anxifree, but there’s no real difference between Anxifree and the placebo. However, if we want to get a clearer answer about this, it might help to run some tests.</p>
<section id="running-pairwise-t-tests" class="level3" data-number="13.5.1">
<h3 data-number="13.5.1" class="anchored" data-anchor-id="running-pairwise-t-tests"><span class="header-section-number">13.5.1</span> Running “pairwise” <span class="math inline">\(t\)</span>-tests</h3>
<p>How might we go about solving our problem? Given that we’ve got three separate pairs of means (placebo versus Anxifree, placebo versus Joyzepam, and Anxifree versus Joyzepam) to compare, what we could do is run three separate <span class="math inline">\(t\)</span>-tests and see what happens. This is easy to do in jamovi. Go to the ANOVA ‘Post Hoc Tests’ options, move the ‘drug’ variable across into the active box on the right, and then click on the ‘No correction’ checkbox. This will produce a neat table showing all the pairwise <span class="math inline">\(t\)</span>-test comparisons amongst the three levels of the drug variable, as in <a href="#fig-fig13-4">Figure&nbsp;<span>13.4</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-4" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig13-4.png" class="img-fluid figure-img" style="width:80.0%" alt="Image showing results of Post Hoc tests for drug comparisons. Table lists the mean differences, standard error (SE), degrees of freedom (df), t-values (t), and $p$-values (p) for three drug comparisons:- anxifree vs. joyzepam, anxifree vs. placebo, and joyzepam vs. placebo. Note states comparisons are based on estimated marginal means."></p>
<figcaption class="figure-caption">Figure&nbsp;13.4. Uncorrected pairwise <span class="math inline">\(t\)</span>-tests as post hoc comparisons in jamovi</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="corrections-for-multiple-testing" class="level3" data-number="13.5.2">
<h3 data-number="13.5.2" class="anchored" data-anchor-id="corrections-for-multiple-testing"><span class="header-section-number">13.5.2</span> Corrections for multiple testing</h3>
<p>In the previous section I hinted that there’s a problem with just running lots and lots of <span class="math inline">\(t\)</span>-tests. The concern is that, when running these analyses, what we’re doing is going on a “fishing expedition”. We’re running lots and lots of tests without much theoretical guidance in the hope that some of them come up significant. This kind of theory-free search for group differences is referred to as <strong>post hoc analysis</strong> (“post hoc” being Latin for “after this”).<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<p>It’s okay to run post hoc analyses, but a lot of care is required. For instance, the analysis that I ran in the previous section should be avoided, as each individual <span class="math inline">\(t\)</span>-test is designed to have a 5% type I error rate (i.e., <span class="math inline">\(\alpha = .05\)</span>) and I ran three of these tests. Imagine what would have happened if my ANOVA involved 10 different groups, and I had decided to run 45 “post hoc” <span class="math inline">\(t\)</span>-tests to try to find out which ones were significantly different from each other, you’d expect 2 or 3 of them to come up significant by chance alone. As we saw in <a href="09-Hypothesis-testing.html"><span>Chapter&nbsp;9</span></a>, the central organising principle behind null hypothesis testing is that we seek to control our type I error rate, but now that I’m running lots of <span class="math inline">\(t\)</span>-tests at once in order to determine the source of my ANOVA results, my actual type I error rate across this whole family of tests has gotten completely out of control.</p>
<p>The usual solution to this problem is to introduce an adjustment to the <span class="math inline">\(p\)</span>-value, which aims to control the total error rate across the family of tests (see <span class="citation" data-cites="Shaffer1995">Shaffer (<a href="References.html#ref-Shaffer1995" role="doc-biblioref">1995</a>)</span>). An adjustment of this form, which is usually (but not always) applied because one is doing post hoc analysis, is often referred to as a <strong>correction for multiple comparisons</strong>, though it is sometimes referred to as “simultaneous inference”. In any case, there are quite a few different ways of doing this adjustment. I’ll discuss a few of them in this section and in <a href="14-Factorial-ANOVA.html#sec-Post-hoc-tests"><span>Section&nbsp;14.8</span></a> in the next chapter, but you should be aware that there are many other methods out there (see, e.g., <span class="citation" data-cites="Hsu1996">Hsu (<a href="References.html#ref-Hsu1996" role="doc-biblioref">1996</a>)</span>).</p>
</section>
<section id="bonferroni-corrections" class="level3" data-number="13.5.3">
<h3 data-number="13.5.3" class="anchored" data-anchor-id="bonferroni-corrections"><span class="header-section-number">13.5.3</span> Bonferroni corrections</h3>
<p>The simplest of these adjustments is called the <strong>Bonferroni correction</strong> <span class="citation" data-cites="Dunn1961">(<a href="References.html#ref-Dunn1961" role="doc-biblioref">Dunn, 1961</a>)</span>, and it’s very very simple indeed. Suppose that my post hoc analysis consists of <span class="math inline">\(m\)</span> separate tests, and I want to ensure that the total probability of making <em>any</em> type I errors at all is at most <span class="math inline">\(\alpha\)</span>.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> If so, then the Bonferroni correction just says “multiply all your raw <span class="math inline">\(p\)</span>-values by <span class="math inline">\(m\)</span>”. If we let <span class="math inline">\(p\)</span> denote the original <span class="math inline">\(p\)</span>-value, and let <span class="math inline">\(p_j^{'}\)</span> be the corrected value, then the Bonferroni correction tells that:</p>
<p><span class="math display">\[p_j^{'}=m \times p\]</span></p>
<p>And therefore, if you’re using the Bonferroni correction, you would reject the null hypothesis if <span class="math inline">\(p_j^{'} &lt; \alpha\)</span>. The logic behind this correction is very straightforward. We’re doing m different tests, so if we arrange it so that each test has a type I error rate of at most <span class="math inline">\(\frac{\alpha}{m}\)</span>, then the <em>total</em> type I error rate across these tests cannot be larger than <span class="math inline">\(\alpha\)</span>. That’s pretty simple, so much so that in the original paper, the author writes:</p>
<blockquote class="blockquote">
<p><em>The method given here is so simple and so general that I am sure it must have been used before this. I do not find it, however, so can only conclude that perhaps its very simplicity has kept statisticians from realizing that it is a very good method in some situations</em> (<span class="citation" data-cites="Dunn1961">Dunn (<a href="References.html#ref-Dunn1961" role="doc-biblioref">1961</a>)</span>, pp.&nbsp;52-53).</p>
</blockquote>
<p>To use the Bonferroni correction in jamovi, just click on the ‘Bonferroni’ checkbox in the ‘Correction’ options, and you will see another column added to the ANOVA results table showing the adjusted <span class="math inline">\(p\)</span>-values for the Bonferroni correction (<a href="#tbl-tab13-8">Table&nbsp;<span>13.8</span></a>). If we compare these three <span class="math inline">\(p\)</span>-values to those for the uncorrected, pairwise <span class="math inline">\(t\)</span>-tests, it is clear that the only thing that jamovi has done is multiply them by <span class="math inline">\(3\)</span>.</p>
</section>
<section id="holm-corrections" class="level3" data-number="13.5.4">
<h3 data-number="13.5.4" class="anchored" data-anchor-id="holm-corrections"><span class="header-section-number">13.5.4</span> Holm corrections</h3>
<p>Although the Bonferroni correction is the simplest adjustment out there, it’s not usually the best one to use. One method that is often used instead is the <strong>Holm correction</strong> <span class="citation" data-cites="Holm1979">(<a href="References.html#ref-Holm1979" role="doc-biblioref">Holm, 1979</a>)</span>. The idea behind the Holm correction is to pretend that you’re doing the tests sequentially, starting with the smallest (raw) <span class="math inline">\(p\)</span>-value and moving onto the largest one. For the <span class="math inline">\(j\)</span>-th largest of the <span class="math inline">\(p\)</span>-values, the adjustment is <em>either</em>:</p>
<p><span class="math display">\[p_j^{'}=j \times p_j\]</span></p>
<p><br>
</p>
<p>(i.e., the biggest <span class="math inline">\(p\)</span>-value remains unchanged, the second biggest <span class="math inline">\(p\)</span>-value is doubled, the third biggest <span class="math inline">\(p\)</span>-value is tripled, and so on), <em>or</em>:</p>
<p><span class="math display">\[p_j^{'}=p_{j+1}^{'}\]</span></p>
<p>whichever one is larger. This might sound a little confusing, so let’s go through it a little more slowly. Here’s what the Holm correction does. First, you sort all of your <span class="math inline">\(p\)</span>-values in order, from smallest to largest. For the smallest <span class="math inline">\(p\)</span>-value all you do is multiply it by <span class="math inline">\(m\)</span>, and you’re done. However, for all the other ones it’s a two-stage process. For instance, when you move to the second smallest <span class="math inline">\(p\)</span>-value, you first multiply it by <span class="math inline">\(m - 1\)</span>. If this produces a number that is bigger than the adjusted <span class="math inline">\(p\)</span>-value that you got last time, then you keep it. But if it’s smaller than the last one, then you copy the last <span class="math inline">\(p\)</span>-value. To illustrate how this works, consider <a href="#tbl-tab13-10">Table&nbsp;<span>13.10</span></a> which shows the calculations of a Holm correction for a collection of five <span class="math inline">\(p\)</span>-values.</p>
<p>Hopefully that makes things clear.</p>
<p>Although it’s a little harder to calculate, the Holm correction has some very nice properties. It’s more powerful than Bonferroni (i.e., it has a lower type II error rate) but, counter-intuitive as it might seem, it has the same type I error rate. As a consequence, in practice there’s never any reason to use the simpler Bonferroni correction since it is always outperformed by the slightly more elaborate Holm correction. Because of this, the Holm correction should be your <em>go to</em> multiple comparison correction.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-10" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab13-10"><caption>Table&nbsp;13.10.  <p>Holm corrected <span class="math inline"><em>p</em></span>-values</p> </caption>
<colgroup><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">raw \( p \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">rank \( j \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">\( p \times j \)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">Holm \( p \)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">.001</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">.005</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">.005</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">.005</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">.020</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">.020</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">.019</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">.057</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">.057</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">.022</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">.044</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">.057</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">.103</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">.103</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">.103</td></tr>
</tbody></table>

</div>
</div>
</div>
<p><a href="#fig-fig13-4">Figure&nbsp;<span>13.4</span></a> also shows the Holm corrected <span class="math inline">\(p\)</span>-values and, as you can see, the biggest <span class="math inline">\(p\)</span>-value (corresponding to the comparison between Anxifree and the placebo) is unaltered. At a value of .15, it is exactly the same as the value we got originally when we applied no correction at all. In contrast, the smallest <span class="math inline">\(p\)</span>-value (Joyzepam versus placebo) has been multiplied by three.</p>
</section>
<section id="writing-up-the-post-hoc-test" class="level3" data-number="13.5.5">
<h3 data-number="13.5.5" class="anchored" data-anchor-id="writing-up-the-post-hoc-test"><span class="header-section-number">13.5.5</span> Writing up the post hoc test</h3>
<p>Finally, having run the post hoc analysis to determine which groups are significantly different to one another, you might write up the result like this:</p>
<blockquote class="blockquote">
<p>Post hoc tests (using the Holm correction to adjust <span class="math inline">\(p\)</span>) indicated that Joyzepam produced a significantly larger mood change than both Anxifree (<span class="math inline">\(p = .001\)</span>) and the placebo (<span class="math inline">\((p = 9.0 \times{10^{-5}}\)</span>). We found no evidence that Anxifree performed better than the placebo (<span class="math inline">\(p = .15\)</span>).</p>
</blockquote>
<p>Or, if you don’t like the idea of reporting exact <span class="math inline">\(p\)</span>-values, then you’d change those numbers to <span class="math inline">\(p &lt; .01\)</span>, <span class="math inline">\(p &lt; .001\)</span> and <span class="math inline">\(p &gt; .05\)</span> respectively. Either way, the key thing is that you indicate that you used Holm’s correction to adjust the <span class="math inline">\(p\)</span>-values. And of course, I’m assuming that elsewhere in the write up you’ve included the relevant descriptive statistics (i.e., the group means and standard deviations), since these <span class="math inline">\(p\)</span>-values on their own aren’t terribly informative.</p>
</section>
</section>
<section id="the-assumptions-of-one-way-anova" class="level2" data-number="13.6">
<h2 data-number="13.6" class="anchored" data-anchor-id="the-assumptions-of-one-way-anova"><span class="header-section-number">13.6</span> The assumptions of one-way ANOVA</h2>
<p>Like any statistical test, analysis of variance relies on some assumptions about the data, specifically the residuals. There are three key assumptions that you need to be aware of: normality, homogeneity of variance and independence.</p>
<p>[Additional technical detail<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>]</p>
<p>So, how do we check whether the assumption about the residuals is accurate? Well, as I indicated above, there are three distinct claims buried in this one statement, and we’ll consider them separately.</p>
<ul>
<li><strong>Homogeneity of variance</strong>. Notice that we’ve only got the one value for the population standard deviation (i.e., <span class="math inline">\(\sigma\)</span>), rather than allowing each group to have it’s own value (i.e., <span class="math inline">\(\sigma_k\)</span>). This is referred to as the homogeneity of variance (sometimes called homoscedasticity) assumption. ANOVA assumes that the population standard deviation is the same for all groups. We’ll talk about this extensively in the <a href="#sec-Checking-the-homogeneity-of-variance-assumption">Checking the homogeneity of variance assumption</a> section.</li>
<li><strong>Normality</strong>. The residuals are assumed to be normally distributed. As we saw in <a href="11-Comparing-two-means.html#sec-Checking-the-normality-of-a-sample"><span>Section&nbsp;11.9</span></a>, we can assess this by looking at QQ plots (or running a Shapiro-Wilk test. I’ll talk about this more in an ANOVA context in the <a href="#sec-Checking-the-normality-assumption">Checking the normality assumption</a> section.</li>
<li><strong>Independence</strong>. The independence assumption is a little trickier. What it basically means is that, knowing one residual tells you nothing about any other residual. All of the <span class="math inline">\(\epsilon_{ik}\)</span> values are assumed to have been generated without any “regard for” or “relationship to” any of the other ones. There’s not an obvious or simple way to test for this, but there are some situations that are clear violations of this. For instance, if you have a repeated measures design, where each participant in your study appears in more than one condition, then independence doesn’t hold. There’s a special relationship between some observations, namely those that correspond to the same person! When that happens, you need to use something like a <a href="#repeated-measures-one-way-anova">Repeated measures one-way ANOVA</a>.</li>
</ul>
<section id="sec-Checking-the-homogeneity-of-variance-assumption" class="level3" data-number="13.6.1">
<h3 data-number="13.6.1" class="anchored" data-anchor-id="sec-Checking-the-homogeneity-of-variance-assumption"><span class="header-section-number">13.6.1</span> Checking the homogeneity of variance assumption</h3>
<blockquote class="blockquote">
<p><em>To make the preliminary test on variances is rather like putting to sea in a rowing boat to find out whether conditions are sufficiently calm for an ocean liner to leave port!</em><br>
– George Box <span class="citation" data-cites="Box1953">(<a href="References.html#ref-Box1953" role="doc-biblioref">Box, 1953</a>)</span></p>
</blockquote>
<p>There’s more than one way to skin a cat, as the saying goes, and more than one way to test the homogeneity of variance assumption, too (though for some reason no-one made a saying out of that). The most commonly used test for this that I’ve seen in the literature is the Levene test <span class="citation" data-cites="Levene1960">(<a href="References.html#ref-Levene1960" role="doc-biblioref">Levene, 1960</a>)</span>, and the closely related Brown-Forsythe test <span class="citation" data-cites="BrownForsythe1974">(<a href="References.html#ref-BrownForsythe1974" role="doc-biblioref">Brown &amp; Forsythe, 1974</a>)</span>.</p>
<p>Regardless of whether you’re doing the standard Levene test or the Brown-Forsythe test, the test statistic, which is sometimes denoted <span class="math inline">\(F\)</span> but also sometimes written as <span class="math inline">\(W\)</span>, is calculated in exactly the same way that the <span class="math inline">\(F\)</span>-statistic for the regular ANOVA is calculated, just using a <span class="math inline">\(Z_{ik}\)</span> rather than <span class="math inline">\(Y_{ik}\)</span>. With that in mind, we can go on to look at how to run the test in jamovi.</p>
<p>[Additional technical detail<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>]</p>
</section>
<section id="running-the-levene-test-in-jamovi" class="level3" data-number="13.6.2">
<h3 data-number="13.6.2" class="anchored" data-anchor-id="running-the-levene-test-in-jamovi"><span class="header-section-number">13.6.2</span> Running the Levene test in jamovi</h3>
<p>Okay, so how do we run the Levene test? Simple really – under the ANOVA ‘Assumption Checks’ option, just click on the ‘Homogeneity tests’ checkbox. If we look at the output, shown in <a href="#fig-fig13-5">Figure&nbsp;<span>13.5</span></a>, we see that the test is non-significant (<span class="math inline">\(F_{2,15} = 1.45, p = .266\)</span>), so it looks like the homogeneity of variance assumption is fine. However, looks can be deceptive! If your sample size is pretty big, then the Levene test could show up a significant effect (i.e.&nbsp;p &lt; .05) even when the homogeneity of variance assumption is not violated to an extent which troubles the robustness of ANOVA. This was the point George Box was making in the quote above. Similarly, if your sample size is quite small, then the homogeneity of variance assumption might not be satisfied and yet a Levene test could be non-significant (i.e.&nbsp;p &gt; .05). What this means is that, alongside any statistical test of the assumption being met, you should always plot the standard deviation around the means for each group / category in the analysis…just to see if they look fairly similar (i.e.&nbsp;homogeneity of variance) or not.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-5" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig13-5.png" class="img-fluid figure-img" style="width:70.0%" alt="A table from jamovi showing an assumption check for Homogeneity of Variances Test (Levene). The table includes columns labeled F, df1, df2, and p. The values are 1.45, 2, 15, and 0.26569 respectively."></p>
<figcaption class="figure-caption">Figure&nbsp;13.5. Levene test output for one-way ANOVA in jamovi</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="removing-the-homogeneity-of-variance-assumption" class="level3" data-number="13.6.3">
<h3 data-number="13.6.3" class="anchored" data-anchor-id="removing-the-homogeneity-of-variance-assumption"><span class="header-section-number">13.6.3</span> Removing the homogeneity of variance assumption</h3>
<p>In our example, the homogeneity of variance assumption turned out to be a pretty safe one: the Levene test came back non-significant (notwithstanding that we should also look at the plot of standard deviations), so we probably don’t need to worry. However, in real life we aren’t always that lucky. How do we save our ANOVA when the homogeneity of variance assumption is violated? If you recall from our discussion of <span class="math inline">\(t\)</span>-tests, we’ve seen this problem before. The Student <span class="math inline">\(t\)</span>-test assumes equal variances, so the solution was to use the Welch <span class="math inline">\(t\)</span>-test, which does not. In fact, <span class="citation" data-cites="Welch1951">Welch (<a href="References.html#ref-Welch1951" role="doc-biblioref">1951</a>)</span> also showed how we can solve this problem for ANOVA too (the <strong>Welch one-way test</strong>). It’s implemented in jamovi using the One-Way ANOVA analysis. This is a specific analysis approach just for one-way ANOVA, and to run the Welch one-way ANOVA for our example, we would re-run the analysis as previously, but this time use the jamovi ANOVA - one-way ANOVA analysis command, and check the option for Welch’s test (see <a href="#fig-fig13-6">Figure&nbsp;<span>13.6</span></a>). To understand what’s happening here, let’s compare these numbers to what we got earlier when <a href="#running-an-anova-in-jamovi">Running an ANOVA in jamovi</a> originally. To save you the trouble of flicking back, this is what we got last time: <span class="math inline">\(F(2, 15) = 18.611, p = .00009\)</span>, also shown as the Fisher’s test in the One-Way ANOVA shown in <a href="#fig-fig13-6">Figure&nbsp;<span>13.6</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-6" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig13-6.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi screenshot displaying a one-way ANOVA analysis. The left panel shows input options and variables for the analysis, including variances, missing values, and assumption checks. The right panel shows the analysis results and assumption checks."></p>
<figcaption class="figure-caption">Figure&nbsp;13.6. Welch test as part of the one-way ANOVA analysis in jamovi</figcaption>
</figure>
</div>
</div>
</div>
<p>Okay, so originally our ANOVA gave us the result <span class="math inline">\(F(2, 15) = 18.6\)</span>, whereas the Welch one-way test gave us <span class="math inline">\(F(2, 9.49) = 26.32\)</span>. In other words, the Welch test has reduced the within groups degrees of freedom from 15 to 9.49, and the <span class="math inline">\(F\)</span>-value has increased from 18.6 to 26.32.</p>
</section>
<section id="sec-Checking-the-normality-assumption" class="level3" data-number="13.6.4">
<h3 data-number="13.6.4" class="anchored" data-anchor-id="sec-Checking-the-normality-assumption"><span class="header-section-number">13.6.4</span> Checking the normality assumption</h3>
<p>Testing the normality assumption is relatively straightforward. We covered most of what you need to know in <a href="11-Comparing-two-means.html#sec-Checking-the-normality-of-a-sample"><span>Section&nbsp;11.9</span></a>. The only thing we really need to do is draw a QQ plot and, in addition if it is available, run the Shapiro-Wilk test. The QQ plot is shown in <a href="#fig-fig13-7">Figure&nbsp;<span>13.7</span></a> and it looks pretty normal to me.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-7" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig13-7.png" class="img-fluid figure-img" style="width:80.0%" alt="A Q-Q plot comparing standardized residuals to theoretical quantiles, showing dots near a 45-degree reference line, indicating the data points follow a normal distribution closely. The axes are labeled &quot;Standardized Residuals&quot; and &quot;Theoretical Quantiles&quot;"></p>
<figcaption class="figure-caption">Figure&nbsp;13.7. QQ plot in the one-way ANOVA analysis in jamovi</figcaption>
</figure>
</div>
</div>
</div>
<p>If the Shapiro-Wilk test is not significant (i.e.&nbsp;<span class="math inline">\(p &gt; .05\)</span>) then this indicates that the assumption of normality is not violated. However, as with Levene’s test, if the sample size is large then a significant Shapiro-Wilk test may in fact be a false positive, where the assumption of normality is not violated in any substantive problematic sense for the analysis. And, similarly, a very small sample can produce false negatives. That’s why a visual inspection of the QQ plot is important.</p>
<p>Alongside inspecting the QQ plot for any deviations from normality, the Shapiro-Wilk test for our data does show a non-significant effect, with <span class="math inline">\(p\)</span> = 0.6053 (see <a href="#fig-fig13-6">Figure&nbsp;<span>13.6</span></a>). This therefore supports the QQ plot assessment; both checks find no indication that normality is violated.</p>
</section>
<section id="removing-the-normality-assumption" class="level3" data-number="13.6.5">
<h3 data-number="13.6.5" class="anchored" data-anchor-id="removing-the-normality-assumption"><span class="header-section-number">13.6.5</span> Removing the normality assumption</h3>
<p>Now that we’ve seen how to check for normality, we are led naturally to ask what we can do to address violations of normality. In the context of a one-way ANOVA, the easiest solution is probably to switch to a non-parametric test (i.e., one that doesn’t rely on any particular assumption about the kind of distribution involved). We’ve seen non-parametric tests before, in <a href="11-Comparing-two-means.html"><span>Chapter&nbsp;11</span></a>. When you only have two groups, the Mann-Whitney or the Wilcoxon test provides the non-parametric alternative that you need. When you’ve got three or more groups, you can use the <strong>Kruskal-Wallis rank sum test</strong> <span class="citation" data-cites="KruskalWallis1952">(<a href="References.html#ref-KruskalWallis1952" role="doc-biblioref">Kruskal &amp; Wallis, 1952</a>)</span>. So that’s the test we’ll talk about next.</p>
</section>
<section id="the-logic-behind-the-kruskal-wallis-test" class="level3" data-number="13.6.6">
<h3 data-number="13.6.6" class="anchored" data-anchor-id="the-logic-behind-the-kruskal-wallis-test"><span class="header-section-number">13.6.6</span> The logic behind the Kruskal-Wallis test</h3>
<p>The Kruskal-Wallis test is surprisingly similar to ANOVA, in some ways. In ANOVA we started with <span class="math inline">\(Y_{ik}\)</span>, the value of the outcome variable for the ith person in the kth group. For the Kruskal-Wallis test what we’ll do is rank order all of these <span class="math inline">\(Y_{ik}\)</span> values and conduct our analysis on the ranked data.<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a></p>
</section>
<section id="additional-details" class="level3" data-number="13.6.7">
<h3 data-number="13.6.7" class="anchored" data-anchor-id="additional-details"><span class="header-section-number">13.6.7</span> Additional details</h3>
<p>The description in the previous section illustrates the logic behind the Kruskal-Wallis test. At a conceptual level, this is the right way to think about how the test works.<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a></p>
<p>But wait, there’s more! Dear lord, why is there always more? The story I’ve told so far is only actually true when there are no ties in the raw data. That is, if there are no two observations that have exactly the same value. If there are ties, then we have to introduce a correction factor to these calculations. At this point I’m assuming that even the most diligent reader has stopped caring (or at least formed the opinion that the tie-correction factor is something that doesn’t require their immediate attention). So I’ll very quickly tell you how it’s calculated, and omit the tedious details about why it’s done this way. Suppose we construct a frequency table for the raw data, and let fj be the number of observations that have the j-th unique value. This might sound a bit abstract, so here’s a concrete example from the frequency table of mood.gain from the <em>clinicaltrials.csv</em> data set (<a href="#tbl-tab13-11">Table&nbsp;<span>13.11</span></a>).</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-11" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab13-11"><caption>Table&nbsp;13.11.  <p>Frequency table of mood gain from the <em>clinicaltrials.csv</em>
data</p> </caption>
<colgroup><col><col><col><col><col><col><col><col><col><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">0.1</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">0.2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">0.3</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">0.4</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">0.5</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">0.6</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">0.8</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">0.9</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">1.1</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">1.2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">1.3</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">1.4</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">1.7</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">1.8</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Looking at this table, notice that the third entry in the frequency table has a value of 2. Since this corresponds to a mood.gain of 0.3, this table is telling us that two people’s mood increased by 0.3.<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a></p>
<p>And so jamovi uses a tie-correction factor to calculate the tie-corrected Kruskall-Wallis statistic. And at long last, we’re actually finished with the theory of the Kruskal-Wallis test. I’m sure you’re all terribly relieved that I’ve cured you of the existential anxiety that naturally arises when you realise that you don’t know how to calculate the tie-correction factor for the Kruskal-Wallis test. Right?</p>
</section>
<section id="how-to-run-the-kruskal-wallis-test-in-jamovi" class="level3" data-number="13.6.8">
<h3 data-number="13.6.8" class="anchored" data-anchor-id="how-to-run-the-kruskal-wallis-test-in-jamovi"><span class="header-section-number">13.6.8</span> How to run the Kruskal-Wallis test in jamovi</h3>
<p>Despite the horror that we’ve gone through in trying to understand what the Kruskal-Wallis test actually does, it turns out that running the test is pretty painless, since jamovi has an analysis as part of the ANOVA analysis set called ‘Non-Parametric’ – ‘one-way ANOVA (Kruskal-Wallis)’ Most of the time you’ll have data like the <em>clinicaltrial.csv</em> data set, in which you have your outcome variable mood.gain and a grouping variable drug. If so, you can just go ahead and run the analysis in jamovi. What this gives us is a Kruskal-Wallis <span class="math inline">\(\chi^2 =12.076, df = 2, p = 0.00239\)</span>, as in <a href="#fig-fig13-8">Figure&nbsp;<span>13.8</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-8" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig13-8.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi screenshot showing a One-Way ANOVA (Non-parametric) test in a clinical trial. The interface displays the dependent variable &quot;mood.gain,&quot; the grouping variable &quot;drug,&quot; analysis results, and a list of references on the right."></p>
<figcaption class="figure-caption">Figure&nbsp;13.8. Kruskal-Wallis one-way non-parametric ANOVA in jamovi</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="repeated-measures-one-way-anova" class="level2" data-number="13.7">
<h2 data-number="13.7" class="anchored" data-anchor-id="repeated-measures-one-way-anova"><span class="header-section-number">13.7</span> Repeated measures one-way ANOVA</h2>
<p>The one-way repeated measures ANOVA is a statistical test for significant differences between three or more groups where the same participants are in each group (or each participant is closely matched with participants in other experimental groups). For this reason, there should always be an equal number of scores (data points) in each experimental group. This type of design and analysis can also be called a “related ANOVA” or a “within subjects ANOVA”.</p>
<p>The logic behind a repeated measures ANOVA is very similar to that of an independent ANOVA (sometimes called a “between subjects” ANOVA). You’ll remember that earlier we showed that in a between subjects ANOVA total variability is partitioned into between groups variability (<span class="math inline">\(SS_b\)</span>) and within groups variability (<span class="math inline">\(SS_w\)</span>), then divided by the respective degrees of freedom to give <span class="math inline">\(MS_b\)</span> and <span class="math inline">\(MS_w\)</span> (see Table 13.1), whereupon the <span class="math inline">\(F\)</span>-ratio is calculated as:</p>
<p><span class="math display">\[F=\frac{MS_b}{MS_w}\]</span></p>
<p>In a repeated measures ANOVA, the <span class="math inline">\(F\)</span>-ratio is calculated in a similar way, but whereas in an independent ANOVA the within-group variability (<span class="math inline">\(SS_w\)</span>) is used as the basis for the <span class="math inline">\(MS_w\)</span> denominator, in a repeated measures ANOVA the <span class="math inline">\(SS_w\)</span> is partioned into two parts. As we are using the same subjects in each group, we can remove the variability due to the individual differences between subjects (referred to as <span class="math inline">\(SS_{subjects}\)</span>) from the within groups variability.</p>
<p>We won’t go into too much technical detail about how this is done, but essentially each subject becomes a level of a factor called subjects. The variability in this within subjects factor is then calculated in the same way as any between subjects factor. And then we can subtract <span class="math inline">\(SS_{subjects}\)</span> from <span class="math inline">\(SS_w\)</span> to provide a smaller <span class="math inline">\(SS_{error}\)</span> term:</p>
<p><span class="math display">\[\text{Independent ANOVA: } SS_{error} = SS_w\]</span> <span class="math display">\[\text{Repeated Measures ANOVA: } SS_{error} = SS_w - SS_{subjects}\]</span></p>
<p>This change in <span class="math inline">\(SS_{error}\)</span> term often leads to a more powerful statistical test, but this does depend on whether the reduction in the <span class="math inline">\(SS_{error}\)</span> more than compensates for the reduction in degrees of freedom for the error term (as degrees of freedom go from <span class="math inline">\((n - k)\)</span><a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a> to <span class="math inline">\((n - 1)(k - 1)\)</span> (remembering that there are more subjects in the independent ANOVA design).</p>
<section id="repeated-measures-anova-in-jamovi" class="level3" data-number="13.7.1">
<h3 data-number="13.7.1" class="anchored" data-anchor-id="repeated-measures-anova-in-jamovi"><span class="header-section-number">13.7.1</span> Repeated measures ANOVA in jamovi</h3>
<p>First, we need some data. <span class="citation" data-cites="Geschwind1972">Geschwind (<a href="References.html#ref-Geschwind1972" role="doc-biblioref">1972</a>)</span> has suggested that the exact nature of a patient’s language deficit following a stroke can be used to diagnose the specific region of the brain that has been damaged. A researcher is concerned with identifying the specific communication difficulties experienced by six patients suffering from Broca’s Aphasia (a language deficit commonly experienced following a stroke) (<a href="#tbl-tab13-12">Table&nbsp;<span>13.12</span></a>).</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-12" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab13-12"><caption>Table&nbsp;13.12.  <p>Word recognition task scores in stroke patients</p> </caption>
<colgroup><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Participant</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Speech</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Conceptual</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">Syntax</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">8</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">7</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">6</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">7</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">8</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">6</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">9</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">3</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">5</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">2</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">8</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">7</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">4</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>The patients were required to complete three word recognition tasks. On the first (speech production) task, patients were required to repeat single words read out aloud by the researcher. On the second (conceptual) task, designed to test word comprehension, patients were required to match a series of pictures with their correct name. On the third (syntax) task, designed to test knowledge of correct word order, patients were asked to reorder syntactically incorrect sentences. Each patient completed all three tasks. The order in which patients attempted the tasks was counterbalanced between participants. Each task consisted of a series of 10 attempts. The number of attempts successfully completed by each patient are shown in <a href="#tbl-tab13-11">Table&nbsp;<span>13.11</span></a>. Enter these data into jamovi ready for analysis (or take a short-cut and load up the <em>broca.csv</em> file).</p>
<p>To perform a one-way related ANOVA in jamovi, open the one-way repeated measures ANOVA dialogue box, as in <a href="#fig-fig13-9">Figure&nbsp;<span>13.9</span></a>, via ‘ANOVA - Repeated Measures ANOVA’.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig13-9" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/fig13-9.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi screenshot showing the setup for a Repeated Measures ANOVA analysis. The interface includes fields for participants, speech, conceptual, and syntax variables, along with options to define repeated measures factors and cells, between subject factors, and covariates"></p>
<figcaption class="figure-caption">Figure&nbsp;13.9. Repeated measures ANOVA dialogue box in jamovi</figcaption>
</figure>
</div>
</div>
</div>
<p>Then:</p>
<ul>
<li>Enter a ‘Repeated Measures’ factor name. This should be a label that you choose to describe the conditions repeated by all participants. For example, to describe the speech, conceptual and syntax tasks completed by all participants a suitable label would be ‘Task’. Note that this new factor name represents the independent variable in the analysis.</li>
<li>Add a third level in the ‘Repeated Measures Factors’ text box, as there are three levels representing the three tasks: speech, conceptual and syntax. Change the labels of the levels accordingly.</li>
<li>Then move each of the levels variables across to the ‘Repeated Measures’ Cells text box.</li>
<li>Finally, under the ‘Assumption Checks’ option, tick the ‘Sphericity checks’ text box.</li>
</ul>
<p>jamovi output for a one-way repeated measures ANOVA is produced as shown in <a href="#fig-fig13-10">Figure&nbsp;<span>13.10</span></a> to <a href="#fig-fig13-13">Figure&nbsp;<span>13.13</span></a>. The first output we should look at is Mauchly’s Test of Sphericity, which tests the hypothesis that the variances of the differences between the conditions are equal (meaning that the spread of difference scores between the study conditions is approximately the same). In <a href="#fig-fig13-10">Figure&nbsp;<span>13.10</span></a> the significance level in Mauchly’s test is <span class="math inline">\(p = .720\)</span>. If Mauchly’s test is non-significant (i.e.&nbsp;<span class="math inline">\(p &gt; .05\)</span>, as is the case in this analysis) then it is reasonable to conclude that the variances of the differences are not significantly different (i.e.&nbsp;they are roughly equal and sphericity can be assumed).</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-10" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig13-10.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi results table titled &quot;Tests of Sphericity&quot; shows three columns for Mauchly $W$, $p$-value, Greenhouse-Geisser epsilon, and Huynh-Feldt epsilon. Under the task row, the values are 0.85, 0.72009, 0.87, and 1.00, respectively. The heading 'Assumptions' is above the table."></p>
<figcaption class="figure-caption">Figure&nbsp;13.10. One-way repeated measures ANOVA output – Mauchly Test of Sphericity</figcaption>
</figure>
</div>
</div>
</div>
<p>If, on the other hand, Mauchly’s test had been significant (<span class="math inline">\(p\)</span> &lt; .05) then we would conclude that there are significant differences between the variance of the differences, and the requirement of sphericity has not been met. In this case, we should apply a correction to the <span class="math inline">\(F\)</span>-value obtained in the one-way related ANOVA analysis:</p>
<ul>
<li>If the Greenhouse-Geisser value in the ‘Tests of Sphericity’ table is &gt; .75 then you should use the Huynh-Feldt correction</li>
<li>But if the Greenhouse-Geisser value is &lt; .75, then you should use the Greenhouse-Geisser correction.</li>
</ul>
<p>Both these corrected <span class="math inline">\(F\)</span>-values can be specified in the ‘Sphericity Corrections’ check boxes under the ‘Assumption Checks’ options, and the corrected <span class="math inline">\(F\)</span>-values are then shown in the results table, as in <a href="#fig-fig13-11">Figure&nbsp;<span>13.11</span></a>.</p>
<p>In our analysis, we saw that the significance of Mauchly’s Test of Sphericity was <span class="math inline">\(p = .720\)</span> (i.e., <span class="math inline">\(p &gt; 0.05)\)</span>. So, this means we can assume that the requirement of sphericity has been met so no correction to the <span class="math inline">\(F\)</span>-value is needed. Therefore, we can use the ‘None’ Sphericity Correction output values for the repeated measure ‘Task’: <span class="math inline">\(F = 6.93\)</span>, <span class="math inline">\(df = 2\)</span>, <span class="math inline">\(p = .013\)</span>, and we can conclude that the number of tests successfully completed on each language task did vary significantly depending on whether the task was speech, comprehension or syntax based (<span class="math inline">\(F(2, 10) = 6.93\)</span>, <span class="math inline">\(p = .013\)</span>).</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-11" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig13-11.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi results table displaying repeated measures ANOVA results. The columns include Sphericity Correction (None, Greenhouse-Geisser, Huynh-Feldt), Sum of Squares, degrees of freedom ($df$), Mean Square, $F$-values, and $p$-values for Task and Residual effects. Note:- Type 3 Sums of Squares"></p>
<figcaption class="figure-caption">Figure&nbsp;13.11. One-way repeated measures ANOVA output – Tests of Within Subjects Effects</figcaption>
</figure>
</div>
</div>
</div>
<p>Post hoc tests can also be specified in jamovi for repeated measures ANOVA in the same way as for independent ANOVA. The results are shown in <a href="#fig-fig13-12">Figure&nbsp;<span>13.12</span></a>. These indicate that there is a significant difference between Speech and Syntax, but not between other levels.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-12" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig13-12.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi results table titled 'Post Hoc Comparisons -- Task' with columns for Comparison, Mean Difference, $SE$, $df$, $t$, and $P_{tukey}$. The tasks compared are Speech vs. Conceptual, Speech vs. Syntax, and Conceptual vs. Syntax. Values for each comparison are provided."></p>
<figcaption class="figure-caption">Figure&nbsp;13.12. Post hoc tests in repeated measures ANOVA in jamovi</figcaption>
</figure>
</div>
</div>
</div>
<p>Descriptive statistics (marginal means) can be reviewed to help interpret the results, produced in the jamovi output as in <a href="#fig-fig13-13">Figure&nbsp;<span>13.13</span></a>. Comparison of the mean number of trials successfully completed by participants shows that Broca’s Aphasics perform reasonably well on speech production (mean = 7.17) and language comprehension (mean = 6.17) tasks. However, their performance was considerably worse on the syntax task (mean = 4.33), with a significant difference in post hoc tests between Speech and Syntax task performance.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-13" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig13-13.png" class="img-fluid figure-img" style="width:70.0%" alt="A jamovi results table titled 'Estimated Marginal Means - Task' shows the mean, standard error, and 95% confidence intervals for three tasks:- Speech (Mean:- 7.17, SE:- 0.60, CI:- 5.62-8.71), Conceptual (Mean:- 6.17, SE:- 0.60, CI:- 4.62-7.71), and Syntax (Mean:- 4.33, SE:- 0.67, CI:- 2.62-6.05)"></p>
<figcaption class="figure-caption">Figure&nbsp;13.13. One-way repeated measures ANOVA output – Descriptive Statistics</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="the-friedman-non-parametric-repeated-measures-anova-test" class="level2" data-number="13.8">
<h2 data-number="13.8" class="anchored" data-anchor-id="the-friedman-non-parametric-repeated-measures-anova-test"><span class="header-section-number">13.8</span> The Friedman non-parametric repeated measures ANOVA test</h2>
<p>The Friedman test is a non-parametric version of a repeated measures ANOVA and can be used instead of the Kruskal-Wallis test when testing for differences between three or more groups where the same participants are in each group, or each participant is closely matched with participants in other conditions. If the dependent variable is ordinal, or if the assumption of normality is not met, then the Friedman test can be used.</p>
<p>As with the Kruskal-Wallis test, the underlying mathematics is complicated, and won’t be presented here. For the purpose of this book, it is sufficient to note that jamovi calculates the tie-corrected version of the Friedman test, and in <a href="#fig-fig13-14">Figure&nbsp;<span>13.14</span></a> there is an example using the Broca’s Aphasia data we have already looked at.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-14" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig13-14.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi screenshot displaying the results of a Repeated Measures ANOVA (Non-parametric). The sections shown include data from participants, measures (Speech, Conceptual, Syntax), pairwise comparisons, and descriptive statistics."></p>
<figcaption class="figure-caption">Figure&nbsp;13.14. The ‘Repeated Measures ANOVA (Non-parametric)’ dialogue box and results in jamovi</figcaption>
</figure>
</div>
</div>
</div>
<p>It’s pretty straightforward to run a Friedman test in jamovi. Just select ‘Analyses - ANOVA - Repeated Measures ANOVA (Non-parametric)’ as in <a href="#fig-fig13-14">Figure&nbsp;<span>13.14</span></a>. Then highlight and transfer the names of the repeated measures variables you wish to compare (Speech, Conceptual, Syntax) into the ‘Measures:’ text box. To produce descriptive statistics (means and medians) for the three repeated measures variables, click on the ‘Descriptives’ button.</p>
<p>The jamovi results show descriptive statistics, chi-square value, degrees of freedom, and the <span class="math inline">\(p\)</span>-value (<a href="#fig-fig13-14">Figure&nbsp;<span>13.14</span></a>). Since the <span class="math inline">\(p\)</span>-value is less than the level conventionally used to determine significance (<span class="math inline">\(p &lt; .05\)</span>), we can conclude that Broca’s Aphasics perform reasonably well on speech production (median = 7.5) and language comprehension (median = 6.5) tasks. However, their performance was considerably worse on the syntax task (median = 4.5), with a significant difference in post hoc tests between Speech and Syntax task performance.</p>
</section>
<section id="sec-On-the-relationship-between-ANOVA-and-the-Student-t-test" class="level2" data-number="13.9">
<h2 data-number="13.9" class="anchored" data-anchor-id="sec-On-the-relationship-between-ANOVA-and-the-Student-t-test"><span class="header-section-number">13.9</span> On the relationship between ANOVA and the Student <span class="math inline">\(t\)</span>-test</h2>
<p>There’s one last thing I want to point out before finishing. It’s something that a lot of people find kind of surprising, but it’s worth knowing about. An ANOVA with two groups is identical to the Student <span class="math inline">\(t\)</span>-test. No, really. It’s not just that they are similar, but they are actually equivalent in every meaningful way. I won’t try to prove that this is always true, but I will show you a single concrete demonstration. Suppose that, instead of running an ANOVA on our mood.gain ~ drug model, let’s instead do it using therapy as the predictor. If we run this ANOVA we get an <span class="math inline">\(F\)</span>-statistic of <span class="math inline">\(F(1,16) = 1.71\)</span>, and a <span class="math inline">\(p\)</span>-value = <span class="math inline">\(0.21\)</span>. Since we only have two groups, I didn’t actually need to resort to an ANOVA, I could have just decided to run a Student <span class="math inline">\(t\)</span>-test. So let’s see what happens when I do that: I get a <span class="math inline">\(t\)</span>-statistic of <span class="math inline">\(t(16) = -1.3068\)</span> and a <span class="math inline">\(p\)</span>-value = 0.21. Curiously, the <span class="math inline">\(p\)</span>-values are identical. Once again we obtain a value of <span class="math inline">\(p = .21\)</span>. But what about the test statistic? Having run a <span class="math inline">\(t\)</span>-test instead of an ANOVA, we get a somewhat different answer, namely <span class="math inline">\(t(16) = -1.3068\)</span>. However, there is a fairly straightforward relationship here. If we square the <span class="math inline">\(t\)</span>-statistic then we get the <span class="math inline">\(F\)</span>-statistic from before: <span class="math inline">\(-1.3068^2 = 1.7077\)</span>.</p>
</section>
<section id="summary" class="level2" data-number="13.10">
<h2 data-number="13.10" class="anchored" data-anchor-id="summary"><span class="header-section-number">13.10</span> Summary</h2>
<p>There’s a fair bit covered in this chapter, but there’s still a lot missing.<a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a> Most obviously, I haven’t discussed how to run an ANOVA when you are interested in more than one grouping variable, but that will be discussed in a lot of detail in <a href="14-Factorial-ANOVA.html"><span>Chapter&nbsp;14</span></a>. In terms of what we have discussed, the key topics were:</p>
<ul>
<li>The basic logic behind <a href="#sec-How-ANOVA-works">How ANOVA works</a> and <a href="#running-an-anova-in-jamovi">Running an ANOVA in jamovi</a>.</li>
<li>How to compute an <a href="#effect-size">Effect size</a> for an ANOVA.</li>
<li><a href="#multiple-comparisons-and-post-hoc-tests">Multiple comparisons and post hoc tests</a> for multiple testing.</li>
<li><a href="#the-assumptions-of-one-way-anova">The assumptions of one-way ANOVA</a>.</li>
<li><a href="#sec-Checking-the-homogeneity-of-variance-assumption">Checking the homogeneity of variance assumption</a> and what to do if it is violated: <a href="#removing-the-homogeneity-of-variance-assumption">Removing the homogeneity of variance assumption</a>.</li>
<li><a href="#sec-Checking-the-normality-assumption">Checking the normality assumption</a> and what to do if it is violated: <a href="#removing-the-normality-assumption">Removing the normality assumption</a>.</li>
<li><a href="#repeated-measures-one-way-anova">Repeated measures one-way ANOVA</a> and the non-parametric equivalent, <a href="#the-friedman-non-parametric-repeated-measures-anova-test">The Friedman non-parametric repeated measures ANOVA test</a>.</li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Box1953" class="csl-entry" role="listitem">
Box, G. E. P. (1953). Non-normality and tests on variances. <em>Biometrika</em>, <em>40</em>, 318–335. <a href="https://doi.org/10.2307/2333350">https://doi.org/10.2307/2333350</a>
</div>
<div id="ref-BrownForsythe1974" class="csl-entry" role="listitem">
Brown, M. B., &amp; Forsythe, A. B. (1974). Robust tests for equality of variances. <em>Journal of the American Statistical Association</em>, <em>69</em>, 364–367. <a href="https://doi.org/10.2307/2285659">https://doi.org/10.2307/2285659</a>
</div>
<div id="ref-Dunn1961" class="csl-entry" role="listitem">
Dunn, O. J. (1961). Multiple comparisons among means. <em>Journal of the American Statistical Association</em>, <em>56</em>, 52–64. <a href="https://doi.org/10.1080/01621459.1961.10482090">https://doi.org/10.1080/01621459.1961.10482090</a>
</div>
<div id="ref-Geschwind1972" class="csl-entry" role="listitem">
Geschwind, N. (1972). Language and the brain. <em>Scientific American</em>, <em>226(4)</em>, 76–83. <a href="https://doi.org/10.1038/scientificamerican0472-76">https://doi.org/10.1038/scientificamerican0472-76</a>
</div>
<div id="ref-Hays1994" class="csl-entry" role="listitem">
Hays, W. L. (1994). <em>Statistics</em> (5th ed.). Harcourt Brace.
</div>
<div id="ref-Holm1979" class="csl-entry" role="listitem">
Holm, S. (1979). A simple sequentially rejective multiple test procedure. <em>Scandinavian Journal of Statistics</em>, <em>6</em>, 65–70. <a href="https://doi.org/10.2307/4615733">https://doi.org/10.2307/4615733</a>
</div>
<div id="ref-Hsu1996" class="csl-entry" role="listitem">
Hsu, J. C. (1996). <em>Multiple comparisons: Theory and methods</em>. Chapman &amp; Hall. <a href="https://doi.org/10.1201/b15074">https://doi.org/10.1201/b15074</a>
</div>
<div id="ref-KruskalWallis1952" class="csl-entry" role="listitem">
Kruskal, W. H., &amp; Wallis, W. A. (1952). Use of ranks in one-criterion variance analysis. <em>Journal of the American Statistical Association</em>, <em>47</em>, 583–621. <a href="https://doi.org/10.1080/01621459.1952.10483441">https://doi.org/10.1080/01621459.1952.10483441</a>
</div>
<div id="ref-Levene1960" class="csl-entry" role="listitem">
Levene, H. (1960). Robust tests for equality of variances. In Olkin, I. and others (Ed.), <em>Contributions to probability and statistics: Essays in honor of harold hotelling</em> (pp. 278–292). Stanford University Press.
</div>
<div id="ref-Sahai2000" class="csl-entry" role="listitem">
Sahai, H., &amp; Ageel, M. I. (2000). <em>The analysis of variance: Fixed, random and mixed models</em>. Birkhauser.
</div>
<div id="ref-Shaffer1995" class="csl-entry" role="listitem">
Shaffer, J. P. (1995). Multiple hypothesis testing. <em>Annual Review of Psychology</em>, <em>46</em>, 561–584. <a href="https://doi.org/10.1146/annurev.ps.46.020195.003021">https://doi.org/10.1146/annurev.ps.46.020195.003021</a>
</div>
<div id="ref-Welch1951" class="csl-entry" role="listitem">
Welch, B. L. (1951). On the comparison of several mean values: An alternative approach. <em>Biometrika</em>, <em>38</em>, 330–336. <a href="https://doi.org/10.1093/biomet/38.3-4.330">https://doi.org/10.1093/biomet/38.3-4.330</a>
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>When all groups have the same number of observations, the experimental design is said to be “balanced”. Balance isn’t such a big deal for one-way ANOVA, which is the topic of this chapter. It becomes more important when you start doing more complicated ANOVAs.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>So the formula for the total sum of squares is almost identical to the formula for the variance: <span class="math display">\[SS_{tot}=\sum_{k=1}^{G} \sum_{i=1}^{N_k} (Y_{ik} - \bar{Y})^2\]</span><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>One very nice thing about the total sum of squares is that we can break it up into two different kinds of variation First, we can talk about the within-group sum of squares, in which we look to see how different each individual person is from their own group mean: <span class="math display">\[SS_{w}= \sum_{k=1}^{G} \sum_{i=1}^{N_k} (Y_{ik} - \bar{Y}_k)^2\]</span> where <span class="math inline">\(\bar{Y}_k\)</span> is a group mean. In our example, <span class="math inline">\(\bar{Y}_k\)</span> would be the average mood change experienced by those people given the k-th drug. So, instead of comparing individuals to the average of all people in the experiment, we’re only comparing them to those people in the the same group. As a consequence, you’d expect the value of <span class="math inline">\(SS_w\)</span> to be smaller than the total sum of squares, because it’s completely ignoring any group differences, i.e., whether the drugs will have different effects on people’s moods.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>In order to quantify the extent of this variation, what we do is calculate the between-group sum of squares: <span class="math display">\[\begin{aligned} SS_{b} &amp;= \sum_{k=1}^{G} \sum_{i=1}^{N_k} ( \bar{Y}_{k} - \bar{Y} )^2 \\ &amp;= \sum_{k=1}^{G} N_k ( \bar{Y}_{k} - \bar{Y} )^2 \end{aligned}\]</span><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><span class="math inline">\(SS_w\)</span> is also referred to in an independent ANOVA as the error variance, or <span class="math inline">\(SS_{error}\)</span>.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>At a fundamental level ANOVA is a competition between two different statistical models, <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span>. When I described the null and alternative hypotheses at the start of the section, I was a little imprecise about what these models actually are. I’ll remedy that now, though you probably won’t like me for doing so. If you recall, our null hypothesis was that all of the group means are identical to one another. If so, then a natural way to think about the outcome variable <span class="math inline">\(Y_{ik}\)</span> is to describe individual scores in terms of a single population mean <span class="math inline">\(\mu\)</span>, plus the deviation from that population mean. This deviation is usually denoted <span class="math inline">\(\epsilon_{ik}\)</span> and is traditionally called the error or residual associated with that observation. Be careful though. Just like we saw with the word “significant”, the word “error” has a technical meaning in statistics that isn’t quite the same as its everyday English definition. In everyday language, “error” implies a mistake of some kind, but in statistics it doesn’t (or at least, not necessarily). With that in mind, the word “residual” is a better term than the word “error”. In statistics both words mean “leftover variability”, that is “stuff” that the model can’t explain. In any case, here’s what the null hypothesis looks like when we write it as a statistical model: <span class="math display">\[Y_{ik}=\mu+\epsilon_{ik}\]</span> where we make the assumption (discussed later) that the residual values <span class="math inline">\(\epsilon_{ik}\)</span> are normally distributed, with mean <span class="math inline">\(0\)</span> and a standard deviation <span class="math inline">\(\sigma\)</span> that is the same for all groups. To use the notation that we introduced in the [Introduction to probability] we would write this assumption like this: <span class="math display">\[\epsilon_{ik} \sim Normal(0,\sigma^2)\]</span> What about the alternative hypothesis, <span class="math inline">\(H_1\)</span>? The only difference between the null hypothesis and the alternative hypothesis is that we allow each group to have a different population mean. So, if we let <span class="math inline">\(\mu_k\)</span> denote the population mean for the k-th group in our experiment, then the statistical model corresponding to <span class="math inline">\(H_1\)</span> is: <span class="math display">\[Y_{ik}=\mu_k+\epsilon_{ik}\]</span> where, once again, we assume that the error terms are normally distributed with mean 0 and standard deviation <span class="math inline">\(\sigma\)</span>. That is, the alternative hypothesis also assumes that <span class="math inline">\(\epsilon \sim Normal(0,\sigma^2)\)</span> Okay, now that we’ve described the statistical models underpinning <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> in more detail, it’s now pretty straightforward to say what the mean square values are measuring, and what this means for the interpretation of <span class="math inline">\(F\)</span>. I won’t bore you with the proof of this but it turns out that the within-groups mean square, <span class="math inline">\(MS_w\)</span>, can be viewed as an estimator of the error variance <span class="math inline">\(\sigma^2\)</span> . The between-groups mean square <span class="math inline">\(MS_b\)</span> is also an estimator, but what it estimates is the error variance plus a quantity that depends on the true differences among the group means. If we call this quantity <span class="math inline">\(Q\)</span>, then we can see that the <span class="math inline">\(F\)</span> statistic is basically:<span class="math inline">\(^a\)</span> <span class="math display">\[F=\frac{\hat{Q}+\hat{\sigma}^2}{\hat{\sigma}^2}\]</span> where the true value <span class="math inline">\(Q = 0\)</span> if the null hypothesis is true, and <span class="math inline">\(Q &lt; 0\)</span> if the alternative hypothesis is true (e.g., <span class="citation" data-cites="Hays1994">Hays (<a href="References.html#ref-Hays1994" role="doc-biblioref">1994</a>)</span>, ch.&nbsp;10). Therefore, at a bare minimum the <span class="math inline">\(F\)</span> <em>value must be larger than</em> 1 to have any chance of rejecting the null hypothesis. Note that this doesn’t mean that it’s impossible to get an <span class="math inline">\(F\)</span>-value less than 1. What it means is that if the null hypothesis is true the sampling distribution of the <span class="math inline">\(F\)</span>-ratio has a mean of 1,<span class="math inline">\(^b\)</span> and so we need to see <span class="math inline">\(F\)</span>-values larger than 1 in order to safely reject the null. To be a bit more precise about the sampling distribution, notice that if the null hypothesis is true, both <span class="math inline">\(MS_b\)</span> and <span class="math inline">\(MS_w\)</span> are estimators of the variance of the residuals <span class="math inline">\(\epsilon_{ik}\)</span>. If those residuals are normally distributed, then you might suspect that the estimate of the variance of <span class="math inline">\(\epsilon_{ik}\)</span> is chi-square distributed, because (as discussed in the <a href="07-Introduction-to-probability.html#sec-Other-useful-distributions"><span>Section&nbsp;7.6</span></a>) that’s what a chi-square distribution is: it’s what you get when you square a bunch of normally-distributed things and add them up. And since the <span class="math inline">\(F\)</span> distribution is (again, by definition) what you get when you take the ratio between two things that are <span class="math inline">\(\chi^2\)</span> distributed, we have our sampling distribution. Obviously, I’m glossing over a whole lot of stuff when I say this, but in broad terms, this really is where our sampling distribution comes from. <br> — <br> <span class="math inline">\(^a\)</span>If you read ahead to <a href="14-Factorial-ANOVA.html"><span>Chapter&nbsp;14</span></a> and look at how the “treatment effect” at level <span class="math inline">\(k\)</span> of a factor is defined in terms of the <span class="math inline">\(\alpha_k\)</span> values (see [Factorial ANOVA 2: balanced designs, interactions allowed]), it turns out that <span class="math inline">\(Q\)</span> refers to a weighted mean of the squared treatment effects, <span class="math inline">\(Q = \frac{(\sum_{k=1}^{G}N_k \alpha_k^2)}{(G-1)}\)</span>. <br> — <br> <span class="math inline">\(^b\)</span>Or, if we want to be sticklers for accuracy, <span class="math inline">\(1+ \frac{2}{df_2-2}\)</span>.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Or, to be precise, party like “it’s 1899 and we’ve got no friends and nothing better to do with our time than do some calculations that wouldn’t have made any sense in 1899 because ANOVA didn’t exist until about the 1920s”.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>In the Excel <em>clinicaltrial-anova.xls</em> the value for <span class="math inline">\(SS_b\)</span> worked out to be very slightly different, <span class="math inline">\(3.45\)</span>, than that shown in the text above (rounding errors!).<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>The jamovi results are more accurate than the ones in the text above, due to rounding errors.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p><a href="https://daniellakens.blogspot.com/2015/06/why-you-should-use-omega-squared.html">https://daniellakens.blogspot.com/2015/06/why-you-should-use-omega-squared.html</a><a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>If you <em>do</em> have some theoretical basis for wanting to investigate some comparisons but not others, it’s a different story. In those circumstances you’re not really running “post hoc” analyses at all, you’re making “planned comparisons”. I do talk about this situation later in the book - <a href="14-Factorial-ANOVA.html#sec-The-method-of-planned-comparisons"><span>Section&nbsp;14.9</span></a>, but for now I want to keep things simple.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>It’s worth noting in passing that not all adjustment methods try to do this. What I’ve described here is an approach for controlling “family wise type I error rate”. However, there are other post hoc tests that seek to control the “false discovery rate”, which is a somewhat different thing.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>If you remember back to <a href="#a-worked-example">A worked example</a>, which I hope you at least skimmed even if you didn’t read the whole thing, I described the statistical models underpinning ANOVA in this way: <span class="math display">\[H_0:Y_{ik}=\mu + \epsilon_{ik}\]</span> <span class="math display">\[H_1:Y_{ik}=\mu_k + \epsilon_{ik}\]</span> In these equations <span class="math inline">\(\mu\)</span> refers to a single grand population mean which is the same for all groups, and <span class="math inline">\(\mu\)</span>k is the population mean for the k-th group. Up to this point we’ve been mostly interested in whether our data are best described in terms of a single grand mean (the null hypothesis) or in terms of different group-specific means (the alternative hypothesis). This makes sense, of course, as that’s actually the important research question! However, all of our testing procedures have, implicitly, relied on a specific assumption about the residuals, <span class="math inline">\(\epsilon\_{ik}\)</span>, namely that: <span class="math display">\[\epsilon_{ik} \sim Normal(0,\sigma^2)\]</span> None of the maths works properly without this bit. Or, to be precise, you can still do all the calculations and you’ll end up with an <span class="math inline">\(F\)</span>-statistic, but you have no guarantee that this <span class="math inline">\(F\)</span>-statistic actually measures what you think it’s measuring, and so any conclusions that you might draw on the basis of the <span class="math inline">\(F\)</span>-test might be wrong.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>The Levene test is shockingly simple. Suppose we have our outcome variable <span class="math inline">\(Y_{ik}\)</span>. All we do is define a new variable, which I’ll call <span class="math inline">\(Z_{ik}\)</span>, corresponding to the absolute deviation from the group mean: <span class="math display">\[Z_{ik}=Y_{ik}-\bar{Y}_{k}\]</span> Okay, what good does this do us? Well, let’s take a moment to think about what <span class="math inline">\(Z_{ik}\)</span> actually is and what we’re trying to test. The value of <span class="math inline">\(Z_{ik}\)</span> is a measure of how the <span class="math inline">\(i\)</span>-th observation in the <span class="math inline">\(k\)</span>-th group deviates from its group mean. And our null hypothesis is that all groups have the same variance, i.e., the same overall deviations from the group means! So the null hypothesis in a Levene test is that the population means of <span class="math inline">\(Z\)</span> are identical for all groups. Hmm. So what we need now is a statistical test of the null hypothesis that all group means are identical. Where have we seen that before? Oh right, that’s what ANOVA is, and so all that the Levene test does is run an ANOVA on the new variable <span class="math inline">\(Z_{ik}\)</span>. What about the Brown-Forsythe test? Does that do anything particularly different? Nope. The only change from the Levene test is that it constructs the transformed variable <span class="math inline">\(Z\)</span> in a slightly different way, using deviations from the group medians rather than deviations from the group means. That is, for the Brown-Forsythe test: <span class="math display">\[Z_{ik}=Y_{ik}-median_k(Y)\]</span> where <span class="math inline">\(median_k(Y)\)</span> is the median for group <span class="math inline">\(k\)</span>.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>So let’s let <span class="math inline">\(R\_{ik}\)</span> refer to the ranking given to the <span class="math inline">\(i\)</span>th member of the <span class="math inline">\(k\)</span>th group. Now, let’s calculate <span class="math inline">\(\bar{R}_k\)</span>, the average rank given to observations in the <span class="math inline">\(k\)</span>th group: <span class="math display">\[\bar{R}_k=\frac{1}{N_k}\sum_i R_{ik}\]</span> and let’s also calculate <span class="math inline">\(\bar{R}\)</span>, the grand mean rank: <span class="math display">\[\bar{R}=\frac{1}{N}\sum_i\sum_k R_{ik}\]</span> Now that we’ve done this, we can calculate the squared deviations from the grand mean rank <span class="math inline">\(\bar{R}\)</span>. When we do this for the individual scores, i.e., if we calculate <span class="math inline">\((R_{ik} - \bar{R})^2\)</span> , what we have is a “nonparametric” measure of how far the <span class="math inline">\(ik\)</span>-th observation deviates from the grand mean rank. When we calculate the squared deviation of the group means from the grand means, i.e., if we calculate <span class="math inline">\((R_{ik} - \bar{R})^2\)</span>, then what we have is a nonparametric measure of how much the group deviates from the grand mean rank. With this in mind, we’ll follow the same logic that we did with ANOVA and define our ranked sums of squares measures, much like we did earlier. First, we have our “total ranked sums of squares”: <span class="math display">\[RSS_{tot}=\sum_k\sum_i (R_{ik}-\bar{R})^2\]</span> and we can define the “between groups ranked sums of squares” like this: <span class="math display">\[\begin{aligned} RSS_{b}&amp; =\sum{k}\sum_{i}(\bar{R}_{k}-\bar{R})^2 \\ &amp;= \sum_{k} N_k (\bar{R}_{k}-\bar{R})^2 \end{aligned}\]</span> So, if the null hypothesis is true and there are no true group differences at all, you’d expect the between group rank sums <span class="math inline">\(RSS_b\)</span> to be very small, much smaller than the total rank sums <span class="math inline">\(RSS_{tot}\)</span>. Qualitatively this is very much the same as what we found when we went about constructing the ANOVA <span class="math inline">\(F\)</span>-statistic, but for technical reasons the Kruskal-Wallis test statistic, usually denoted <span class="math inline">\(K\)</span>, is constructed in a slightly different way: <span class="math display">\[K=(N-1) \times \frac{RSS_b}{RSS_{tot}}\]</span> and if the null hypothesis is true, then the sampling distribution of <span class="math inline">\(K\)</span> is approximately chi-square with <span class="math inline">\(G-1\)</span> degrees of freedom (where <span class="math inline">\(G\)</span> is the number of groups). The larger the value of <span class="math inline">\(K\)</span>, the less consistent the data are with the null hypothesis, so this is a one-sided test. We reject <span class="math inline">\(H_0\)</span> when <span class="math inline">\(K\)</span> is sufficiently large.<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p>However, from a purely mathematical perspective it’s needlessly complicated. I won’t show you the derivation, but you can use a bit of algebraic jiggery-pokery<span class="math inline">\(^a\)</span> to show that the equation for <span class="math inline">\(K\)</span> can be: <span class="math display">\[K=\frac{12}{N(N-1)}\sum_k N_k \bar{R}_k^2 -3(N+1)\]</span> It’s this last equation that you sometimes see given for <span class="math inline">\(K\)</span>. This is way easier to calculate than the version I described in the previous section, but it’s just that it’s totally meaningless to actual humans. It’s probably best to think of <span class="math inline">\(K\)</span> the way I described it earlier, as an analogue of ANOVA based on ranks. But keep in mind that the test statistic that gets calculated ends up with a rather different look to it than the one we used for our original ANOVA. <br>—<br> <span class="math inline">\(^a\)</span>A technical term.<a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p>More to the point, in the mathematical notation I introduced above, this is telling us that <span class="math inline">\(f_3 = 2\)</span>. Yay. So, now that we know this, the tie correction factor (TCF) is: <span class="math display">\[TCF=1-\frac{\sum_j f_j^3 - f_j}{N^3 - N}\]</span> The tie-corrected value of the Kruskal-Wallis statistic is obtained by dividing the value of <span class="math inline">\(K\)</span> by this quantity. It is this tie-corrected version that jamovi calculates.<a href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn18"><p><span class="math inline">\((n - k)\)</span>: (number of subjects - number of groups)<a href="#fnref18" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn19"><p>As with all of the chapters in this book, there are quite a few different sources that I’ve relied upon, but the one stand-out text that I’ve been most heavily influenced by is <span class="citation" data-cites="Sahai2000">Sahai &amp; Ageel (<a href="References.html#ref-Sahai2000" role="doc-biblioref">2000</a>)</span>. It’s not a good book for beginners, but it’s an excellent book for more advanced readers who are interested in understanding the mathematics behind ANOVA.<a href="#fnref19" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/davidfoxcroft\.github\.io\/lsj-book\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./12-Correlation-and-linear-regression.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Correlation and linear regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./14-Factorial-ANOVA.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Factorial ANOVA</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left"><a href="https://learnstatswithjamovi.com">learning statistics with jamovi</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>



</body></html>