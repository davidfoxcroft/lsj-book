<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>LEARNING STATISTICS WITH JAMOVI - 14&nbsp; Factorial ANOVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./15-Factor-Analysis.html" rel="next">
<link href="./13-Comparing-several-means-one-way-ANOVA.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['S$','S$'], ["\\[","\\]"] ]
      processEscapes: true
    }
  });
</script>
    

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="LEARNING STATISTICS WITH JAMOVI - 14&nbsp; Factorial ANOVA">
<meta property="og:description" content="">
<meta property="og:image" content="https://davidfoxcroft.github.io/lsj-book/images/fig14-1.png">
<meta property="og:site-name" content="LEARNING STATISTICS WITH JAMOVI">
<meta property="og:image:height" content="688">
<meta property="og:image:width" content="1280">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./10-Categorical-data-analysis.html">Statistical tools</a></li><li class="breadcrumb-item"><a href="./14-Factorial-ANOVA.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Factorial ANOVA</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">LEARNING STATISTICS WITH JAMOVI</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/davidfoxcroft/lsj-book/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./LEARNING-STATISTICS-WITH-JAMOVI.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Beginnings</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Why-do-we-learn-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Why do we learn statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-A-brief-introduction-to-research-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A brief introduction to research design</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">An introduction to jamovi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-Getting-started-with-jamovi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Getting started with jamovi</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Working with data</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-Descriptive-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Descriptive statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-Drawing-graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Drawing graphs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-Pragmatic-matters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Pragmatic matters</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Statistical theory</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Prelude-Part-IV.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prelude</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-Introduction-to-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introduction to probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-Estimating-unknown-quantities-from-a-sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Estimating unknown quantities from a sample</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-Hypothesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Hypothesis testing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Statistical tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Categorical-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Categorical data analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-Comparing-two-means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Comparing two means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-Correlation-and-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Correlation and linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-Comparing-several-means-one-way-ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Comparing several means (one-way ANOVA)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-Factorial-ANOVA.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Factorial ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-Factor-Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Factor Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Endings, alternatives and prospects</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-Bayesian-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Bayesian statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Epilogue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Epilogue</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./References.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./obp-team.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the team</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#factorial-anova-1-balanced-designs-focus-on-main-effects" id="toc-factorial-anova-1-balanced-designs-focus-on-main-effects" class="nav-link active" data-scroll-target="#factorial-anova-1-balanced-designs-focus-on-main-effects"><span class="header-section-number">14.1</span> Factorial ANOVA 1: balanced designs, focus on main effects</a>
  <ul class="collapse">
  <li><a href="#sec-What-hypotheses-are-we-testing" id="toc-sec-What-hypotheses-are-we-testing" class="nav-link" data-scroll-target="#sec-What-hypotheses-are-we-testing"><span class="header-section-number">14.1.1</span> What hypotheses are we testing?</a></li>
  <li><a href="#running-the-analysis-in-jamovi" id="toc-running-the-analysis-in-jamovi" class="nav-link" data-scroll-target="#running-the-analysis-in-jamovi"><span class="header-section-number">14.1.2</span> Running the analysis in jamovi</a></li>
  <li><a href="#how-are-the-sum-of-squares-calculated" id="toc-how-are-the-sum-of-squares-calculated" class="nav-link" data-scroll-target="#how-are-the-sum-of-squares-calculated"><span class="header-section-number">14.1.3</span> How are the sum of squares calculated?</a></li>
  <li><a href="#what-are-our-degrees-of-freedom" id="toc-what-are-our-degrees-of-freedom" class="nav-link" data-scroll-target="#what-are-our-degrees-of-freedom"><span class="header-section-number">14.1.4</span> What are our degrees of freedom?</a></li>
  <li><a href="#factorial-anova-versus-one-way-anovas" id="toc-factorial-anova-versus-one-way-anovas" class="nav-link" data-scroll-target="#factorial-anova-versus-one-way-anovas"><span class="header-section-number">14.1.5</span> Factorial ANOVA versus one-way ANOVAs</a></li>
  <li><a href="#what-kinds-of-outcomes-does-this-analysis-capture" id="toc-what-kinds-of-outcomes-does-this-analysis-capture" class="nav-link" data-scroll-target="#what-kinds-of-outcomes-does-this-analysis-capture"><span class="header-section-number">14.1.6</span> What kinds of outcomes does this analysis capture?</a></li>
  </ul></li>
  <li><a href="#factorial-anova-2-balanced-designs-interpreting-interactions" id="toc-factorial-anova-2-balanced-designs-interpreting-interactions" class="nav-link" data-scroll-target="#factorial-anova-2-balanced-designs-interpreting-interactions"><span class="header-section-number">14.2</span> Factorial ANOVA 2: balanced designs, interpreting interactions</a>
  <ul class="collapse">
  <li><a href="#what-exactly-is-an-interaction-effect" id="toc-what-exactly-is-an-interaction-effect" class="nav-link" data-scroll-target="#what-exactly-is-an-interaction-effect"><span class="header-section-number">14.2.1</span> What exactly is an interaction effect?</a></li>
  <li><a href="#degrees-of-freedom-for-the-interaction" id="toc-degrees-of-freedom-for-the-interaction" class="nav-link" data-scroll-target="#degrees-of-freedom-for-the-interaction"><span class="header-section-number">14.2.2</span> Degrees of freedom for the interaction</a></li>
  <li><a href="#running-the-anova-in-jamovi" id="toc-running-the-anova-in-jamovi" class="nav-link" data-scroll-target="#running-the-anova-in-jamovi"><span class="header-section-number">14.2.3</span> Running the ANOVA in jamovi</a></li>
  <li><a href="#interpreting-the-results" id="toc-interpreting-the-results" class="nav-link" data-scroll-target="#interpreting-the-results"><span class="header-section-number">14.2.4</span> Interpreting the results</a></li>
  </ul></li>
  <li><a href="#effect-size" id="toc-effect-size" class="nav-link" data-scroll-target="#effect-size"><span class="header-section-number">14.3</span> Effect size</a>
  <ul class="collapse">
  <li><a href="#estimated-group-means" id="toc-estimated-group-means" class="nav-link" data-scroll-target="#estimated-group-means"><span class="header-section-number">14.3.1</span> Estimated group means</a></li>
  </ul></li>
  <li><a href="#assumption-checking" id="toc-assumption-checking" class="nav-link" data-scroll-target="#assumption-checking"><span class="header-section-number">14.4</span> Assumption checking</a>
  <ul class="collapse">
  <li><a href="#homogeneity-of-variance" id="toc-homogeneity-of-variance" class="nav-link" data-scroll-target="#homogeneity-of-variance"><span class="header-section-number">14.4.1</span> Homogeneity of variance</a></li>
  <li><a href="#normality-of-residuals" id="toc-normality-of-residuals" class="nav-link" data-scroll-target="#normality-of-residuals"><span class="header-section-number">14.4.2</span> Normality of residuals</a></li>
  </ul></li>
  <li><a href="#sec-analysis-of-covariance-ancova" id="toc-sec-analysis-of-covariance-ancova" class="nav-link" data-scroll-target="#sec-analysis-of-covariance-ancova"><span class="header-section-number">14.5</span> Analysis of covariance (ANCOVA)</a>
  <ul class="collapse">
  <li><a href="#running-ancova-in-jamovi" id="toc-running-ancova-in-jamovi" class="nav-link" data-scroll-target="#running-ancova-in-jamovi"><span class="header-section-number">14.5.1</span> Running ANCOVA in jamovi</a></li>
  </ul></li>
  <li><a href="#sec-ANOVA-as-a-linear-model" id="toc-sec-ANOVA-as-a-linear-model" class="nav-link" data-scroll-target="#sec-ANOVA-as-a-linear-model"><span class="header-section-number">14.6</span> ANOVA as a linear model</a>
  <ul class="collapse">
  <li><a href="#some-data" id="toc-some-data" class="nav-link" data-scroll-target="#some-data"><span class="header-section-number">14.6.1</span> Some data</a></li>
  <li><a href="#anova-with-binary-factors-as-a-regression-model" id="toc-anova-with-binary-factors-as-a-regression-model" class="nav-link" data-scroll-target="#anova-with-binary-factors-as-a-regression-model"><span class="header-section-number">14.6.2</span> ANOVA with binary factors as a regression model</a></li>
  <li><a href="#how-to-encode-non-binary-factors-as-contrasts" id="toc-how-to-encode-non-binary-factors-as-contrasts" class="nav-link" data-scroll-target="#how-to-encode-non-binary-factors-as-contrasts"><span class="header-section-number">14.6.3</span> How to encode non binary factors as contrasts</a></li>
  <li><a href="#the-equivalence-between-anova-and-regression-for-non-binary-factors" id="toc-the-equivalence-between-anova-and-regression-for-non-binary-factors" class="nav-link" data-scroll-target="#the-equivalence-between-anova-and-regression-for-non-binary-factors"><span class="header-section-number">14.6.4</span> The equivalence between ANOVA and regression for non-binary factors</a></li>
  <li><a href="#degrees-of-freedom-as-parameter-counting" id="toc-degrees-of-freedom-as-parameter-counting" class="nav-link" data-scroll-target="#degrees-of-freedom-as-parameter-counting"><span class="header-section-number">14.6.5</span> Degrees of freedom as parameter counting!</a></li>
  </ul></li>
  <li><a href="#different-ways-to-specify-contrasts" id="toc-different-ways-to-specify-contrasts" class="nav-link" data-scroll-target="#different-ways-to-specify-contrasts"><span class="header-section-number">14.7</span> Different ways to specify contrasts</a>
  <ul class="collapse">
  <li><a href="#treatment-contrasts" id="toc-treatment-contrasts" class="nav-link" data-scroll-target="#treatment-contrasts"><span class="header-section-number">14.7.1</span> Treatment contrasts</a></li>
  <li><a href="#helmert-contrasts" id="toc-helmert-contrasts" class="nav-link" data-scroll-target="#helmert-contrasts"><span class="header-section-number">14.7.2</span> Helmert contrasts</a></li>
  <li><a href="#sum-to-zero-contrasts" id="toc-sum-to-zero-contrasts" class="nav-link" data-scroll-target="#sum-to-zero-contrasts"><span class="header-section-number">14.7.3</span> Sum to zero contrasts</a></li>
  <li><a href="#optional-contrasts-in-jamovi" id="toc-optional-contrasts-in-jamovi" class="nav-link" data-scroll-target="#optional-contrasts-in-jamovi"><span class="header-section-number">14.7.4</span> Optional contrasts in jamovi</a></li>
  </ul></li>
  <li><a href="#sec-Post-hoc-tests" id="toc-sec-Post-hoc-tests" class="nav-link" data-scroll-target="#sec-Post-hoc-tests"><span class="header-section-number">14.8</span> Post hoc tests</a></li>
  <li><a href="#sec-The-method-of-planned-comparisons" id="toc-sec-The-method-of-planned-comparisons" class="nav-link" data-scroll-target="#sec-The-method-of-planned-comparisons"><span class="header-section-number">14.9</span> The method of planned comparisons</a></li>
  <li><a href="#factorial-anova-3-unbalanced-designs" id="toc-factorial-anova-3-unbalanced-designs" class="nav-link" data-scroll-target="#factorial-anova-3-unbalanced-designs"><span class="header-section-number">14.10</span> Factorial ANOVA 3: unbalanced designs</a>
  <ul class="collapse">
  <li><a href="#the-coffee-data" id="toc-the-coffee-data" class="nav-link" data-scroll-target="#the-coffee-data"><span class="header-section-number">14.10.1</span> The <em>coffee</em> data</a></li>
  <li><a href="#standard-anova-does-not-exist-for-unbalanced-designs" id="toc-standard-anova-does-not-exist-for-unbalanced-designs" class="nav-link" data-scroll-target="#standard-anova-does-not-exist-for-unbalanced-designs"><span class="header-section-number">14.10.2</span> “Standard ANOVA” does not exist for unbalanced designs</a></li>
  <li><a href="#type-i-sum-of-squares" id="toc-type-i-sum-of-squares" class="nav-link" data-scroll-target="#type-i-sum-of-squares"><span class="header-section-number">14.10.3</span> Type I sum of squares</a></li>
  <li><a href="#type-iii-sum-of-squares" id="toc-type-iii-sum-of-squares" class="nav-link" data-scroll-target="#type-iii-sum-of-squares"><span class="header-section-number">14.10.4</span> Type III sum of squares</a></li>
  <li><a href="#type-ii-sum-of-squares" id="toc-type-ii-sum-of-squares" class="nav-link" data-scroll-target="#type-ii-sum-of-squares"><span class="header-section-number">14.10.5</span> Type II sum of squares</a></li>
  <li><a href="#effect-sizes-and-non-additive-sums-of-squares" id="toc-effect-sizes-and-non-additive-sums-of-squares" class="nav-link" data-scroll-target="#effect-sizes-and-non-additive-sums-of-squares"><span class="header-section-number">14.10.6</span> Effect sizes (and non-additive sums of squares)</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">14.11</span> Summary</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/davidfoxcroft/lsj-book/edit/main/14-Factorial-ANOVA.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/davidfoxcroft/lsj-book/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header">
<h1 class="title display-7"><span id="sec-Factorial-ANOVA" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Factorial ANOVA</span></span></h1>

</header>

<p>Over the course of the last few chapters we have done quite a lot. We have looked at statistical tests you can use when you have one nominal predictor variable with two groups (e.g., the <span class="math inline">\(t\)</span>-test in <a href="11-Comparing-two-means.html"><span>Chapter&nbsp;11</span></a>) or with three or more groups (<a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a>). <a href="12-Correlation-and-linear-regression.html"><span>Chapter&nbsp;12</span></a> introduced a powerful new idea, that is building statistical models with multiple continuous predictor variables used to explain a single outcome variable. For instance, a regression model could be used to predict the number of errors a student makes in a reading comprehension test based on the number of hours they studied for the test and their score on a standardised IQ test.</p>
<p>The goal in this chapter is to extend the idea of using multiple predictors into the ANOVA framework. For instance, suppose we were interested in using the reading comprehension test to measure student achievements in three different schools, and we suspect that girls and boys are developing at different rates (and so would be expected to have different performance on average). Each student is classified in two different ways: on the basis of their gender and on the basis of their school. What we’d like to do is analyse the reading comprehension scores in terms of both of these grouping variables. The tool for doing so is generically referred to as <strong>factorial ANOVA</strong>. However, since we have two grouping variables, we sometimes refer to the analysis as a two-way ANOVA, in contrast to the one-way ANOVAs that we ran in <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a>.</p>
<section id="factorial-anova-1-balanced-designs-focus-on-main-effects" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="factorial-anova-1-balanced-designs-focus-on-main-effects"><span class="header-section-number">14.1</span> Factorial ANOVA 1: balanced designs, focus on main effects</h2>
<p>When we discussed analysis of variance in <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a>, we assumed a fairly simple experimental design. Each person is in one of several groups and we want to know whether these groups have different mean scores on some outcome variable. In this section, I’ll discuss a broader class of experimental designs known as <strong>factorial designs</strong>, in which we have more than one grouping variable. I gave one example of how this kind of design might arise above. Another example appears in <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a> in which we were looking at the effect of different drugs on the mood.gain experienced by each person. In that chapter we did find a significant effect of drug, but at the end of the chapter we also ran an analysis to see if there was an effect of therapy. We didn’t find one, but there’s something a bit worrying about trying to run two separate analyses trying to predict the same outcome. Maybe there actually is an effect of therapy on mood gain, but we couldn’t find it because it was being “hidden” by the effect of drug? In other words, we’re going to want to run a single analysis that includes both drug and therapy as predictors. For this analysis each person is cross-classified by the drug they were given (a factor with 3 levels) and what therapy they received (a factor with 2 levels). We refer to this as a <span class="math inline">\(3 \times 2\)</span> factorial design.</p>
<p>If we cross-tabulate drug by therapy, using the ‘Frequencies’ – ‘Contingency Tables’ analysis in jamovi (see <a href="06-Pragmatic-matters.html#sec-Tabulating-and-cross-tabulating-data"><span>Section&nbsp;6.1</span></a>), we get the table shown in <a href="#fig-fig14-1">Figure&nbsp;<span>14.1</span></a>.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-1" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-1.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi results table titled &quot;Contingency Tables&quot; with data on 'drug' types (anxifree, joyzepam, placebo) and 'therapy' types (CBT, no. therapy, Total). Each drug type has equal counts for both therapy types:- 3 CBT, 3 no therapy, totaling to 6 for each drug. Total counts are 9 for CBT, 9 for no therapy, and 18 overall."></p>
<figcaption class="figure-caption">Figure&nbsp;14.1: jamovi contingency table of drug by therapy</figcaption>
</figure>
</div>
</div>
</div>
<p>As you can see, not only do we have participants corresponding to all possible combinations of the two factors, indicating that our design is <strong>completely crossed</strong>, it turns out that there are an equal number of people in each group. In other words, we have a balanced design. In this section I’ll talk about how to analyse data from <strong>balanced</strong> designs, since this is the simplest case. The story for unbalanced designs is quite tedious, so we’ll put it to one side for the moment.</p>
<section id="sec-What-hypotheses-are-we-testing" class="level3" data-number="14.1.1">
<h3 data-number="14.1.1" class="anchored" data-anchor-id="sec-What-hypotheses-are-we-testing"><span class="header-section-number">14.1.1</span> What hypotheses are we testing?</h3>
<p>Like one-way ANOVA, factorial ANOVA is a tool for testing certain types of hypotheses about population means. So a sensible place to start would be to be explicit about what our hypotheses actually are. However, before we can even get to that point, it’s really useful to have some clean and simple notation to describe the population means. Because of the fact that observations are cross-classified in terms of two different factors, there are quite a lot of different means that one might be interested in. To see this, let’s start by thinking about all the different sample means that we can calculate for this kind of design. Firstly, there’s the obvious idea that we might be interested in this list of group means (<a href="#tbl-tab14-1">Table&nbsp;<span>14.1</span></a>).</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-1" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-1"><caption>Table&nbsp;14.1:  <p>Group means for drug and therapy groups in the
<em>clinicaltrial.csv</em> data</p> </caption>
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">drug</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">therapy</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">mood.gain</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">no.therapy</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.30</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">no.therapy</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.40</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">joyzepam</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">no.therapy</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1.47</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">CBT</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.60</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">CBT</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1.03</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">joyzepam</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">CBT</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1.50</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Now, the next Table (<a href="#tbl-tab14-2">Table&nbsp;<span>14.2</span></a>) shows a list of the group means for all possible combinations of the two factors (e.g., people who received the placebo and no therapy, people who received the placebo while getting CBT, etc.). It is helpful to organise all these numbers, plus the marginal and grand means, into a single table which looks like this:</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-2" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-2"><caption>Table&nbsp;14.2:  <p>Group and total means for drug and therapy groups in the
<em>clinicaltrial.csv</em> data</p> </caption>
<colgroup><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">no therapy</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">CBT</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">total</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.30</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.60</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.45</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.40</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1.03</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.72</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">joyzepam</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1.47</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1.50</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1.48</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">total</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.72</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1.04</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.88</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Now, each of these different means is of course a sample statistic. It’s a quantity that pertains to the specific observations that we’ve made during our study. What we want to make inferences about are the corresponding population parameters. That is, the true means as they exist within some broader population. Those population means can also be organised into a similar table, but we’ll need a little mathematical notation to do so (<a href="#tbl-tab14-3">Table&nbsp;<span>14.3</span></a>). As usual, I’ll use the symbol <span class="math inline">\(\mu\)</span> to denote a population mean. However, because there are lots of different means, I’ll need to use subscripts to distinguish between them.</p>
<p>Here’s how the notation works. Our table is defined in terms of two factors. Each row corresponds to a different level of Factor A (in this case drug), and each column corresponds to a different level of Factor B (in this case therapy). If we let <span class="math inline">\(R\)</span> denote the number of rows in the table, and <span class="math inline">\(C\)</span> denote the number of columns, we can refer to this as an <span class="math inline">\(R \times C\)</span> factorial ANOVA. In this case <span class="math inline">\(R = 3\)</span> and <span class="math inline">\(C = 2\)</span>. We’ll use lowercase letters to refer to specific rows and columns, so <span class="math inline">\(\mu_{rc}\)</span> refers to the population mean associated with the <span class="math inline">\(r\)</span>-th level of Factor A (i.e.&nbsp;row number <span class="math inline">\(r\)</span>) and the <span class="math inline">\(c\)</span>-th level of Factor B (column number c).<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> So the population means are now written like in <a href="#tbl-tab14-1">Table&nbsp;<span>14.1</span></a>:</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-3" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-3"><caption>Table&nbsp;14.3:  <p>Notation for population means in a factorial table</p> </caption>
<colgroup><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">no therapy</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">CBT</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">total</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{11} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{12} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{21} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{22} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">joyzepam</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{31} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{32} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">total</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;"></td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Okay, what about the remaining entries? For instance, how should we describe the average mood gain across the entire (hypothetical) population of people who might be given Joyzepam in an experiment like this, regardless of whether they were in CBT? We use the “dot” notation to express this. In the case of Joyzepam, notice that we’re talking about the mean associated with the third row in the table. That is, we’re averaging across two cell means (i.e., <span class="math inline">\(\mu_{31}\)</span> and <span class="math inline">\(\mu_{32}\)</span>). The result of this averaging is referred to as a marginal mean, and would be denoted <span class="math inline">\(\mu_3.\)</span> in this case. The <strong>marginal mean</strong> for CBT corresponds to the population mean associated with the second column in the table, so we use the notation because it is the mean obtained by averaging (marginalising)<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> over both. So our full table of population means can be written down like in <a href="#tbl-tab14-4">Table&nbsp;<span>14.4</span></a>.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-4" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-4"><caption>Table&nbsp;14.4:  <p>Notation for population and total means in a factorial table</p> </caption>
<colgroup><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">no therapy</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">CBT</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">total</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{11} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{12} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \mu_{1.} \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{21} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{22} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \mu_{2.} \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">joyzepam</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{31} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{32} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \mu_{3.} \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">total</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{.1} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{.2} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \mu_{..} \)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Now that we have this notation, it is straightforward to formulate and express some hypotheses. Let’s suppose that the goal is to find out two things. First, does the choice of drug have any effect on mood? And second, does CBT have any effect on mood? These aren’t the only hypotheses that we could formulate of course, and we’ll see a really important example of a different kind of hypothesis in the section <a href="#factorial-anova-2-balanced-designs-interpreting-interactions">Factorial ANOVA 2: balanced designs, interpreting interactions</a>, but these are the two simplest hypotheses to test, and so we’ll start there. Consider the first test. If the drug has no effect then we would expect all of the row means to be identical, right? So that’s our null hypothesis. On the other hand, if the drug does matter then we should expect these row means to be different. Formally, we write down our null and alternative hypotheses in terms of the equality of marginal means: <span class="math display">\[\text{Null hypothesis, } H_0 \text{: row means are the same, i.e., } \mu_{1. } = \mu_{2. } = \mu_{3. }\]</span> <span class="math display">\[\text{Alternative hypothesis, } H_1 \text{: at least one row mean is different}\]</span></p>
<p>It’s worth noting that these are exactly the same statistical hypotheses that we formed when we ran a one-way ANOVA on these data in <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a>. Back then I used the notation <span class="math inline">\(\mu \times {P}\)</span> to refer to the mean mood gain for the placebo group, with <span class="math inline">\(\mu{A}\)</span> and <span class="math inline">\(\mu \times {J}\)</span> corresponding to the group means for the two drugs, and the null hypothesis was <span class="math inline">\(\mu{P} = \mu{A} = \mu{J}\)</span> . So we’re actually talking about the same hypothesis, it’s just that the more complicated ANOVA requires more careful notation due to the presence of multiple grouping variables, so we’re now referring to this hypothesis as <span class="math inline">\(\mu_{ 1.} = \mu_{ 2.} = \mu_{ 3.}\)</span> . However, as we’ll see shortly, although the hypothesis is identical the test of that hypothesis is subtly different due to the fact that we’re now acknowledging the existence of the second grouping variable.</p>
<p>Speaking of the other grouping variable, you won’t be surprised to discover that our second hypothesis test is formulated the same way. However, since we’re talking about the psychological therapy rather than drugs our null hypothesis now corresponds to the equality of the column means: <span class="math display">\[\text{Null hypothesis, } H_0 \text{: column means are the same, i.e., } \mu_{ .1} = \mu_{ .2} \]</span> <span class="math display">\[\text{Alternative hypothesis, } H_1 \text{: column means are different, i.e., } \mu_{ .1} \neq \mu_{ .2}\]</span></p>
</section>
<section id="running-the-analysis-in-jamovi" class="level3" data-number="14.1.2">
<h3 data-number="14.1.2" class="anchored" data-anchor-id="running-the-analysis-in-jamovi"><span class="header-section-number">14.1.2</span> Running the analysis in jamovi</h3>
<p>The null and alternative hypotheses that I described in the last section should seem awfully familiar. They’re basically the same as the hypotheses that we were testing in our simpler oneway ANOVAs in <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a>. So you’re probably expecting that the hypothesis tests that are used in factorial ANOVA will be essentially the same as the <span class="math inline">\(F\)</span>-test from <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a>. You’re expecting to see references to sums of squares (<span class="math inline">\(SS\)</span>), mean squares (<span class="math inline">\(MS\)</span>), degrees of freedom (<span class="math inline">\(df\)</span>), and finally an <span class="math inline">\(F\)</span>-statistic that we can convert into a <span class="math inline">\(p\)</span>-value, right? Well, you’re absolutely and completely right. So much so that I’m going to depart from my usual approach. Throughout this book, I’ve generally taken the approach of describing the logic (and to an extent the mathematics) that underpins a particular analysis first and only then introducing the analysis in jamovi. This time I’m going to do it the other way around and show you how to do it in jamovi first. The reason for doing this is that I want to highlight the similarities between the simple one-way ANOVA tool that we discussed in <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a>, and the more complicated approach that we’re going to use in this chapter.</p>
<p>If the data you’re trying to analyse correspond to a balanced factorial design then running your analysis of variance is easy. To see how easy it is, let’s start by reproducing the original analysis from <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a>. In case you’ve forgotten, for that analysis we were using only a single factor (i.e., drug) to predict our outcome variable (i.e., mood.gain), and we got the results shown in <a href="#fig-fig14-2">Figure&nbsp;<span>14.2</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-2" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-2.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi results table showing ANOVA results for mood gain with columns for Sum of Squares, df (degrees of freedom), Mean Square, F, $p$-value, and η² (eta squared). For &quot;drug,&quot; Sum of Squares is 3.45, df is 2, Mean Square is 1.73, F is 18.61, p is 0.00009, and η² is 0.71. Residuals have a Sum of Squares of 1.39, df of 15, and Mean Square of 0.09."></p>
<figcaption class="figure-caption">Figure&nbsp;14.2: jamovi one-way ANOVA of mood.gain by drug</figcaption>
</figure>
</div>
</div>
</div>
<p>Now, suppose I’m also curious to find out if therapy has a relationship to mood.gain. In light of what we’ve seen from our discussion of multiple regression in <a href="12-Correlation-and-linear-regression.html"><span>Chapter&nbsp;12</span></a>, you probably won’t be surprised that all we have to do is add therapy as a second ‘Fixed Factor’ in the analysis, see <a href="#fig-fig14-3">Figure&nbsp;<span>14.3</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-3" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-3.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi results table showing ANOVA test results for mood gain with factors &quot;drug,&quot; &quot;therapy,&quot; and their interaction. Includes Sum of Squares, df, Mean Square, F, $p$-values, η², η²p, and ω². Key results indicate significant effects for &quot;drug&quot; and &quot;therapy,&quot; but not their interaction."></p>
<figcaption class="figure-caption">Figure&nbsp;14.3: jamovi two-way anova of mood.gain by drug and therapy</figcaption>
</figure>
</div>
</div>
</div>
<p>This output is pretty simple to read too. The first row of the table reports a between-group sum of squares (<span class="math inline">\(SS\)</span>) value associated with the drug factor, along with a corresponding between-group <span class="math inline">\(df\)</span> value. It also calculates a mean square value (<span class="math inline">\(MS\)</span>), an <span class="math inline">\(F\)</span>-statistic and a <span class="math inline">\(p\)</span>-value. There is also a row corresponding to the therapy factor, a row corresponding to the interaction between the drug factor and the therapy factor (which we won’t cover just yet – more on interactions later), and a row corresponding to the residuals (i.e., the within groups variation).</p>
<p>Not only are all of the individual quantities pretty familiar, the relationships between these different quantities have remained unchanged, just like we saw with the original one-way ANOVA. Note that the mean square value is calculated by dividing <span class="math inline">\(SS\)</span> by the corresponding <span class="math inline">\(df\)</span>. That is, it’s still true that: <span class="math display">\[MS=\frac{SS}{df}\]</span></p>
<p>regardless of whether we’re talking about drug, therapy or the residuals. To see this, let’s not worry about how the sums of squares values are calculated. Instead, let’s take it on faith that jamovi has calculated the <span class="math inline">\(SS\)</span> values correctly, and try to verify that all the rest of the numbers make sense. First, note that for the drug factor, we divide <span class="math inline">\(3.45\)</span> by <span class="math inline">\(2\)</span> and end up with a mean square value of <span class="math inline">\(1.73\)</span>. For the therapy factor, there’s only 1 degree of freedom, so our calculations are even simpler: dividing <span class="math inline">\(0.47\)</span> (the <span class="math inline">\(SS\)</span> value) by 1 gives us an answer of <span class="math inline">\(0.47\)</span> (the <span class="math inline">\(MS\)</span> value).</p>
<p>Turning to the <span class="math inline">\(F\)</span>-statistics and the <span class="math inline">\(p\)</span>-values, notice that we have one corresponding to the drug factor and one corresponding to the therapy factor. Regardless of which one we’re talking about, the <span class="math inline">\(F\)</span>-statistic is calculated by dividing the mean square value associated with the factor by the mean square value associated with the residuals. If we use “A” as shorthand notation to refer to the first factor (Factor A; in this case drug) and “R” as shorthand notation to refer to the residuals, then the <span class="math inline">\(F\)</span>-statistic associated with Factor A is denoted <span class="math inline">\(F_A\)</span>, and is calculated as: <span class="math display">\[F_A=\frac{MS_A}{MS_R}\]</span></p>
<p>and an equivalent formula exists for Factor B (i.e., therapy). Note that this use of “R” to refer to residuals is a bit awkward, since we also used the letter R to refer to the number of rows in the table, but I’m only going to use “R” to mean residuals in the context of <span class="math inline">\({SS_R}\)</span> and <span class="math inline">\({MS_R}\)</span>, so hopefully this shouldn’t be confusing. Anyway, to apply this formula to the drugs factor we take the mean square of 1.73 and divide it by the residual mean square value of <span class="math inline">\(0.05\)</span>, which gives us an <span class="math inline">\(F\)</span>-statistic of 31.71.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> The corresponding calculation for the therapy variable would be to divide <span class="math inline">\(0.47\)</span> by <span class="math inline">\(0.05\)</span> which gives <span class="math inline">\(8.58\)</span> as the <span class="math inline">\(F\)</span>-statistic. Not surprisingly, of course, these are the same values that jamovi has reported in the ANOVA table above.</p>
<p>Also in the ANOVA table is the calculation of the <span class="math inline">\(p\)</span>-values. Once again, there is nothing new here. For each of our two factors what we’re trying to do is test the null hypothesis that there is no relationship between the factor and the outcome variable (I’ll be a bit more precise about this later on). To that end, we’ve (apparently) followed a similar strategy to what we did in the one-way ANOVA and have calculated an <span class="math inline">\(F\)</span>-statistic for each of these hypotheses. To convert these to <span class="math inline">\(p\)</span>-values, all we need to do is note that the sampling distribution for the <span class="math inline">\(F\)</span>-statistic under the null hypothesis (that the factor in question is irrelevant) is an <span class="math inline">\(F\)</span>-distribution. Also note that the two degrees of freedom values are those corresponding to the factor and those corresponding to the residuals. For the drug factor we’re talking about an <span class="math inline">\(F\)</span>-distribution with 2 and 12 degrees of freedom (I’ll discuss degrees of freedom in more detail later). In contrast, for the therapy factor the sampling distribution is <span class="math inline">\(F\)</span> with 1 and 12 degrees of freedom.</p>
<p>At this point, I hope you can see that the ANOVA table for this more complicated factorial analysis should be read in much the same way as the ANOVA table for the simpler one way analysis. In short, it’s telling us that the factorial ANOVA for our <span class="math inline">\(3 \times 2\)</span> design found a significant effect of drug (<span class="math inline">\(F_{2,12} = 31.71, p &lt; .001\)</span>) as well as a significant effect of therapy (<span class="math inline">\(F_{1,12} = 8.58, p = .013\)</span>). Or, to use the more technically correct terminology, we would say that there are two <strong>main effects</strong> of drug and therapy. At the moment, it probably seems a bit redundant to refer to these as “main” effects, but it actually does make sense. Later on, we’re going to cover “interactions” between the two factors, and so we generally make a distinction between main effects and interaction effects.</p>
</section>
<section id="how-are-the-sum-of-squares-calculated" class="level3" data-number="14.1.3">
<h3 data-number="14.1.3" class="anchored" data-anchor-id="how-are-the-sum-of-squares-calculated"><span class="header-section-number">14.1.3</span> How are the sum of squares calculated?</h3>
<p>In the previous section I had two goals. Firstly, to show you that the jamovi method needed to do factorial ANOVA is pretty much the same as what we used for a one-way ANOVA. The only difference is the addition of a second factor. Secondly, I wanted to show you what the ANOVA table looks like in this case, so that you can see from the outset that the basic logic and structure behind factorial ANOVA is the same as that which underpins one-way ANOVA. Try to hold onto that feeling. It’s genuinely true, insofar as factorial ANOVA is built in more or less the same way as the simpler one-way ANOVA model. It’s just that this feeling of familiarity starts to evaporate once you start digging into the details. Traditionally, this comforting sensation is replaced by an urge to hurl abuse at the authors of statistics textbooks.</p>
<p>Okay, let’s start by looking at some of those details. The explanation that I gave in the last section illustrates the fact that the hypothesis tests for the main effects (of drug and therapy in this case) are <span class="math inline">\(F\)</span>-tests, but what it doesn’t do is show you how the sum of squares (<span class="math inline">\(SS\)</span>) values are calculated. Nor does it tell you explicitly how to calculate degrees of freedom (<span class="math inline">\(df\)</span> values) though that’s a simple thing by comparison. Let’s assume for now that we have only two predictor variables, Factor A and Factor B. If we use <span class="math inline">\(Y\)</span> to refer to the outcome variable, then we would use <span class="math inline">\(Y{rci}\)</span> to refer to the outcome associated with the <span class="math inline">\(i\)</span>-th member of group <span class="math inline">\(rc\)</span> (i.e., level/row <span class="math inline">\(r\)</span> for Factor A and level/column <span class="math inline">\(c\)</span> for Factor B). Thus, if we use <span class="math inline">\(\bar{Y}\)</span> to refer to a sample mean, we can use the same notation as before to refer to group means, marginal means and grand means. That is, <span class="math inline">\(\bar{Y}_{rc}\)</span> is the sample mean associated with the <span class="math inline">\(r\)</span>th level of Factor A and the <span class="math inline">\(c\)</span>th level of Factor B, <span class="math inline">\(\bar{Y}_{r.}\)</span> would be the marginal mean for the <span class="math inline">\(r\)</span>th level of Factor A, <span class="math inline">\(\bar{Y}_{.c}\)</span> would be the marginal mean for the <span class="math inline">\(c\)</span>th level of Factor B, and <span class="math inline">\(\bar{Y}_{..}\)</span> is the grand mean. In other words, our sample means can be organised into the same table as the population means. For our clinical trial data, that table is shown in <a href="#tbl-tab14-5">Table&nbsp;<span>14.5</span></a>.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-5" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-5"><caption>Table&nbsp;14.5:  <p>Notation for sample means for the clinical trial data</p> </caption>
<colgroup><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">no therapy</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">CBT</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">total</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{11} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{12} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{1.} \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{21} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{22} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{2.} \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">joyzepam</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{31} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{32} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{3.} \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">total</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{.1} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{.2} \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{..} \)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>And if we look at the sample means that I showed earlier, we have <span class="math inline">\(\bar{Y}_{11} = 0.30\)</span>, <span class="math inline">\(\bar{Y}_{12} = 0.60\)</span> etc. In our clinical trial example, the drugs factor has 3 levels and the therapy factor has 2 levels, and so what we’re trying to run is a <span class="math inline">\(3 \times 2\)</span> factorial ANOVA. However, we’ll be a little more general and say that Factor A (the row factor) has <span class="math inline">\(r\)</span> levels and Factor B (the column factor) has <span class="math inline">\(c\)</span> levels, and so what we’re running here is an <span class="math inline">\(r \times c\)</span> factorial ANOVA.</p>
<p>[Additional technical detail<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>]</p>
</section>
<section id="what-are-our-degrees-of-freedom" class="level3" data-number="14.1.4">
<h3 data-number="14.1.4" class="anchored" data-anchor-id="what-are-our-degrees-of-freedom"><span class="header-section-number">14.1.4</span> What are our degrees of freedom?</h3>
<p>The degrees of freedom are calculated in much the same way as for one-way ANOVA. For any given factor, the degrees of freedom is equal to the number of levels minus 1 (i.e., <span class="math inline">\(R - 1\)</span> for the row variable Factor A, and <span class="math inline">\(C - 1\)</span> for the column variable Factor B). So, for the drugs factor we obtain <span class="math inline">\(df = 2\)</span>, and for the therapy factor we obtain <span class="math inline">\(df = 1\)</span>. Later on, when we discuss the interpretation of ANOVA as a regression model (see <a href="#sec-ANOVA-as-a-linear-model"><span>Section&nbsp;14.6</span></a>), I’ll give a clearer statement of how we arrive at this number. But for the moment we can use the simple definition of degrees of freedom, namely that the degrees of freedom equals the number of quantities that are observed, minus the number of constraints. So, for the drugs factor, we observe 3 separate group means, but these are constrained by 1 grand mean, and therefore the degrees of freedom is 2.</p>
</section>
<section id="factorial-anova-versus-one-way-anovas" class="level3" data-number="14.1.5">
<h3 data-number="14.1.5" class="anchored" data-anchor-id="factorial-anova-versus-one-way-anovas"><span class="header-section-number">14.1.5</span> Factorial ANOVA versus one-way ANOVAs</h3>
<p>Now that we’ve seen how a factorial ANOVA works, it’s worth taking a moment to compare it to the results of the one way analyses, because this will give us a really good sense of why it’s a good idea to run the factorial ANOVA. In <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a> I ran a one-way ANOVA that looked to see if there are any differences between drugs, and a second one-way ANOVA to see if there were any differences between therapies. As we saw in the section <a href="#sec-What-hypotheses-are-we-testing"><span>Section&nbsp;14.1.1</span></a>, the null and alternative hypotheses tested by the one-way ANOVAs are in fact identical to the hypotheses tested by the factorial ANOVA. Looking even more carefully at the ANOVA tables, we can see that the sum of squares associated with the factors are identical in the two different analyses (3.45 for drug and 0.92 for therapy), as are the degrees of freedom (2 for drug, 1 for therapy). But they don’t give the same answers! Most notably, when we ran the one-way ANOVA for therapy in <a href="13-Comparing-several-means-one-way-ANOVA.html#sec-On-the-relationship-between-ANOVA-and-the-Student-t-test"><span>Section&nbsp;13.9</span></a> we didn’t find a significant effect (the <span class="math inline">\(p\)</span>-value was .21). However, when we look at the main effect of therapy within the context of the two-way ANOVA, we do get a significant effect (<span class="math inline">\(p\)</span> = .019). The two analyses are clearly not the same.</p>
<p>Why does that happen? The answer lies in understanding how the residuals are calculated. Recall that the whole idea behind an <span class="math inline">\(F\)</span>-test is to compare the variability that can be attributed to a particular factor with the variability that cannot be accounted for (the residuals). If you run a one-way ANOVA for therapy, and therefore ignore the effect of drug, the ANOVA will end up dumping all of the drug-induced variability into the residuals! This has the effect of making the data look more noisy than they really are, and the effect of therapy which is correctly found to be significant in the two-way ANOVA now becomes non-significant. If we ignore something that actually matters (e.g., drug) when trying to assess the contribution of something else (e.g., therapy) then our analysis will be distorted. Of course, it’s perfectly okay to ignore variables that are genuinely irrelevant to the phenomenon of interest. If we had recorded the colour of the walls, and that turned out to be a non-significant factor in a three-way ANOVA, it would be perfectly okay to disregard it and just report the simpler two-way ANOVA that doesn’t include this irrelevant factor. What you shouldn’t do is drop variables that actually make a difference!</p>
</section>
<section id="what-kinds-of-outcomes-does-this-analysis-capture" class="level3" data-number="14.1.6">
<h3 data-number="14.1.6" class="anchored" data-anchor-id="what-kinds-of-outcomes-does-this-analysis-capture"><span class="header-section-number">14.1.6</span> What kinds of outcomes does this analysis capture?</h3>
<p>The ANOVA model that we’ve been talking about so far covers a range of different patterns that we might observe in our data. For instance, in a two-way ANOVA design there are four possibilities: (a) only Factor A matters, (b) only Factor B matters, (c) both A and B matter, and (d) neither A nor B matters. An example of each of these four possibilities is plotted in <a href="#fig-fig14-4">Figure&nbsp;<span>14.4</span></a>.</p>
</section>
</section>
<section id="factorial-anova-2-balanced-designs-interpreting-interactions" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="factorial-anova-2-balanced-designs-interpreting-interactions"><span class="header-section-number">14.2</span> Factorial ANOVA 2: balanced designs, interpreting interactions</h2>
<p>The four patterns of data shown in <a href="#fig-fig14-4">Figure&nbsp;<span>14.4</span></a> are all quite realistic. There are a great many data sets that produce exactly those patterns. However, they are not the whole story and the ANOVA model that we have been talking about up to this point is not sufficient to fully account for a table of group means. Why not? Well, so far we have the ability to talk about the idea that drugs can influence mood, and therapy can influence mood, but no way of talking about the possibility of an <strong>interaction</strong> between the two. An interaction between A and B is said to occur whenever the effect of Factor <span class="math inline">\(A\)</span> is <em>different</em>, depending on which level of Factor <span class="math inline">\(B\)</span> we’re talking about. Several examples of an interaction effect with the context of a <span class="math inline">\(2 \times 2\)</span> ANOVA are shown in <a href="#fig-fig14-5">Figure&nbsp;<span>14.5</span></a>. To give a more concrete example, suppose that the operation of Anxifree and Joyzepam is governed by quite different physiological mechanisms. One consequence of this is that while Joyzepam has more or less the same effect on mood regardless of whether one is in therapy, Anxifree is actually much more effective when administered in conjunction with CBT. The ANOVA that we developed in the previous section does not capture this idea. To get some idea of whether an interaction is actually happening here, it helps to plot the various group means. In jamovi this is done via the ANOVA ‘Estimated Marginal Means’ option – just move drug and therapy across into the ‘Marginal Means’ box under ‘Term 1’. This should look something like <a href="#fig-fig14-6">Figure&nbsp;<span>14.6</span></a>. Our main concern relates to the fact that the two lines aren’t parallel. The effect of CBT (difference between solid line and dotted line) when the drug is Joyzepam (right side) appears to be near zero, even smaller than the effect of CBT when a placebo is used (left side). However, when Anxifree is administered, the effect of CBT is larger than the placebo (middle). Is this effect real, or is this just random variation due to chance? Our original ANOVA cannot answer this question, because we make no allowances for the idea that interactions even exist! In this section, we’ll fix this problem.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-4" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="14-Factorial-ANOVA_files/figure-html/fig-fig14-4-1.png" class="img-fluid figure-img" style="width:80.0%" alt="Four graphs showing the interaction of two factors (A and B) on group means. Graph (a):- Factor A has an effect, B does not. Graph (b):- Factor B has an effect, A does not. Graph (c):- Both A and B have an effect. Graph (d):- Neither A nor B have an effect."></p>
<figcaption class="figure-caption">Figure&nbsp;14.4: The four different outcomes for a <span class="math inline">\(2 \times 2\)</span> ANOVA when no interactions are present. In panel (a) we see a main effect of Factor A and no effect of Factor B. Panel (b) shows a main effect of Factor B but no effect of Factor A. Panel (c) shows main effects of both Factor A and Factor B. Finally, panel (d) shows no effect of either factor</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-5" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="14-Factorial-ANOVA_files/figure-html/fig-fig14-5-1.png" class="img-fluid figure-img" style="width:80.0%" alt="Four line graphs (a-d) depict interactions between two factors (A and B) at two levels (1 and 2). The y-axis in each graph is labeled &quot;Group mean&quot; and the x-axis &quot;Factor B.&quot; Graph (a) shows a crossover interaction. Graphs (b), (c), and (d) highlight different effects for one level of Factor A or B, or one differing cell."></p>
<figcaption class="figure-caption">Figure&nbsp;14.5: Qualitatively different interactions for a <span class="math inline">\(2 \times 2\)</span> ANOVA</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-6" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-6.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi screenshot of the interface for analyzing clinical trial data is shown. The screen features ANOVA outputs, with a graph displaying estimated marginal means of mood gain across different drug therapies. Therapy options are CBT and no therapy, with axes for mood gain and types of drugs."></p>
<figcaption class="figure-caption">Figure&nbsp;14.6: jamovi screen showing how to generate a descriptive interaction plot in ANOVA using the clinical trial data</figcaption>
</figure>
</div>
</div>
</div>
<section id="what-exactly-is-an-interaction-effect" class="level3" data-number="14.2.1">
<h3 data-number="14.2.1" class="anchored" data-anchor-id="what-exactly-is-an-interaction-effect"><span class="header-section-number">14.2.1</span> What exactly is an interaction effect?</h3>
<p>The key idea that we’re going to introduce in this section is that of an interaction effect. In the ANOVA model we have looked at so far there are only two factors involved in our model (i.e., drug and therapy). But when we add an interaction we add a new component to the model: the combination of drug and therapy. Intuitively, the idea behind an interaction effect is fairly simple. It just means that the effect of Factor A is different, depending on which level of Factor B we’re talking about. But what does that actually mean in terms of our data? The plot in <a href="#fig-fig14-5">Figure&nbsp;<span>14.5</span></a> depicts several different patterns that, although quite different to each other, would all count as an interaction effect. So it’s not entirely straightforward to translate this qualitative idea into something mathematical that a statistician can work with.</p>
<p>[Additional technical detail<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>]</p>
</section>
<section id="degrees-of-freedom-for-the-interaction" class="level3" data-number="14.2.2">
<h3 data-number="14.2.2" class="anchored" data-anchor-id="degrees-of-freedom-for-the-interaction"><span class="header-section-number">14.2.2</span> Degrees of freedom for the interaction</h3>
<p>Calculating the degrees of freedom for the interaction is, once again, slightly trickier than the corresponding calculation for the main effects. To start with, let’s think about the ANOVA model as a whole. Once we include interaction effects in the model we’re allowing every single group to have a unique mean, <span class="math inline">\(mu_{rc}\)</span>. For an <span class="math inline">\(R \times C\)</span> factorial ANOVA, this means that there are <span class="math inline">\(R \times C\)</span> quantities of interest in the model and only the one constraint: all of the group means need to average out to the grand mean. So the model as a whole needs to have (<span class="math inline">\(R \times C)-1\)</span> degrees of freedom. But the main effect of Factor A has <span class="math inline">\(R-1\)</span> degrees of freedom, and the main effect of Factor B has <span class="math inline">\(C-1\)</span> degrees of freedom. This means that the degrees of freedom associated with the interaction is: <span class="math display">\[
\begin{aligned}
df_{A:B} &amp; = (R \times C - 1) - (R - 1) - (C - 1) \\
&amp; = RC - R - C + 1 \\
&amp; = (R-1)(C-1)
\end{aligned}
\]</span></p>
<p>which is just the product of the degrees of freedom associated with the row factor and the column factor.</p>
<p>What about the residual degrees of freedom? Because we’ve added interaction terms which absorb some degrees of freedom, there are fewer residual degrees of freedom left over. Specifically, note that if the model with interaction has a total of <span class="math inline">\((R \times C) - 1\)</span>, and there are <span class="math inline">\(N\)</span> observations in your data set that are constrained to satisfy 1 grand mean, your residual degrees of freedom now become <span class="math inline">\(N - (R \times C) - 1 + 1\)</span>, or just <span class="math inline">\(N - (R \times C)\)</span>.</p>
</section>
<section id="running-the-anova-in-jamovi" class="level3" data-number="14.2.3">
<h3 data-number="14.2.3" class="anchored" data-anchor-id="running-the-anova-in-jamovi"><span class="header-section-number">14.2.3</span> Running the ANOVA in jamovi</h3>
<p>Adding interaction terms to the ANOVA model in jamovi is straightforward. In fact it is more than straightforward because it is the default option for ANOVA. This means that when you specify an ANOVA with two factors, e.g., drug and therapy then the interaction component – drug <span class="math inline">\(\times\)</span> therapy – is added automatically to the model.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> When we run the ANOVA with the interaction term included, then we get the results shown in <a href="#fig-fig14-7">Figure&nbsp;<span>14.7</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-7" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-7.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi table summarizing the results of an ANOVA test on mood gain. It shows Sum of Squares, degrees of freedom (df), Mean Square, $F$-value, $p$-value, η², η²p, and ω² for drug, therapy, their interaction, and residuals."></p>
<figcaption class="figure-caption">Figure&nbsp;14.7: Results for the full factorial model, including the interaction component drug <span class="math inline">\(\times\)</span> therapy</figcaption>
</figure>
</div>
</div>
</div>
<p>As it turns out, while we do have a significant main effect of drug (<span class="math inline">\(F_{2,12} = 31.7, p &lt; .001\)</span>) and therapy type (<span class="math inline">\(F_{1,12} = 8.6, p = .013\)</span>), there is no significant interaction between the two (<span class="math inline">\(F_{2,12} = 2.5, p = 0.125\)</span>).</p>
</section>
<section id="interpreting-the-results" class="level3" data-number="14.2.4">
<h3 data-number="14.2.4" class="anchored" data-anchor-id="interpreting-the-results"><span class="header-section-number">14.2.4</span> Interpreting the results</h3>
<p>There’s a couple of very important things to consider when interpreting the results of factorial ANOVA. First, there’s the same issue that we had with one-way ANOVA, which is that if you obtain a significant main effect of (say) drug, it doesn’t tell you anything about which drugs are different to one another. To find that out, you need to run additional analyses. We’ll talk about some analyses that you can run in later Sections: <a href="#different-ways-to-specify-contrasts">Different ways to specify contrasts</a> and <a href="#sec-Post-hoc-tests">Post hoc tests</a>. The same is true for interaction effects. Knowing that there’s a significant interaction doesn’t tell you anything about what kind of interaction exists. Again, you’ll need to run additional analyses.</p>
<p>Secondly, there’s a very peculiar interpretation issue that arises when you obtain a significant interaction effect but no corresponding main effect. This happens sometimes. For instance, in the crossover interaction shown in <a href="#fig-fig14-5">Figure&nbsp;<span>14.5</span></a>(a), this is exactly what you’d find. In this case, neither of the main effects would be significant, but the interaction effect would be. This is a difficult situation to interpret, and people often get a bit confused about it. The general advice that statisticians like to give in this situation is that you shouldn’t pay much attention to the main effects when an interaction is present. The reason they say this is that, although the tests of the main effects are perfectly valid from a mathematical point of view, when there is a significant interaction effect the main effects rarely test interesting hypotheses. Recall from <a href="#sec-What-hypotheses-are-we-testing"><span>Section&nbsp;14.1.1</span></a> that the null hypothesis for a main effect is that the marginal means are equal to each other, and that a marginal mean is formed by averaging across several different groups. But if you have a significant interaction effect then you know that the groups that comprise the marginal mean aren’t homogeneous, so it’s not really obvious why you would even care about those marginal means.</p>
<p>Here’s what I mean. Again, let’s stick with a clinical example. Suppose that we had a <span class="math inline">\(2 \times 2\)</span> design comparing two different treatments for phobias (e.g., systematic desensitisation vs flooding), and two different anxiety reducing drugs (e.g., Anxifree vs Joyzepam). Now, suppose what we found was that Anxifree had no effect when desensitisation was the treatment, and Joyzepam had no effect when flooding was the treatment. But both were pretty effective for the other treatment. This is a classic crossover interaction, and what we’d find when running the ANOVA is that there is no main effect of drug, but a significant interaction. Now, what does it actually mean to say that there’s no main effect? Well, it means that if we average over the two different psychological treatments, then the average effect of Anxifree and Joyzepam is the same. But why would anyone care about that? When treating someone for phobias it is never the case that a person can be treated using an “average” of flooding and desensitisation. That doesn’t make a lot of sense. You either get one or the other. For one treatment one drug is effective, and for the other treatment the other drug is effective. The interaction is the important thing and the main effect is kind of irrelevant.</p>
<p>This sort of thing happens a lot. The main effect are tests of marginal means, and when an interaction is present we often find ourselves not being terribly interested in marginal means because they imply averaging over things that the interaction tells us shouldn’t be averaged! Of course, it’s not always the case that a main effect is meaningless when an interaction is present. Often you can get a big main effect and a very small interaction, in which case you can still say things like “drug A is generally more effective than drug B” (because there was a big effect of drug), but you’d need to modify it a bit by adding that “the difference in effectiveness was different for different psychological treatments”. In any case, the main point here is that whenever you get a significant interaction you should stop and think about what the main effect actually means in this context. Don’t automatically assume that the main effect is interesting.</p>
</section>
</section>
<section id="effect-size" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="effect-size"><span class="header-section-number">14.3</span> Effect size</h2>
<p>The effect size calculation for a factorial ANOVA is pretty similar to those used in one-way ANOVA (see <a href="#effect-size">Effect size</a> section). Specifically, we can use <span class="math inline">\(\eta^2\)</span> (eta-squared) as a simple way to measure how big the overall effect is for any particular term. As before, <span class="math inline">\(\eta^2\)</span> is defined by dividing the sum of squares associated with that term by the total sum of squares. For instance, to determine the size of the main effect of Factor A, we would use the following formula: <span class="math display">\[\eta_A^2=\frac{SS_A}{SS_T}\]</span></p>
<p>As before, this can be interpreted in much the same way as <span class="math inline">\(R^2\)</span> in regression.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> It tells you the proportion of variance in the outcome variable that can be accounted for by the main effect of Factor A. It is therefore a number that ranges from 0 (no effect at all) to 1 (accounts for all of the variability in the outcome). Moreover, the sum of all the <span class="math inline">\(\eta^2\)</span> values, taken across all the terms in the model, will sum to the the total <span class="math inline">\(R^2\)</span> for the ANOVA model. If, for instance, the ANOVA model fits perfectly (i.e., there is no within groups variability at all!), the <span class="math inline">\(\eta^2\)</span> values will sum to 1. Of course, that rarely if ever happens in real life.</p>
<p>However, when doing a factorial ANOVA, there is a second measure of effect size that people like to report, known as partial <span class="math inline">\(\eta^2\)</span>. The idea behind partial <span class="math inline">\(\eta^2\)</span> (which is sometimes denoted <span class="math inline">\(p^{\eta^2}\)</span> or <span class="math inline">\(\eta_p^2\)</span>) is that, when measuring the effect size for a particular term (say, the main effect of Factor A), you want to deliberately ignore the other effects in the model (e.g., the main effect of Factor B). That is, you would pretend that the effect of all these other terms is zero, and then calculate what the <span class="math inline">\(\eta^2\)</span> value would have been. This is actually pretty easy to calculate. All you have to do is remove the sum of squares associated with the other terms from the denominator. In other words, if you want the partial <span class="math inline">\(\eta^2\)</span> for the main effect of Factor A, the denominator is just the sum of the <span class="math inline">\(SS\)</span> values for Factor A and the residuals: <span class="math display">\[\text{partial }\eta_A^2= \frac{SS_A}{SS_A+SS_R}\]</span></p>
<p>This will always give you a larger number than <span class="math inline">\(\eta^2\)</span>, which the cynic in me suspects accounts for the popularity of partial <span class="math inline">\(\eta^2\)</span>. And once again you get a number between 0 and 1, where 0 represents no effect. However, it’s slightly trickier to interpret what a large partial <span class="math inline">\(\eta^2\)</span> value means. In particular, you can’t actually compare the partial <span class="math inline">\(\eta^2\)</span> values across terms! Suppose, for instance, there is no within groups variability at all: if so, <span class="math inline">\(SS_R = 0\)</span>. What that means is that every term has a partial <span class="math inline">\(\eta^2\)</span> value of 1. But that doesn’t mean that all terms in your model are equally important, or indeed that they are equally large. All it mean is that all terms in your model have effect sizes that are large relative to the residual variation. It is not comparable across terms.</p>
<p>To see what I mean by this, it’s useful to see a concrete example. First, let’s have a look at the effect sizes for the original ANOVA (<a href="#tbl-tab14-6">Table&nbsp;<span>14.6</span></a>) without the interaction term, from <a href="#fig-fig14-3">Figure&nbsp;<span>14.3</span></a>.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-6" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-6"><caption>Table&nbsp;14.6:  <p>Effect sizes when the interaction term <strong>is not</strong>
included in the ANOVA model</p> </caption>
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">eta.sq</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">partial.eta.sq</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">drug</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.71</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.79</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">therapy</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.10</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.34</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Looking at the <span class="math inline">\(\eta^2\)</span> values first, we see that drug accounts for 71% of the variance (i.e.&nbsp;<span class="math inline">\(\eta^2 = 0.71\)</span>) in mood.gain, whereas therapy only accounts for 10%. This leaves a total of 19% of the variation unaccounted for (i.e., the residuals constitute 19% of the variation in the outcome). Overall, this implies that we have a very large effect<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> of drug and a modest effect of therapy.</p>
<p>Now let’s look at the partial <span class="math inline">\(\eta^2\)</span> values, shown in <a href="#fig-fig14-3">Figure&nbsp;<span>14.3</span></a>. Because the effect of therapy isn’t all that large, controlling for it doesn’t make much of a difference, so the partial <span class="math inline">\(\eta^2\)</span> for drug doesn’t increase very much, and we obtain a value of <span class="math inline">\(p^{\eta^2} = 0.79\)</span>. In contrast, because the effect of drug was very large, controlling for it makes a big difference, and so when we calculate the partial <span class="math inline">\(\eta^2\)</span> for therapy you can see that it rises to <span class="math inline">\(p^{\eta^2} = 0.34\)</span>. The question that we have to ask ourselves is, what do these partial <span class="math inline">\(\eta^2\)</span> values actually mean? The way I generally interpret the partial <span class="math inline">\(\eta^2\)</span> for the main effect of Factor A is to interpret it as a statement about a hypothetical experiment in which only Factor A was being varied. So, even though in this experiment we varied both A and B, we can easily imagine an experiment in which only Factor A was varied, and the partial <span class="math inline">\(\eta^2\)</span> statistic tells you how much of the variance in the outcome variable you would expect to see accounted for in that experiment. However, it should be noted that this interpretation, like many things associated with main effects, doesn’t make a lot of sense when there is a large and significant interaction effect.</p>
<p>Speaking of interaction effects, <a href="#tbl-tab14-7">Table&nbsp;<span>14.7</span></a> shows what we get when we calculate the effect sizes for the model that includes the interaction term, as in <a href="#fig-fig14-7">Figure&nbsp;<span>14.7</span></a>. As you can see, the <span class="math inline">\(\eta^2\)</span> values for the main effects don’t change, but the partial <span class="math inline">\(\eta^2\)</span> values do:</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-7" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-7"><caption>Table&nbsp;14.7:  <p>Effect sizes when the interaction term <strong>is</strong> included
in the ANOVA model</p> </caption>
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">eta.sq</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">partial.eta.sq</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">drug</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.71</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.84</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">therapy</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.10</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.42</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">drug*therapy</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.06</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.29</td></tr>
</tbody></table>

</div>
</div>
</div>
<section id="estimated-group-means" class="level3" data-number="14.3.1">
<h3 data-number="14.3.1" class="anchored" data-anchor-id="estimated-group-means"><span class="header-section-number">14.3.1</span> Estimated group means</h3>
<p>In many situations you will find yourself wanting to report estimates of all the group means based on the results of your ANOVA, as well as confidence intervals associated with them. You can use the ‘Estimated Marginal Means’ option in the jamovi ANOVA analysis to do this, as in <a href="#fig-fig14-8">Figure&nbsp;<span>14.8</span></a>. If the ANOVA that you have run is a saturated model (i.e., contains all possible main effects and all possible interaction effects) then the estimates of the group means are actually identical to the sample means, though the confidence intervals will use a pooled estimate of the standard errors rather than use a separate one for each group.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-8" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-8.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi screenshot of a clinical trial analysis software interface displaying an ANOVA analysis. The screen shows sections for Assumptions Checks, Estimates, and Estimated Marginal Means. Data tables illustrate the ANOVA results and Estimated Marginal Means for drug therapy."></p>
<figcaption class="figure-caption">Figure&nbsp;14.8: jamovi screenshot showing the marginal means for the saturated model, i.e.&nbsp;including the interaction component, with the clinical trial data set</figcaption>
</figure>
</div>
</div>
</div>
<p>In the output we see that the estimated mean mood gain for the placebo group with no therapy was <span class="math inline">\(0.300\)</span>, with a <span class="math inline">\(95\%\)</span> confidence interval from <span class="math inline">\(0.006\)</span> to <span class="math inline">\(0.594\)</span>. Note that these are not the same confidence intervals that you would get if you calculated them separately for each group, because of the fact that the ANOVA model assumes homogeneity of variance and therefore uses a pooled estimate of the standard deviation.</p>
<p>When the model doesn’t contain the interaction term, then the estimated group means will be different from the sample means. Instead of reporting the sample mean, jamovi will calculate the value of the group means that would be expected on the basis of the marginal means (i.e., assuming no interaction). Using the notation we developed earlier, the estimate reported for <span class="math inline">\(\mu_{rc}\)</span>, the mean for level <span class="math inline">\(r\)</span> on the (row) Factor A and level <span class="math inline">\(c\)</span> on the (column) Factor B would be <span class="math inline">\(\mu_{..} + \alpha_r + \beta_c\)</span>. If there are genuinely no interactions between the two factors, this is actually a better estimate of the population mean than the raw sample mean would be. Removing the interaction term from the model, via the ‘Model’ options in the jamovi ANOVA analysis, provides the marginal means for the analysis shown in <a href="#fig-fig14-9">Figure&nbsp;<span>14.9</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-9" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-9.png" class="img-fluid figure-img" style="width:80.0%" alt="ANOVA table and Estimated Marginal Means table for mood gain analysis. The ANOVA table shows a significant drug effect with F(3,14) = 7.08, p = 0.01866. The Estimated Marginal Means table lists means and confidence intervals for interactions between therapy and drug."></p>
<figcaption class="figure-caption">Figure&nbsp;14.9: jamovi screenshot showing the marginal means for the unsaturated model, i.e.&nbsp;without the interaction component, with the clinical trial data set</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="assumption-checking" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="assumption-checking"><span class="header-section-number">14.4</span> Assumption checking</h2>
<p>As with one-way ANOVA, the key assumptions of factorial ANOVA are homogeneity of variance (all groups have the same standard deviation), normality of the residuals, and independence of the observations. The first two are things we can check for. The third is something that you need to assess yourself by asking if there are any special relationships between different observations, for example repeated measures where the independent variable is time so there is a relationship between the observations at time one and time two: observations at different time points are from the same people. Additionally, if you aren’t using a saturated model (e.g., if you’ve omitted the interaction terms) then you’re also assuming that the omitted terms aren’t important. Of course, you can check this last one by running an ANOVA with the omitted terms included and see if they’re significant, so that’s pretty easy. What about homogeneity of variance and normality of the residuals? As it turns out, these are pretty easy to check. It’s no different to the checks we did for a one-way ANOVA.</p>
<section id="homogeneity-of-variance" class="level3" data-number="14.4.1">
<h3 data-number="14.4.1" class="anchored" data-anchor-id="homogeneity-of-variance"><span class="header-section-number">14.4.1</span> Homogeneity of variance</h3>
<p>As mentioned in <a href="13-Comparing-several-means-one-way-ANOVA.html#sec-Checking-the-homogeneity-of-variance-assumption"><span>Section&nbsp;13.6.1</span></a> in the last chapter, it’s a good idea to visually inspect a plot of the standard deviations compared across different groups / categories, and also see if the Levene test is consistent with the visual inspection. The theory behind the Levene test was discussed in <a href="13-Comparing-several-means-one-way-ANOVA.html#sec-Checking-the-homogeneity-of-variance-assumption"><span>Section&nbsp;13.6.1</span></a>, so I won’t discuss it again. This test expects that you have a saturated model (i.e., including all of the relevant terms), because the test is primarily concerned with the within-group variance, and it doesn’t really make a lot of sense to calculate this any way other than with respect to the full model. The Levene test can be specified under the ANOVA ‘Assumption Checks’ – ‘Homogeneity Tests’ option in jamovi, with the result shown as in <a href="#fig-fig14-10">Figure&nbsp;<span>14.10</span></a>. The fact that the Levene test is non-significant means that, providing it is consistent with a visual inspection of the plot of standard deviations, we can safely assume that the homogeneity of variance assumption is not violated.</p>
</section>
<section id="normality-of-residuals" class="level3" data-number="14.4.2">
<h3 data-number="14.4.2" class="anchored" data-anchor-id="normality-of-residuals"><span class="header-section-number">14.4.2</span> Normality of residuals</h3>
<p>As with one-way ANOVA we can test for the normality of residuals in a straightforward fashion (see <a href="13-Comparing-several-means-one-way-ANOVA.html#sec-Checking-the-normality-assumption"><span>Section&nbsp;13.6.4</span></a>). Primarily though, it’s generally a good idea to examine the residuals graphically using a QQ plot. See <a href="#fig-fig14-10">Figure&nbsp;<span>14.10</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-10" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-10.png" class="img-fluid figure-img" style="width:80.0%" alt="An image shows assumption checks for statistical analysis. It includes results for the Levene test (F = 0.22, df1 = 5, df2 = 12, p = 0.94731) and Shapiro-Wilk test (Statistic = 0.96, p = 0.53290). Below is a Q-Q plot of standardized residuals versus theoretical quantiles."></p>
<figcaption class="figure-caption">Figure&nbsp;14.10: Checking assumptions in an ANOVA model</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-analysis-of-covariance-ancova" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="sec-analysis-of-covariance-ancova"><span class="header-section-number">14.5</span> Analysis of covariance (ANCOVA)</h2>
<p>A variation in ANOVA is when you have an additional continuous variable that you think might be related to the dependent variable. This additional variable can be added to the analysis as a covariate, in the aptly named analysis of covariance (ANCOVA).</p>
<p>In ANCOVA the values of the dependent variable are “adjusted” for the influence of the covariate, and then the “adjusted” score means are tested between groups in the usual way. This technique can increase the precision of an experiment, and therefore provide a more “powerful” test of the equality of group means in the dependent variable. How does ANCOVA do this? Well, although the covariate itself is typically not of any experimental interest, adjustment for the covariate can decrease the estimate of experimental error and thus, by reducing error variance, precision is increased. This means that an inappropriate failure to reject the null hypothesis (false negative or type II error) is less likely.</p>
<p>Despite this advantage, ANCOVA runs the risk of undoing real differences between groups, and this should be avoided. Look at <a href="#fig-fig14-11">Figure&nbsp;<span>14.11</span></a>, for example, which shows a plot of Statistics anxiety against age and shows two distinct groups – students who have either an Arts or Science background or preference. ANCOVA with age as a covariate might lead to the conclusion that statistics anxiety does not differ in the two groups. Would this conclusion be reasonable – probably not because the ages of the two groups do not overlap and analysis of variance has essentially “extrapolated into a region with no data” (<span class="citation" data-cites="Everitt1996">Everitt (<a href="References.html#ref-Everitt1996" role="doc-biblioref">1996</a>)</span>, p.&nbsp;68).</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-11" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-11.png" class="img-fluid figure-img" style="width:80.0%" alt="A scatter plot shows 'Statistics anxiety' on the Y-axis versus 'Age' on the X-axis. Data points for 'Scientists' cluster lower on the Y-axis and at younger ages on the X-axis, while 'Artists' cluster higher on the Y-axis and at older ages on the X-axis."></p>
<figcaption class="figure-caption">Figure&nbsp;14.11: Plot of Statistics anxiety against age for two distinct groups</figcaption>
</figure>
</div>
</div>
</div>
<p>Clearly, careful thought needs to be given to an analysis of covariance with distinct groups. This applies to both one-way and factorial designs, as ANCOVA can be used with both.</p>
<section id="running-ancova-in-jamovi" class="level3" data-number="14.5.1">
<h3 data-number="14.5.1" class="anchored" data-anchor-id="running-ancova-in-jamovi"><span class="header-section-number">14.5.1</span> Running ANCOVA in jamovi</h3>
<p>A health psychologist was interested in the effect of routine cycling and stress on happiness levels, with age as a covariate. You can find the dataset in the file <em>ancova.csv</em>. Open this file in jamovi and then, to undertake an ANCOVA, select Analyses - ANOVA - ANCOVA to open the ANCOVA analysis window (<a href="#fig-fig14-12">Figure&nbsp;<span>14.12</span></a>). Highlight the dependent variable ‘happiness’ and transfer it into the ‘Dependent Variable’ text box. Highlight the independent variables ‘stress’ and ‘commute’ and transfer them into the ‘Fixed Factors’ text box. Highlight the covariate ‘age’ and transfer it into the ‘Covariates’ text box. Then click on Estimated Marginal Means to bring up the plots and tables options.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-12" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-12.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi screenshot showing an ANCOVA setup. The window has options for adding dependent variables, fixed factors, and covariates. &quot;Happiness&quot; is selected as the dependent variable, with &quot;stress&quot; and &quot;commute&quot; as fixed factors, and &quot;age&quot; as a covariate."></p>
<figcaption class="figure-caption">Figure&nbsp;14.12: The jamovi ANCOVA analysis window</figcaption>
</figure>
</div>
</div>
</div>
<p>An ANCOVA table showing ‘Tests of Between Subjects Effects’ is produced in the jamovi results window (<a href="#fig-fig14-13">Figure&nbsp;<span>14.13</span></a>). The <span class="math inline">\(F\)</span>-value for the covariate ‘age’ is significant at <span class="math inline">\(p = .023\)</span>, suggesting that age is an important predictor of the dependent variable, happiness. When we look at the estimated marginal mean scores (<a href="#fig-fig14-14">Figure&nbsp;<span>14.14</span></a>), adjustments have been made (compared to an analysis without the covariate) because of the inclusion of the covariate ‘age’ in this ANCOVA. A plot (<a href="#fig-fig14-15">Figure&nbsp;<span>14.15</span></a>) is a good way of visualising and interpreting the significant effects.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-13" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-13.png" class="img-fluid figure-img" style="width:80.0%" alt="An ANCOVA table titled 'happiness' displays statistical results including Sum of Squares, degrees of freedom (df), Mean Square, $F$-ratio (F), $p$-values (p), eta squared (η²), partial eta squared (ηp²), and omega squared (ω²) for various factors like stress, commute, age, and interactions."></p>
<figcaption class="figure-caption">Figure&nbsp;14.13: jamovi ANCOVA output for happiness as a function of stress and commuting method, with age as a covariate</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-14" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-14.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi results table titled &quot;Estimated Marginal Means - stress × commute&quot; showing mean stress levels with standard errors (SE) and 95% Confidence Intervals for different commuting methods (drive, cycle) and stress levels (high, low)."></p>
<figcaption class="figure-caption">Figure&nbsp;14.14: Table of mean happiness level as a function of stress and commuting method (adjusted for the covariate age) with 95% confidence intervals</figcaption>
</figure>
</div>
</div>
</div>
<p>The <span class="math inline">\(F\)</span>-value for the main effect ‘stress’ (52.61) has an associated probability of <span class="math inline">\(p &lt; .001\)</span>. The <span class="math inline">\(F\)</span>-value for the main effect ‘commute’ (42.33) has an associated probability of <span class="math inline">\(p &lt; .001\)</span>. Since both of these are less than the probability that is typically used to decide if a statistical result is significant (<span class="math inline">\(p &lt; .05\)</span>) we can conclude that there was a significant main effect of stress (<span class="math inline">\(F(1, 15) = 52.61, p &lt; .001\)</span>) and a significant main effect of commuting method (<span class="math inline">\(F(1, 15) = 42.33, p &lt; .001\)</span>). A significant interaction between stress and commuting method was also found (<span class="math inline">\(F(1, 15) = 14.15, p = .002\)</span>).</p>
<p>In <a href="#fig-fig14-15">Figure&nbsp;<span>14.15</span></a> we can see the adjusted, marginal, mean happiness scores when age is a covariate in an ANCOVA. In this analysis there is a significant interaction effect, whereby people with low stress who cycle to work are happier than people with low stress who drive and people with high stress regardless of whether they cycle or drive to work. There is also a significant main effect of stress – people with low stress are happier than those with high stress. And there is also a significant main effect of commuting behaviour – people who cycle are happier, on average, than those who drive to work.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-15" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-15.png" class="img-fluid figure-img" style="width:80.0%" alt="A line graph compares happiness levels based on stress levels (high and low) and commute type (drive or cycle). The &quot;cycle&quot; line shows a steeper increase in happiness from high to low stress compared to the &quot;drive&quot; line. Error bars are present."></p>
<figcaption class="figure-caption">Figure&nbsp;14.15: Plot of mean happiness level as a function of stress and commuting method</figcaption>
</figure>
</div>
</div>
</div>
<p>One thing to be aware of is that, if you are thinking of including a covariate in your ANOVA, there is an additional assumption: the relationship between the covariate and the dependent variable should be similar for all levels of the independent variable. This can be checked by adding an interaction term between the covariate and each independent variable in the jamovi ‘Model - Model’ terms option. If the interaction effect is not significant it can be removed. If it is significant then a different and more advanced statistical technique might be appropriate (which is beyond the scope of this book so you might want to consult a friendly statistician).</p>
</section>
</section>
<section id="sec-ANOVA-as-a-linear-model" class="level2" data-number="14.6">
<h2 data-number="14.6" class="anchored" data-anchor-id="sec-ANOVA-as-a-linear-model"><span class="header-section-number">14.6</span> ANOVA as a linear model</h2>
<p>One of the most important things to understand about ANOVA and regression is that they’re basically the same thing. On the surface of it, you maybe wouldn’t think this is true. After all, the way that I’ve described them so far suggests that ANOVA is primarily concerned with testing for group differences, and regression is primarily concerned with understanding the correlations between variables. And, as far as it goes that’s perfectly true. But when you look under the hood, so to speak, the underlying mechanics of ANOVA and regression are awfully similar. In fact, if you think about it, you’ve already seen evidence of this. ANOVA and regression both rely heavily on sums of squares (<span class="math inline">\(SS\)</span>), both make use of <span class="math inline">\(F\)</span>-tests, and so on. Looking back, it’s hard to escape the feeling that <a href="12-Correlation-and-linear-regression.html"><span>Chapter&nbsp;12</span></a> and <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a> were a bit repetitive.</p>
<p>The reason for this is that ANOVA and regression are both kinds of <strong>linear models</strong>. In the case of regression, this is kind of obvious. The regression equation that we use to define the relationship between predictors and outcomes is the equation for a straight line, so it’s quite obviously a linear model, with the equation: <span class="math display">\[Y_p=b_0+b_1 X_{1p} +b_2 X_{2p} + \epsilon_p\]</span></p>
<p>where <span class="math inline">\(Y_p\)</span> is the outcome value for the <span class="math inline">\(p\)</span>-th observation (e.g., <span class="math inline">\(p\)</span>-th person), <span class="math inline">\(X_{1p}\)</span> is the value of the first predictor for the <span class="math inline">\(p\)</span>-th observation, <span class="math inline">\(X_{2p}\)</span> is the value of the second predictor for the <span class="math inline">\(p\)</span>-th observation, the <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, and <span class="math inline">\(b_2\)</span> terms are our regression coefficients, and <span class="math inline">\(\epsilon_p\)</span> is the <span class="math inline">\(p\)</span>-th residual. If we ignore the residuals <span class="math inline">\(\epsilon_p\)</span> and just focus on the regression line itself, we get the following formula: <span class="math display">\[\hat{Y}_p=b_0+b_1 X_{1p} +b_2 X_{2p}\]</span></p>
<p>where <span class="math inline">\(\hat{Y}_p\)</span> is the value of Y that the regression line predicts for person p, as opposed to the actually-observed value <span class="math inline">\(Y_p\)</span>. The thing that isn’t immediately obvious is that we can write ANOVA as a linear model as well. However, it’s actually pretty straightforward to do this. Let’s start with a really simple example, rewriting a <span class="math inline">\(2 \times 2\)</span> factorial ANOVA as a linear model.</p>
<section id="some-data" class="level3" data-number="14.6.1">
<h3 data-number="14.6.1" class="anchored" data-anchor-id="some-data"><span class="header-section-number">14.6.1</span> Some data</h3>
<p>To make things concrete, let’s suppose that our outcome variable is the grade that a student receives in my class, a ratio-scale variable corresponding to a mark from <span class="math inline">\(0%\)</span> to <span class="math inline">\(100%\)</span>. There are two predictor variables of interest: whether or not the student turned up to lectures (the attend variable) and whether or not the student actually read the textbook (the reading variable). We’ll say that attend = 1 if the student attended class, and attend = 0 if they did not. Similarly, we’ll say that reading = 1 if the student read the textbook, and reading = 0 if they did not.</p>
<p>Okay, so far that’s simple enough. The next thing we need to do is to wrap some maths around this (sorry!). For the purposes of this example, let <span class="math inline">\(Y_p\)</span> denote the grade of the <span class="math inline">\(p\)</span>-th student in the class. This is not quite the same notation that we used earlier in this chapter. Previously, we’ve used the notation <span class="math inline">\(Y_{rci}\)</span> to refer to the <span class="math inline">\(i\)</span>-th person in the <span class="math inline">\(r\)</span>-th group for predictor 1 (the row factor) and the <span class="math inline">\(c\)</span>-th group for predictor 2 (the column factor). This extended notation was really handy for describing how the <span class="math inline">\(SS\)</span> values are calculated, but it’s a pain in the current context, so I’ll switch notation here. Now, the <span class="math inline">\(Y_p\)</span> notation is visually simpler than <span class="math inline">\(Y_{rci}\)</span>, but it has the shortcoming that it doesn’t actually keep track of the group memberships! That is, if I told you that <span class="math inline">\(Y_{0,0,3} = 35\)</span>, you’d immediately know that we’re talking about a student (the 3rd such student, in fact) who didn’t attend the lectures (i.e., attend = 0) and didn’t read the textbook (i.e.&nbsp;reading = 0), and who ended up failing the class (grade = 35). But if I tell you that <span class="math inline">\(Y_p = 35\)</span>, all you know is that the <span class="math inline">\(p\)</span>-th student didn’t get a good grade. We’ve lost some key information here. Of course, it doesn’t take a lot of thought to figure out how to fix this. What we’ll do instead is introduce two new variables <span class="math inline">\(X_{1p}\)</span> and <span class="math inline">\(X_{2p}\)</span> that keep track of this information. In the case of our hypothetical student, we know that <span class="math inline">\(X_{1p} = 0\)</span> (i.e., attend = 0) and <span class="math inline">\(X_{2p} = 0\)</span> (i.e., reading = 0). So the data might look like <a href="#tbl-tab14-8">Table&nbsp;<span>14.8</span></a>.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-8" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-8"><caption>Table&nbsp;14.8:  <p>Data for grade, attendance and reading the textbook</p> </caption>
<colgroup><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">person, \(p\)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">grade, \(Y_p\)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">attendance, \(X_{1p}\)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">reading, \(X_{2p}\)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">90</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">87</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">75</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">60</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">35</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">50</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">7</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">65</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">8</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">70</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>This isn’t anything particularly special, of course. It’s exactly the format in which we expect to see our data! See the data file <em>rtfm.csv</em>. We can use the jamovi ‘Descriptives’ analysis to confirm that this data set corresponds to a balanced design, with 2 observations for each combination of attend and reading. In the same way we can also calculate the mean grade for each combination. This is shown in <a href="#fig-fig14-16">Figure&nbsp;<span>14.16</span></a>. Looking at the mean scores, one gets the strong impression that reading the text and attending the class both matter a lot.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-16" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-16.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi screenshot showing various tabs at the top, including Variables, Data, Analyses, and Edit. The current screen displays options for descriptives analysis with variables such as &quot;grade.&quot; The &quot;Results&quot; section includes a table of descriptive statistics like mean and standard deviation. The &quot;References&quot; section at the bottom cites software and packages used."></p>
<figcaption class="figure-caption">Figure&nbsp;14.16: jamovi descriptives for the <em>rtfm.csv</em> data set</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="anova-with-binary-factors-as-a-regression-model" class="level3" data-number="14.6.2">
<h3 data-number="14.6.2" class="anchored" data-anchor-id="anova-with-binary-factors-as-a-regression-model"><span class="header-section-number">14.6.2</span> ANOVA with binary factors as a regression model</h3>
<p>Okay, let’s get back to talking about the mathematics. We now have our data expressed in terms of three numeric variables: the continuous variable <span class="math inline">\(Y\)</span> and the two binary variables <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>. What I want you to recognise is that our <span class="math inline">\(2 \times 2\)</span> factorial ANOVA is exactly equivalent to the regression model: <span class="math display">\[Y_p=b_0+b_1 X_{1p} + b_2 X_{2p} + \epsilon_p\]</span></p>
<p>This is, of course, the exact same equation that I used earlier to describe a two-predictor regression model! The only difference is that <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are now binary variables (i.e., values can only be 0 or 1), whereas in a regression analysis we expect that <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> will be continuous. There’s a couple of ways I could try to convince you of this. One possibility would be to do a lengthy mathematical exercise proving that the two are identical. However, I’m going to go out on a limb and guess that most of the readership of this book will find that annoying rather than helpful. Instead, I’ll explain the basic ideas and then rely on jamovi to show that ANOVA analyses and regression analyses aren’t just similar, they’re identical for all intents and purposes. Let’s start by running this as an ANOVA. To do this, we’ll use the rtfm data set, and <a href="#fig-fig14-17">Figure&nbsp;<span>14.17</span></a> shows what we get when we run the analysis in jamovi.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-17" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-17.png" class="img-fluid figure-img" style="width:80.0%" alt="ANOVA table presenting the results for &quot;grade&quot; with variables &quot;attend&quot; and &quot;reading.&quot; It includes columns for Sum of Squares, df, Mean Square, F, p, η², η²p, and ω². Notable values include &quot;attend&quot; with an F of 21.60, p of 0.00559, and &quot;reading&quot; with an F of 52.27, p of 0.00079."></p>
<figcaption class="figure-caption">Figure&nbsp;14.17: ANOVA of the <em>rtfm.csv</em> data set in jamovi, without the interaction term</figcaption>
</figure>
</div>
</div>
</div>
<p>So, by reading the key numbers off the ANOVA table and the mean scores that we presented earlier, we can see that the students obtained a higher grade if they attended class (<span class="math inline">\(F_{1,5} = 21.6, p = .0056\)</span>) and if they read the textbook (<span class="math inline">\(F_{1,5} = 52.3, p = .0008\)</span>). Let’s make a note of those <span class="math inline">\(p\)</span>-values and those <span class="math inline">\(F\)</span>-statistics.</p>
<p>Now let’s think about the same analysis from a linear regression perspective. In the <em>rtfm.csv</em> data set, we have encoded attend and reading as if they were numeric predictors. In this case, this is perfectly acceptable. There really is a sense in which a student who turns up to class (i.e.&nbsp;attend = 1) has in fact done “more attendance” than a student who does not (i.e.&nbsp;attend = 0). So it’s not at all unreasonable to include it as a predictor in a regression model. It’s a little unusual, because the predictor only takes on two possible values, but it doesn’t violate any of the assumptions of linear regression. And it’s easy to interpret. If the regression coefficient for attend is greater than 0 it means that students that attend lectures get higher grades. If it’s less than zero then students attending lectures get lower grades. The same is true for our reading variable.</p>
<p>Wait a second though. Why is this true? It’s something that is intuitively obvious to everyone who has taken a few stats classes and is comfortable with the maths, but it isn’t clear to everyone else at first pass. To see why this is true, it helps to look closely at a few specific students. Let’s start by considering the 6th and 7th students in our data set (i.e.&nbsp;<span class="math inline">\(p = 6\)</span> and <span class="math inline">\(p = 7\)</span>). Neither one has read the textbook, so in both cases we can set reading = 0. Or, to say the same thing in our mathematical notation, we observe <span class="math inline">\(X_{2,6} = 0\)</span> and <span class="math inline">\(X_{2,7} = 0\)</span>. However, student number 7 did turn up to lectures (i.e., attend = 1, <span class="math inline">\(X_{1,7} = 1\)</span>) whereas student number 6 did not (i.e., attend = 0, <span class="math inline">\(X_{1,6} = 0\)</span>). Now let’s look at what happens when we insert these numbers into the general formula for our regression line. For student number 6, the regression predicts that: <span class="math display">\[
\begin{split}
\hat{Y}_6 &amp; = b_0 + b_1 X_{1,6} + b_2 X_{2,6} \\
&amp; = b_0 + (b_1 \times 0) + (b_2 \times 0) \\
&amp; = b_0
\end{split}
\]</span></p>
<p>So we’re expecting that this student will obtain a grade corresponding to the value of the intercept term <span class="math inline">\(b_0\)</span>. What about student 7? This time when we insert the numbers into the formula for the regression line, we obtain the following: <span class="math display">\[
\begin{split}
\hat{Y}_7 &amp; = b_0 + b_1 X_{1,7} + b_2 X_{2,7} \\
&amp; = b_0 + (b_1 \times 1) + (b_2 \times 0) \\
&amp; = b_0 + b_1
\end{split}
\]</span></p>
<p>Because this student attended class, the predicted grade is equal to the intercept term b0 plus the coefficient associated with the attend variable, <span class="math inline">\(b_1\)</span>. So, if <span class="math inline">\(b_1\)</span> is greater than zero, we’re expecting that the students who turn up to lectures will get higher grades than those students who don’t. If this coefficient is negative we’re expecting the opposite: students who turn up at class end up performing much worse. In fact, we can push this a little bit further. What about student number 1, who turned up to class (<span class="math inline">\(X_{1,1} = 1\)</span>) and read the textbook (<span class="math inline">\(X_{2,1} = 1\)</span>)? If we plug these numbers into the regression we get: <span class="math display">\[
\begin{split}
\hat{Y}_1 &amp; = b_0 + b_1 X_{1,1} + b_2 X_{2,1} \\
&amp; = b_0 + (b_1 \times 1) + (b_2 \times 1) \\
&amp; = b_0 + b_1 + b_2
\end{split}
\]</span></p>
<p>So if we assume that attending class helps you get a good grade (i.e., <span class="math inline">\(b_1 &gt; 0\)</span>) and if we assume that reading the textbook also helps you get a good grade (i.e., <span class="math inline">\(b_2 &gt; 0\)</span>), then our expectation is that student 1 will get a grade that that is higher than student 6 and student 7.</p>
<p>And at this point you won’t be at all suprised to learn that the regression model predicts that student 3, who read the book but didn’t attend lectures, will obtain a grade of <span class="math inline">\(b_{2} + b_{0}\)</span>. I won’t bore you with yet another regression formula. Instead, what I’ll do is show you is <a href="#tbl-tab14-9">Table&nbsp;<span>14.9</span></a> with the <em>expected grades</em>.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-9" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-9"><caption>Table&nbsp;14.9:  <p>Expected grades from the regression model</p> </caption>
<colgroup><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">read textbook</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;"></th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">no</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">yes</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">attended?</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">no</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \beta_0 \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \beta_0 + \beta_2 \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">yes</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \beta_0 + \beta_1 \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \beta_0 + \beta_1 + \beta_2 \)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>As you can see, the intercept term <span class="math inline">\(b_0\)</span> acts like a kind of “baseline” grade that you would expect from those students who don’t take the time to attend class or read the textbook. Similarly, <span class="math inline">\(b_1\)</span> represents the boost that you’re expected to get if you come to class, and <span class="math inline">\(b_2\)</span> represents the boost that comes from reading the textbook. In fact, if this were an ANOVA you might very well want to characterise <span class="math inline">\(b_1\)</span> as the main effect of attendance, and <span class="math inline">\(b_2\)</span> as the main effect of reading! In fact, for a simple <span class="math inline">\(2 \times 2\)</span> ANOVA that’s exactly how it plays out.</p>
<p>Okay, now that we’re really starting to see why ANOVA and regression are basically the same thing, let’s actually run our regression using the rtfm data and the jamovi regression analysis to convince ourselves that this is really true. Running the regression in the usual way gives the results shown in <a href="#fig-fig14-18">Figure&nbsp;<span>14.18</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-18" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-18.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi results table titled &quot;Model Coefficients - grade&quot; displays the estimate, standard error (SE), t-value, and $p$-value for three predictors:- Intercept, attend, and reading. The Intercept values are 43.50, 3.35, 12.97, 0.00005. Attend:- 18.00, 3.87, 4.65, 0.00559. Reading:- 28.00, 3.87, 7.23, 0.00079."></p>
<figcaption class="figure-caption">Figure&nbsp;14.18: Regression analysis of the <em>rtfm.csv</em> data set in jamovi, without the interaction term</figcaption>
</figure>
</div>
</div>
</div>
<p>There’s a few interesting things to note here. First, notice that the intercept term is 43.5 which is close to the “group” mean of 42.5 observed for those two students who didn’t read the text or attend class. Second, notice that we have the regression coefficient of <span class="math inline">\(b_1 = 18.0\)</span> for the attendance variable, suggesting that those students that attended class scored 18% higher than those who didn’t. So our expectation would be that those students who turned up to class but didn’t read the textbook would obtain a grade of <span class="math inline">\(b_0 + b_1\)</span>, which is equal to <span class="math inline">\(43.5 + 18.0 = 61.5\)</span>. You can verify for yourself that the same thing happens when we look at the students that read the textbook.</p>
<p>Actually, we can push a little further in establishing the equivalence of our ANOVA and our regression. Look at the <span class="math inline">\(p\)</span>-values associated with the attend variable and the reading variable in the regression output. They’re identical to the ones we encountered earlier when running the ANOVA. This might seem a little surprising, since the test used when running our regression model calculates a <span class="math inline">\(t\)</span>-statistic and the ANOVA calculates an <span class="math inline">\(F\)</span>-statistic. However, if you can remember all the way back to <a href="07-Introduction-to-probability.html"><span>Chapter&nbsp;7</span></a>, I mentioned that there’s a relationship between the <span class="math inline">\(t\)</span>-distribution and the <span class="math inline">\(F\)</span>-distribution. If you have some quantity that is distributed according to a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(k\)</span> degrees of freedom and you square it, then this new squared quantity follows an <span class="math inline">\(F\)</span>-distribution whose degrees of freedom are 1 and <span class="math inline">\(k\)</span>. We can check this with respect to the <span class="math inline">\(t\)</span>-statistics in our regression model. For the attend variable we get a <span class="math inline">\(t\)</span>-value of 4.65. If we square this number we end up with 21.6, which matches the corresponding <span class="math inline">\(F\)</span>-statistic in our ANOVA.</p>
<p>Finally, one last thing you should know. Because jamovi understands the fact that ANOVA and regression are both examples of linear models, it lets you extract the classic ANOVA table from your regression model using the ‘Linear Regression’ – ‘Model Coefficients’ – ‘Omnibus Test’ – ‘ANOVA Test’, and this will give you the table shown in <a href="#fig-fig14-19">Figure&nbsp;<span>14.19</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-19" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-19.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi results table titled &quot;Omnibus ANOVA Test&quot; showing values for Sum of Squares, df, Mean Square, F, and p across three rows:- attend, reading, and Residuals. Note indicates &quot;Type 3 sum of squares&quot;."></p>
<figcaption class="figure-caption">Figure&nbsp;14.19: Omnibus ANOVA Test results from the jamovi regression analysis</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="how-to-encode-non-binary-factors-as-contrasts" class="level3" data-number="14.6.3">
<h3 data-number="14.6.3" class="anchored" data-anchor-id="how-to-encode-non-binary-factors-as-contrasts"><span class="header-section-number">14.6.3</span> How to encode non binary factors as contrasts</h3>
<p>At this point, I’ve shown you how we can view a <span class="math inline">\(2 \times 2\)</span> ANOVA into a linear model. And it’s pretty easy to see how this generalises to a <span class="math inline">\(2 \times 2 \times 2\)</span> ANOVA or a <span class="math inline">\(2 \times 2 \times 2 \times 2\)</span> ANOVA. It’s the same thing, really. You just add a new binary variable for each of your factors. Where it begins to get trickier is when we consider factors that have more than two levels. Consider, for instance, the <span class="math inline">\(3 \times 2\)</span> ANOVA that we ran earlier in this chapter using the <em>clinicaltrial.csv</em> data. How can we convert the three-level drug factor into a numerical form that is appropriate for a regression?</p>
<p>The answer to this question is pretty simple, actually. All we have to do is realise that a three-level factor can be redescribed as two binary variables. Suppose, for instance, I were to create a new binary variable called druganxifree. Whenever the drug variable is equal to “anxifree” we set druganxifree = 1. Otherwise, we set druganxifree = 0. This variable sets up a <strong>contrast</strong>, in this case between anxifree and the other two drugs. By itself, of course, the druganxifree contrast isn’t enough to fully capture all of the information in our drug variable. We need a second contrast, one that allows us to distinguish between joyzepam and the placebo. To do this, we can create a second binary contrast, called drugjoyzepam, which equals 1 if the drug is joyzepam and 0 if it is not. Taken together, these two contrasts allows us to perfectly discriminate between all three possible drugs. <a href="#tbl-tab14-10">Table&nbsp;<span>14.10</span></a> illustrates this.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-10" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-10"><caption>Table&nbsp;14.10:  <p>Binary contrasts to discriminate between all three possible drugs</p> </caption>
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">drug</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">druganxifree</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">drugjoyzepam</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">\(placebo\)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">\(anxifree\)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">\(joyzepam\)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>If the drug administered to a patient is a placebo then both of the two contrast variables will equal 0. If the drug is Anxifree then the druganxifree variable will equal 1, and drugjoyzepam will be 0. The reverse is true for Joyzepam: drugjoyzepam is 1 and druganxifree is 0.</p>
<p>Creating contrast variables is not too difficult to do using the jamovi compute new variable command. For example, to create the druganxifree variable, write this logical expression in the compute new variable formula box:</p>
<blockquote class="blockquote">
<p>IF(drug == ‘anxifree’, 1, 0)</p>
</blockquote>
<p>Similarly, to create the new variable drugjoyzepam use this logical expression:</p>
<blockquote class="blockquote">
<p>IF(drug == ‘joyzepam’, 1, 0)</p>
</blockquote>
<p>Likewise for CBTtherapy:</p>
<blockquote class="blockquote">
<p>IF(therapy == ‘CBT’, 1, 0)</p>
</blockquote>
<p>You can see these new variables, and the corresponding logical expressions, in the jamovi data file <em>clinicaltrial2.omv</em> .</p>
<p>We have now recoded our three-level factor in terms of two binary variables, and we’ve already seen that ANOVA and regression behave the same way for binary variables. However, there are some additional complexities that arise in this case, which we’ll discuss in the next section.</p>
</section>
<section id="the-equivalence-between-anova-and-regression-for-non-binary-factors" class="level3" data-number="14.6.4">
<h3 data-number="14.6.4" class="anchored" data-anchor-id="the-equivalence-between-anova-and-regression-for-non-binary-factors"><span class="header-section-number">14.6.4</span> The equivalence between ANOVA and regression for non-binary factors</h3>
<p>Now we have two different versions of the same data set. Our original data in which the drug variable from the <em>clinicaltrial.csv</em> file is expressed as a single three-level factor, and the expanded data <em>clinicaltrial2.omv</em> in which it is expanded into two binary contrasts. Once again, the thing that we want to demonstrate is that our original <span class="math inline">\(3 \times 2\)</span> factorial ANOVA is equivalent to a regression model applied to the contrast variables. Let’s start by re-running the ANOVA, with results shown in <a href="#fig-fig14-20">Figure&nbsp;<span>14.20</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-20" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-20.png" class="img-fluid figure-img" style="width:80.0%" alt="ANOVA table displaying the sum of squares, degrees of freedom (df), mean square, $F$-value, $p$-value, eta squared (η²), partial eta squared (η²p), and omega squared (ω²) for factors 'drug' and 'therapy' in relation to the residuals for mood gain."></p>
<figcaption class="figure-caption">Figure&nbsp;14.20: jamovi ANOVA results, without interaction component</figcaption>
</figure>
</div>
</div>
</div>
<p>Obviously, there are no surprises here. That’s the exact same ANOVA that we ran earlier. Next, let’s run a regression using druganxifree, drugjoyzepam and CBTtherapy as the predictors. The results are shown in <a href="#fig-fig14-21">Figure&nbsp;<span>14.21</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-21" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-21.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi results table displays the model coefficients for mood.gain. Predictors include Intercept, druganxifree, drugjoyzepam, and CBTherapy, with respective estimates, standard errors, t-values, and $p$-values. Notably, drugjoyzepam has a highly significant $p$-value (<.00001)."></p>
<figcaption class="figure-caption">Figure&nbsp;14.21: jamovi regression results, with contrast variables druganxifree and drugjoyzepam</figcaption>
</figure>
</div>
</div>
</div>
<p>Hmm. This isn’t the same output that we got last time. Not surprisingly, the regression output prints out the results for each of the three predictors separately, just like it did every other time we conducted a regression analysis. On the one hand we can see that the <span class="math inline">\(p\)</span>-value for the CBTtherapy variable is exactly the same as the one for the therapy factor in our original ANOVA, so we can be reassured that the regression model is doing the same thing as the ANOVA did. On the other hand, this regression model is testing the druganxifree contrast and the drugjoyzepam contrast <em>separately</em>, as if they were two completely unrelated variables. It’s not surprising of course, because the poor regression analysis has no way of knowing that drugjoyzepam and druganxifree are actually the two different contrasts that we used to encode our three-level drug factor. As far as it knows, drugjoyzepam and druganxifree are no more related to one another than drugjoyzepam and CBTtherapy. However, you and I know better. At this stage we’re not at all interested in determining whether these two contrasts are individually significant. We just want to know if there’s an “overall” effect of drug. That is, what we want jamovi to do is to run some kind of “model comparison” test, one in which the two “drug related” contrasts are lumped together for the purpose of the test. Sound familiar? All we need to do is specify our null model, which in this case would include the CBTtherapy predictor, and omit both of the drug-related variables, as in <a href="#fig-fig14-22">Figure&nbsp;<span>14.22</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-22" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-22.png" class="img-fluid figure-img" style="width:80.0%" alt="An image displaying jamovi results from a linear regression analysis for a clinical trial. The screen shows model measures, comparisons, and specific results, with variables including 'drug' and 'CBTherapy'."></p>
<figcaption class="figure-caption">Figure&nbsp;14.22: Model comparison in jamovi regression, null model 1 vs.&nbsp;contrasts model 2</figcaption>
</figure>
</div>
</div>
</div>
<p>Ah, that’s better. Our <span class="math inline">\(F\)</span>-statistic is 26.15, the degrees of freedom are 2 and 14, and the <span class="math inline">\(p\)</span>-value is 0.00002. The numbers are identical to the ones we obtained for the main effect of drug in our original ANOVA. Once again we see that ANOVA and regression are essentially the same. They are both linear models, and the underlying statistical machinery for ANOVA is identical to the machinery used in regression. The importance of this fact should not be understated. Throughout the rest of this chapter we’re going to rely heavily on this idea.</p>
<p>Although we went through all the faff of computing new variables in jamovi for the contrasts druganxifree and drugjoyzepam, just to show that ANOVA and regression are essentially the same, in the jamovi linear regression analysis there is actually a nifty shortcut to get these contrasts, see <a href="#fig-fig14-23">Figure&nbsp;<span>14.23</span></a>. What jamovi is doing here is allowing you to enter the predictor variables that are factors as, wait for it…factors! Smart, eh. You can also specify which group to use as the reference level, via the ‘Reference Levels’ option. We’ve changed this to ‘placebo’ and ‘no.therapy’, respectively, because this makes most sense.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-23" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-23.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi screenshot displaying linear regression analysis within a software interface. The interface shows data inputs and settings on the left, while the right side displays output results including ANOVA and model coefficients. Sections for data, analyses, edit, and more are visible."></p>
<figcaption class="figure-caption">Figure&nbsp;14.23: Regression analysis with factors and contrasts in jamovi, including omnibus ANOVA test results</figcaption>
</figure>
</div>
</div>
</div>
<p>If you also click on the ‘ANOVA’ test checkbox under the ‘Model Coefficients’ – ‘Omnibus Test’ option, we see that the <span class="math inline">\(F\)</span>-statistic is 26.15, the degrees of freedom are 2 and 14, and the <span class="math inline">\(p\)</span>-value is 0.00002 (<a href="#fig-fig14-23">Figure&nbsp;<span>14.23</span></a>). The numbers are identical to the ones we obtained for the main effect of drug in our original ANOVA. Once again, we see that ANOVA and regression are essentially the same. They are both linear models, and the underlying statistical machinery for ANOVA is identical to the machinery used in regression.</p>
</section>
<section id="degrees-of-freedom-as-parameter-counting" class="level3" data-number="14.6.5">
<h3 data-number="14.6.5" class="anchored" data-anchor-id="degrees-of-freedom-as-parameter-counting"><span class="header-section-number">14.6.5</span> Degrees of freedom as parameter counting!</h3>
<p>At long last, I can finally give a definition of degrees of freedom that I am happy with. Degrees of freedom are defined in terms of the number of parameters that have to be estimated in a model. For a regression model or an ANOVA, the number of parameters corresponds to the number of regression coefficients (i.e.&nbsp;<span class="math inline">\(b\)</span>-values), including the intercept. Keeping in mind that any <span class="math inline">\(F\)</span>-test is always a comparison between two models and the first df is the difference in the number of parameters. For example, in the model comparison above, the null model (mood.gain ~ CBTtherapy) has two parameters: there’s one regression coefficient for the CBTtherapy variable, and a second one for the intercept. The alternative model (mood.gain ~ druganxifree + drugjoyzepam + CBTtherapy) has four parameters: one regression coefficient for each of the three contrasts, and one more for the intercept. So the degrees of freedom associated with the difference between these two models is <span class="math inline">\(df_1 = 4 - 2 = 2\)</span>.</p>
<p>What about the case when there doesn’t seem to be a null model? For instance, you might be thinking of the <span class="math inline">\(F\)</span>-test that shows up when you select ‘F Test’ under the ‘Linear Regression’ – ‘Model Fit’ options. I originally described that as a test of the regression model as a whole. However, that is still a comparison between two models. The null model is the trivial model that only includes 1 regression coefficient, for the intercept term. The alternative model contains <span class="math inline">\(K + 1\)</span> regression coefficients, one for each of the <span class="math inline">\(K\)</span> predictor variables and one more for the intercept. So the <span class="math inline">\(df\)</span> value that you see in this <span class="math inline">\(F\)</span>-test is equal to <span class="math inline">\(df_1 = K + 1 - 1 = K\)</span>.</p>
<p>What about the second <span class="math inline">\(df\)</span> value that appears in the <span class="math inline">\(F\)</span>-test? This always refers to the degrees of freedom associated with the residuals. It is possible to think of this in terms of parameters too, but in a slightly counter-intuitive way. Think of it like this. Suppose that the total number of observations across the study as a whole is <span class="math inline">\(N\)</span>. If you wanted to perfectly describe each of these <span class="math inline">\(N\)</span> values, you need to do so using, well… <span class="math inline">\(N\)</span> numbers. When you build a regression model, what you’re really doing is specifying that some of the numbers need to perfectly describe the data. If your model has <span class="math inline">\(K\)</span> predictors and an intercept, then you’ve specified <span class="math inline">\(K + 1\)</span> numbers. So, without bothering to figure out exactly how this would be done, how many more numbers do you think are going to be needed to transform a <span class="math inline">\(K + 1\)</span> parameter regression model into a perfect re-description of the raw data? If you found yourself thinking that <span class="math inline">\((K + 1) + (N - K - 1) = N\)</span>, and so the answer would have to be <span class="math inline">\(N - K - 1\)</span>, well done! That’s exactly right. In principle you can imagine an absurdly complicated regression model that includes a parameter for every single data point, and it would of course provide a perfect description of the data. This model would contain <span class="math inline">\(N\)</span> parameters in total, but we’re interested in the difference between the number of parameters required to describe this full model (i.e.&nbsp;<span class="math inline">\(N\)</span>) and the number of parameters used by the simpler regression model that you’re actually interested in (i.e., <span class="math inline">\(K + 1\)</span>), and so the second degrees of freedom in the <span class="math inline">\(F\)</span> test is <span class="math inline">\(df_2 = N - K - 1\)</span>, where <span class="math inline">\(K\)</span> is the number of predictors (in a regression model) or the number of contrasts (in an ANOVA). In the example I gave above, there are <span class="math inline">\((N = 18\)</span> observations in the data set and <span class="math inline">\(K + 1 = 4\)</span> regression coefficients associated with the ANOVA model, so the degrees of freedom for the residuals is <span class="math inline">\(df_2 = 18 - 4 = 14\)</span>.</p>
</section>
</section>
<section id="different-ways-to-specify-contrasts" class="level2" data-number="14.7">
<h2 data-number="14.7" class="anchored" data-anchor-id="different-ways-to-specify-contrasts"><span class="header-section-number">14.7</span> Different ways to specify contrasts</h2>
<p>In the previous section, I showed you a method for converting a factor into a collection of contrasts. In the method I showed you we specify a set of binary variables in which we defined a table like <a href="#tbl-tab14-11">Table&nbsp;<span>14.11</span></a>.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-11" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-11"><caption>Table&nbsp;14.11:  <p>Binary contrasts to discriminate between all three possible drugs</p> </caption>
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">drug</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">druganxifree</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">drugjoyzepam</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">\(placebo\)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">\(anxifree\)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">\(joyzepam\)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Each row in the table corresponds to one of the factor levels, and each column corresponds to one of the contrasts. This table, which always has one more row than columns, has a special name. It is called a contrast matrix. However, there are lots of different ways to specify a contrast matrix. In this section I discuss a few of the standard contrast matrices that statisticians use and how you can use them in jamovi. If you’re planning to read the section on <a href="#factorial-anova-3-unbalanced-designs">Factorial ANOVA 3: unbalanced designs</a> later on, it’s worth reading this section carefully. If not, you can get away with skimming it, because the choice of contrasts doesn’t matter much for balanced designs.</p>
<section id="treatment-contrasts" class="level3" data-number="14.7.1">
<h3 data-number="14.7.1" class="anchored" data-anchor-id="treatment-contrasts"><span class="header-section-number">14.7.1</span> Treatment contrasts</h3>
<p>In the particular kind of contrasts that I’ve described above, one level of the factor is special, and acts as a kind of “baseline” category (i.e., placebo in our example), against which the other two are defined. The name for these kinds of contrasts is treatment contrasts, also known as “dummy coding”. In this contrast each level of the factor is compared to a base reference level, and the base reference level is the value of the intercept.</p>
<p>The name reflects the fact that these contrasts are natural and sensible when one of the categories in your factor really is special and actually does represent a baseline. That makes sense in our clinical trial example. The placebo condition corresponds to the situation where you don’t give people any real drugs, and so it’s special. The other two conditions are defined in relation to the placebo. In one case you replace the placebo with Anxifree, and in the other case your replace it with Joyzepam.</p>
<p>The table shown above is a matrix of treatment contrasts for a factor that has 3 levels. But suppose I want a matrix of treatment contrasts for a factor with 5 levels? You would set this out like <a href="#tbl-tab14-12">Table&nbsp;<span>14.12</span></a>.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-12" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-12"><caption>Table&nbsp;14.12:  <p>Matrix of treatment contrasts with 5 levels</p> </caption>
<colgroup><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Level</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">3</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">4</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">5</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>In this example, the first contrast is level 2 compared with level 1, the second contrast is level 3 compared with level 1, and so on. Notice that, by default, the <em>first</em> level of the factor is always treated as the baseline category (i.e., it’s the one that has all zeros and doesn’t have an explicit contrast associated with it). In jamovi you can change which category is the first level of the factor by manipulating the order of the levels of the variable shown in the ‘Data Variable’ window (double click on the name of the variable in the spreadsheet column to bring up the ‘Data Variable’ view.</p>
</section>
<section id="helmert-contrasts" class="level3" data-number="14.7.2">
<h3 data-number="14.7.2" class="anchored" data-anchor-id="helmert-contrasts"><span class="header-section-number">14.7.2</span> Helmert contrasts</h3>
<p>Treatment contrasts are useful for a lot of situations. However, they make most sense in the situation when there really is a baseline category, and you want to assess all the other groups in relation to that one. In other situations, however, no such baseline category exists, and it may make more sense to compare each group to the mean of the other groups. This is where we meet Helmert contrasts, generated by the ‘helmert’ option in the jamovi ‘ANOVA’ – ‘Contrasts’ selection box. The idea behind Helmert contrasts is to compare each group to the mean of the “previous” ones. That is, the first contrast represents the difference between group 2 and group 1, the second contrast represents the difference between group 3 and the mean of groups 1 and 2, and so on. This translates to a contrast matrix that looks like <a href="#tbl-tab14-13">Table&nbsp;<span>14.13</span></a> for a factor with five levels.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-13" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-13"><caption>Table&nbsp;14.13:  <p>Matrix of helmert contrasts with 5 levels</p> </caption>
<colgroup><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">1</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">-1</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">-1</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">-1</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">-1</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">-1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">-1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">-1</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">-1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">-1</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">-1</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">4</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>One useful thing about Helmert contrasts is that every contrast sums to zero (i.e., all the columns sum to zero). This has the consequence that, when we interpret the ANOVA as a regression, the intercept term corresponds to the grand mean <span class="math inline">\(\mu_{..}\)</span> if we are using Helmert contrasts. Compare this to treatment contrasts, in which the intercept term corresponds to the group mean for the baseline category. This property can be very useful in some situations. It doesn’t matter very much if you have a balanced design, which we’ve been assuming so far, but it will turn out to be important later when we consider <a href="#factorial-anova-3-unbalanced-designs">Factorial ANOVA 3: unbalanced designs</a>. In fact, the main reason why I’ve even bothered to include this section is that contrasts become important if you want to understand unbalanced ANOVA.</p>
</section>
<section id="sum-to-zero-contrasts" class="level3" data-number="14.7.3">
<h3 data-number="14.7.3" class="anchored" data-anchor-id="sum-to-zero-contrasts"><span class="header-section-number">14.7.3</span> Sum to zero contrasts</h3>
<p>The third option that I should briefly mention are “sum to zero” contrasts, called “Simple” contrasts in jamovi, which are used to construct pairwise comparisons between groups. Specifically, each contrast encodes the difference between one of the groups and a baseline category, which in this case corresponds to the first group (<a href="#tbl-tab14-14">Table&nbsp;<span>14.14</span></a>).</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-14" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-14"><caption>Table&nbsp;14.14:  <p>Matrix of “sum to” zero contrasts with 5 levels</p> </caption>
<colgroup><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">1</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">-1</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">-1</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">-1</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">-1</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Much like Helmert contrasts, we see that each column sums to zero, which means that the intercept term corresponds to the grand mean when ANOVA is treated as a regression model. When interpreting these contrasts, the thing to recognise is that each of these contrasts is a pairwise comparison between group 1 and one of the other four groups. Specifically, contrast 1 corresponds to a “group 2 minus group 1” comparison, contrast 2 corresponds to a “group 3 minus group 1” comparison, and so on.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
</section>
<section id="optional-contrasts-in-jamovi" class="level3" data-number="14.7.4">
<h3 data-number="14.7.4" class="anchored" data-anchor-id="optional-contrasts-in-jamovi"><span class="header-section-number">14.7.4</span> Optional contrasts in jamovi</h3>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-15" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-15"><caption>Table&nbsp;14.15:  <p>Contrasts available in the jamovi ANOVA analysis</p> </caption>
<colgroup><col style="width: 25%"><col style="width: 75%"></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Contrast type</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;"></th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Deviation</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">Compares the mean of each level (except a reference category) to the mean of all of the levels (grand mean)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Simple</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">Like the treatment contrasts, the simple contrast compares the mean of each level to the mean of a specified level. This type of contrast is useful when there is a control group. By default the first category is the reference. However, with a simple contrast the intercept is the grand mean of all the levels of the factors.</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Difference</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">Compares the mean of each level (except the first) to the mean of previous levels. (Sometimes called reverse Helmert contrasts)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Helmert</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">Compares the mean of each level of the factor (except the last) to the mean of subsequent levels</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Repeated</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">Compares the mean of each level (except the last) to the mean of the subsequent level</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Polynomial</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">Compares the linear effect and quadratic effect. The first degree of freedom contains the linear effect across all categories; the second degree of freedom, the quadratic effect. These contrasts are often used to estimate polynomial trends</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>jamovi also comes with a variety of options that can generate different kinds of contrasts in ANOVA. These can be found in the ‘Contrasts’ option in the main ANOVA analysis window, where the contrast types in <a href="#tbl-tab14-15">Table&nbsp;<span>14.15</span></a> are listed.</p>
</section>
</section>
<section id="sec-Post-hoc-tests" class="level2" data-number="14.8">
<h2 data-number="14.8" class="anchored" data-anchor-id="sec-Post-hoc-tests"><span class="header-section-number">14.8</span> Post hoc tests</h2>
<p>Time to switch to a different topic. Rather than pre-planned comparisons that you have tested using contrasts, let’s suppose you’ve done your ANOVA and it turns out that you obtained some significant effects. Because of the fact that the <span class="math inline">\(F\)</span>-tests are “omnibus” tests that only really test the null hypothesis that there are no differences among groups, obtaining a significant effect doesn’t tell you which groups are different to which other ones. We discussed this issue back in <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a>, and in that chapter our solution was to run <span class="math inline">\(t\)</span>-tests for all possible pairs of groups, making corrections for multiple comparisons (e.g., Bonferroni, Holm) to control the type I error rate across all comparisons. The methods that we used back in <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a> have the advantage of being relatively simple and being the kind of tools that you can use in a lot of different situations where you’re testing multiple hypotheses, but they’re not necessarily the best choices if you’re interested in doing efficient post hoc testing in an ANOVA context. There are actually quite a lot of different methods for performing multiple comparisons in the statistics literature <span class="citation" data-cites="Hsu1996">(<a href="References.html#ref-Hsu1996" role="doc-biblioref">Hsu, 1996</a>)</span>, and it would be beyond the scope of an introductory text like this one to discuss all of them in any detail.</p>
<p>That being said, there’s one tool that I do want to draw your attention to, namely Tukey’s “Honestly Significant Difference”, or <strong>Tukey’s HSD</strong> for short. For once, I’ll spare you the formulas and just stick to the qualitative ideas. The basic idea in Tukey’s HSD is to examine all relevant pairwise comparisons between groups, and it’s only really appropriate to use Tukey’s HSD if it is pairwise differences that you’re interested in.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> For instance, earlier we conducted a factorial ANOVA using the <em>clinicaltrial.csv</em> data set, and where we specified a main effect for drug and a main effect of therapy we would be interested in the following four comparisons:</p>
<ul>
<li>The difference in mood gain for people given Anxifree versus people given the placebo.</li>
<li>The difference in mood gain for people given Joyzepam versus people given the placebo.</li>
<li>The difference in mood gain for people given Anxifree versus people given Joyzepam.</li>
<li>The difference in mood gain for people treated with CBT and people given no therapy.</li>
</ul>
<p>For any one of these comparisons, we’re interested in the true difference between (population) group means. Tukey’s HSD constructs simultaneous confidence intervals for all four of these comparisons. What we mean by 95% “simultaneous” confidence interval is that, if we were to repeat this study many times, then in 95% of the study results the confidence intervals would contain the relevant true value. Moreover, we can use these confidence intervals to calculate an adjusted <span class="math inline">\(p\)</span>-value for any specific comparison.</p>
<p>The TukeyHSD function in jamovi is pretty easy to use. You simply specify the ANOVA model term that you want to run the post hoc tests for. For example, if we were looking to run post hoc tests for the main effects but not the interaction, we would open up the ‘Post Hoc Tests’ option in the ANOVA analysis screen, move the drug and therapy variables across to the box on the right, and then select the ‘Tukey’ checkbox in the list of possible post hoc corrections that could be applied. This, along with the corresponding results table, is shown in <a href="#fig-fig14-24">Figure&nbsp;<span>14.24</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-24" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-24.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi screenshot showing ANOVA results. The interface has sections for setting variables and analyzing data, with specific fields selected for &quot;drug&quot; and &quot;therapy.&quot; A window on the right shows detailed ANOVA test results and post hoc comparisons."></p>
<figcaption class="figure-caption">Figure&nbsp;14.24: Tukey HSD post hoc test in jamovi factorial ANOVA, without an interaction term</figcaption>
</figure>
</div>
</div>
</div>
<p>The output shown in the ‘Post Hoc Tests’ results table is (I hope) pretty straightforward. The first comparison, for example, is the Anxifree versus placebo difference, and the first part of the output indicates that the observed difference in group means is .27. The next number is the standard error for the difference, from which we could calculate the 95% confidence interval if we wanted, though jamovi does not currently provide this option. Then there is a column with the degrees of freedom, a column with the <span class="math inline">\(t\)</span>-value, and finally a column with the <span class="math inline">\(p\)</span>-value. For the first comparison the adjusted <span class="math inline">\(p\)</span>-value is .21. In contrast, if you look at the next line, we see that the observed difference between joyzepam and the placebo is 1.03, and this result is significant (<span class="math inline">\(p &lt; .001\)</span>).</p>
<p>So far, so good. What about the situation where your model includes interaction terms? For instance, the default option in jamovi is to allow for the possibility that there is an interaction between drug and therapy. If that’s the case, the number of pairwise comparisons that we need to consider starts to increase. As before, we need to consider the three comparisons that are relevant to the main effect of drug and the one comparison that is relevant to the main effect of therapy. But, if we want to consider the possibility of a significant interaction (and try to find the group differences that underpin that significant interaction), we need to include comparisons such as the following:</p>
<ul>
<li>The difference in mood gain for people given Anxifree and treated with CBT, versus people given the placebo and treated with CBT.</li>
<li>The difference in mood gain for people given Anxifree and given no therapy, versus people given the placebo and given no therapy.</li>
<li>etc.</li>
</ul>
<p>There are quite a lot of these comparisons that you need to consider. So, when we run the Tukey post hoc analysis for this ANOVA model, we see that it has made a lot of pairwise comparisons (19 in total), as shown in <a href="#fig-fig14-25">Figure&nbsp;<span>14.25</span></a>. You can see that it looks pretty similar to before, but with a lot more comparisons made.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-25" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-25.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi table showing post hoc test results for drug and therapy comparisons. The table includes columns for drug, therapy, comparison, mean difference, SE, df, t-value, and $p$-value, with values provided for each comparison."></p>
<figcaption class="figure-caption">Figure&nbsp;14.25: Tukey HSD post hoc test in jamovi factorial ANOVA with an interaction term</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-The-method-of-planned-comparisons" class="level2" data-number="14.9">
<h2 data-number="14.9" class="anchored" data-anchor-id="sec-The-method-of-planned-comparisons"><span class="header-section-number">14.9</span> The method of planned comparisons</h2>
<p>Following on from the previous sections on contrasts and post hoc tests in ANOVA, I think the method of planned comparisons is important enough to deserve a quick discussion. In our discussions of multiple comparisons, in the previous section and back in <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a>, I’ve been assuming that the tests you want to run are genuinely post hoc. For instance, in our drugs example above, maybe you thought that the drugs would all have different effects on mood (i.e., you hypothesised a main effect of drug), but you didn’t have any specific hypothesis about how they would be different, nor did you have any real idea about which pairwise comparisons would be worth looking at. If that is the case, then you really have to resort to something like Tukey’s HSD to do your pairwise comparisons.</p>
<p>The situation is rather different, however, if you genuinely did have real, specific hypotheses about which comparisons are of interest, and you never ever have any intention to look at any other comparisons besides the ones that you specified ahead of time. When this is true, and if you honestly and rigorously stick to your noble intentions to not run any other comparisons (even when the data look like they’re showing you deliciously significant effects for stuff you didn’t have a hypothesis test for), then it doesn’t really make a lot of sense to run something like Tukey’s HSD, because it makes corrections for a whole bunch of comparisons that you never cared about and never had any intention of looking at. Under those circumstances, you can safely run a (limited) number of hypothesis tests without making an adjustment for multiple testing. This situation is known as the method of planned comparisons, and it is sometimes used in clinical trials. However, further consideration is out of scope for this introductory book, but at least you know that this method exists!</p>
</section>
<section id="factorial-anova-3-unbalanced-designs" class="level2" data-number="14.10">
<h2 data-number="14.10" class="anchored" data-anchor-id="factorial-anova-3-unbalanced-designs"><span class="header-section-number">14.10</span> Factorial ANOVA 3: unbalanced designs</h2>
<p>Factorial ANOVA is a very handy thing to know about. It’s been one of the standard tools used to analyse experimental data for many decades, and you’ll find that you can’t read more than two or three papers in psychology without running into an ANOVA in there somewhere. However, there’s one huge difference between the ANOVAs that you’ll see in a lot of real scientific articles and the ANOVAs that I’ve described so far. In in real life we’re rarely lucky enough to have perfectly balanced designs. For one reason or another, it’s typical to end up with more observations in some cells than in others. Or, to put it another way, we have an unbalanced design.</p>
<p>Unbalanced designs need to be treated with a lot more care than balanced designs, and the statistical theory that underpins them is a lot messier. It might be a consequence of this messiness, or it might be a shortage of time, but my experience has been that undergraduate research methods classes in psychology have a nasty tendency to ignore this issue completely. A lot of stats textbooks tend to gloss over it too. The net result of this, I think, is that a lot of active researchers in the field don’t actually know that there’s several different “types” of unbalanced ANOVAs, and they produce quite different answers. In fact, reading the psychological literature, I’m kind of amazed at the fact that most people who report the results of an unbalanced factorial ANOVA don’t actually give you enough details to reproduce the analysis. I secretly suspect that most people don’t even realise that their statistical software package is making a whole lot of substantive data analysis decisions on their behalf. It’s actually a little terrifying when you think about it. So, if you want to avoid handing control of your data analysis to stupid software, read on.</p>
<section id="the-coffee-data" class="level3" data-number="14.10.1">
<h3 data-number="14.10.1" class="anchored" data-anchor-id="the-coffee-data"><span class="header-section-number">14.10.1</span> The <em>coffee</em> data</h3>
<p>As usual, it will help us to work with some data. The <em>coffee.csv</em> file contains a hypothetical data set that produces an unbalanced <span class="math inline">\(3 \times 2\)</span> ANOVA. Suppose we were interested in finding out whether or not the tendency of people to babble when they have too much coffee is purely an effect of the coffee itself, or whether there’s some effect of the milk and sugar that people add to the coffee. Suppose we took 18 people and gave them some coffee to drink. The amount of coffee / caffeine was held constant, and we varied whether or not milk was added, so milk is a binary factor with two levels, “yes” and “no”. We also varied the kind of sugar involved. The coffee might contain “real” sugar or it might contain “fake” sugar (i.e., artificial sweetener) or it might contain “none” at all, so the sugar variable is a three level factor. Our outcome variable is a continuous variable that presumably refers to some psychologically sensible measure of the extent to which someone is “babbling”. The details don’t really matter for our purpose. Take a look at the data in the jamovi spreadsheet view, as in <a href="#fig-fig14-26">Figure&nbsp;<span>14.26</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-26" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-26.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi screenshot with the left side showing raw data in a table format with columns like 'milk,' 'sugar,' and 'bubble.' The right side shows the analysis results, including descriptive statistics like the mean and standard deviation."></p>
<figcaption class="figure-caption">Figure&nbsp;14.26: The <em>coffee.csv</em> data set in jamovi, with descriptive information aggregated by factor levels</figcaption>
</figure>
</div>
</div>
</div>
<p>Looking at the table of means in <a href="#fig-fig14-26">Figure&nbsp;<span>14.26</span></a> we get a strong impression that there are differences between the groups. This is especially true when we compare these means to the standard deviations for the babble variable. Across groups, this standard deviation varies from .14 to .71, which is fairly small relative to the differences in group means.<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a> Whilst this at first may seem like a straightforward factorial ANOVA, a problem arises when we look at how many observations we have in each group. See the different <span class="math inline">\(N\)</span>s for different groups shown in <a href="#fig-fig14-26">Figure&nbsp;<span>14.26</span></a>. This violates one of our original assumptions, namely that the number of people in each group is the same. We haven’t really discussed how to handle this situation.</p>
</section>
<section id="standard-anova-does-not-exist-for-unbalanced-designs" class="level3" data-number="14.10.2">
<h3 data-number="14.10.2" class="anchored" data-anchor-id="standard-anova-does-not-exist-for-unbalanced-designs"><span class="header-section-number">14.10.2</span> “Standard ANOVA” does not exist for unbalanced designs</h3>
<p>Unbalanced designs lead us to the somewhat unsettling discovery that there isn’t really any one thing that we might refer to as a standard ANOVA. In fact, it turns out that there are three fundamentally different ways<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> in which you might want to run an ANOVA in an unbalanced design. If you have a balanced design all three versions produce identical results, with the sums of squares, <span class="math inline">\(F\)</span>-values, etc., all conforming to the formulas that I gave at the start of the chapter. However, when your design is unbalanced they don’t give the same answers. Furthermore, they are not all equally appropriate to every situation. Some methods will be more appropriate to your situation than others. Given all this, it’s important to understand what the different types of ANOVA are and how they differ from one another.</p>
<p>The first kind of ANOVA is conventionally referred to as <strong>type I sum of squares</strong>. I’m sure you can guess what the other two are called. The “sum of squares” part of the name was introduced by the SAS statistical software package and has become standard nomenclature, but it’s a bit misleading in some ways. I think the logic for referring to them as different types of sum of squares is that, when you look at the ANOVA tables that they produce, the key difference in the numbers is the <span class="math inline">\(SS\)</span> values. The degrees of freedom don’t change, the <span class="math inline">\(MS\)</span> values are still defined as <span class="math inline">\(SS\)</span> divided by <span class="math inline">\(df\)</span>, etc. However, what the terminology gets wrong is that it hides the reason <em>why</em> the <span class="math inline">\(SS\)</span> values are different from one another. To that end, it’s a lot more helpful to think of the three different kinds of ANOVA as three different <em>hypothesis testing strategies</em>. These different strategies lead to different <span class="math inline">\(SS\)</span> values, to be sure, but it’s the strategy that is the important thing here, not the <span class="math inline">\(SS\)</span> values themselves. Recall from the section <a href="#sec-ANOVA-as-a-linear-model">ANOVA as a linear model</a> that any particular <span class="math inline">\(F\)</span>-test is best thought of as a comparison between two linear models. So, when you’re looking at an ANOVA table, it helps to remember that each of those <span class="math inline">\(F\)</span>-tests corresponds to a pair of models that are being compared. Of course, this leads naturally to the question of which pair of models is being compared. This is the fundamental difference between ANOVA types I, II and III: each one corresponds to a different way of choosing the model pairs for the tests.</p>
</section>
<section id="type-i-sum-of-squares" class="level3" data-number="14.10.3">
<h3 data-number="14.10.3" class="anchored" data-anchor-id="type-i-sum-of-squares"><span class="header-section-number">14.10.3</span> Type I sum of squares</h3>
<p>The type I method is sometimes referred to as the “sequential” sum of squares, because it involves a process of adding terms to the model one at a time. Consider the <em>coffee</em> data, for instance. Suppose we want to run the full <span class="math inline">\(3 \times 2\)</span> factorial ANOVA, including interaction terms. The full model contains the outcome variable babble, the predictor variables sugar and milk, and the interaction term sugar <span class="math inline">\(\times\)</span> milk. This can be written as <span class="math inline">\(babble \sim sugar + milk + sugar {\times} milk\)</span>. The type I strategy builds this model up sequentially, starting from the simplest possible model and gradually adding terms.</p>
<p>The simplest possible model for the data would be one in which neither milk nor sugar is assumed to have any effect on babbling. The only term that would be included in such a model is the intercept, written as babble ~ 1. This is our initial null hypothesis. The next simplest model for the data would be one in which only one of the two main effects is included. In the <em>coffee</em> data, there are two different possible choices here, because we could choose to add milk first or to add sugar first. The order actually turns out to matter, as we’ll see later, but for now let’s just make a choice arbitrarily and pick sugar. So, the second model in our sequence of models is babble ~ sugar, and it forms the alternative hypothesis for our first test. We now have our first hypothesis test (<a href="#tbl-tab14-16">Table&nbsp;<span>14.16</span></a>).</p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-16" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-16"><caption>Table&nbsp;14.16:  <p>Null and alternative hypotheses with the outcome variable
“babble”</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim 1\)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim  sugar\)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>This comparison forms our hypothesis test of the main effect of sugar. The next step in our model building exercise is to add the other main effect term, so the next model in our sequence is babble ~ sugar + milk. The second hypothesis test is then formed by comparing the following pair of models (<a href="#tbl-tab14-17">Table&nbsp;<span>14.17</span></a>).</p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-17" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-17"><caption>Table&nbsp;14.17:  <p>Further null and alternative hypotheses with the outcome variable
“babble”</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim  sugar\)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim  sugar + milk\)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>This comparison forms our hypothesis test of the main effect of milk. In one sense, this approach is very elegant: the alternative hypothesis from the first test forms the null hypothesis for the second one. It is in this sense that the type I method is strictly sequential. Every test builds directly on the results of the last one. However, in another sense it’s very inelegant, because there’s a strong asymmetry between the two tests. The test of the main effect of sugar (the first test) completely ignores milk, whereas the test of the main effect of milk (the second test) does take sugar into account. In any case, the fourth model in our sequence is now the full model, babble ~ sugar + milk + sugar <span class="math inline">\(\times\)</span> milk, and the corresponding hypothesis test is shown in <a href="#tbl-tab14-18">Table&nbsp;<span>14.18</span></a>.</p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-18" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-18"><caption>Table&nbsp;14.18:  <p>And more possible null and alternative hypotheses with the outcome
variable “babble”</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim  sugar + milk\)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim  sugar + milk + sugar * milk \)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Type III sum of squares is the default hypothesis testing method used by jamovi ANOVA, so to run a type I sum of squares analysis we have to select ‘Type 1’ in the ‘Sum of squares’ selection box in the jamovi ‘ANOVA’ – ‘Model’ options. This gives us the ANOVA table shown in <a href="#fig-fig14-27">Figure&nbsp;<span>14.27</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-27" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-27.png" class="img-fluid figure-img" style="width:80.0%" alt="ANOVA table showing data for the effects of sugar and milk on a dependent variable. Columns include Sum of Squares, df, Mean Square, F, and $p$-values for sugar, milk, their interaction (sugar * milk), and residuals with respective values."></p>
<figcaption class="figure-caption">Figure&nbsp;14.27: ANOVA results table using type I sum of squares in jamovi</figcaption>
</figure>
</div>
</div>
</div>
<p>The big problem with using type I sum of squares is the fact that it really does depend on the order in which you enter the variables. Yet, in many situations the researcher has no reason to prefer one ordering over another. This is presumably the case for our milk and sugar problem. Should we add milk first or sugar first? It feels exactly as arbitrary as a data analysis question as it does as a coffee-making question. There may in fact be some people with firm opinions about ordering, but it’s hard to imagine a principled answer to the question. Yet, look what happens when we change the ordering, as in <a href="#fig-fig14-28">Figure&nbsp;<span>14.28</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-28" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-28.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi table displaying ANOVA results with columns labeled Sum of Squares, $df$ (degrees of freedom), Mean Square, $F$, and $p$. Rows correspond to milk, sugar, milk × sugar interaction, and residuals. Values are provided for each entry."></p>
<figcaption class="figure-caption">Figure&nbsp;14.28: ANOVA results table using type I sum of squares in jamovi, but with factors entered in a different order (milk first)</figcaption>
</figure>
</div>
</div>
</div>
<p>The <span class="math inline">\(p\)</span>-values for both main effect terms have changed, and fairly dramatically. Among other things, the effect of milk has become significant (though one should avoid drawing any strong conclusions about this, as I’ve mentioned previously). Which of these two ANOVAs should one report? It’s not immediately obvious.</p>
<p>When you look at the hypothesis tests that are used to define the “first” main effect and the “second” one, it’s clear that they’re qualitatively different from one another. In our initial example, we saw that the test for the main effect of sugar completely ignores milk, whereas the test of the main effect of milk does take sugar into account. As such, the type I testing strategy really does treat the first main effect as if it had a kind of theoretical primacy over the second one. In my experience there is very rarely if ever any theoretically primacy of this kind that would justify treating any two main effects asymmetrically.</p>
<p>The consequence of all this is that type I tests are very rarely of much interest, and so we should move on to discuss type II tests and type III tests.</p>
</section>
<section id="type-iii-sum-of-squares" class="level3" data-number="14.10.4">
<h3 data-number="14.10.4" class="anchored" data-anchor-id="type-iii-sum-of-squares"><span class="header-section-number">14.10.4</span> Type III sum of squares</h3>
<p>Having just finished talking about type I tests, you might think that the natural thing to do next would be to talk about type II tests. However, I think it’s actually a bit more natural to discuss type III tests (which are simple and the default in jamovi ANOVA) before talking about type II tests (which are trickier). The basic idea behind type III tests is extremely simple. Regardless of which term you’re trying to evaluate, run the <span class="math inline">\(F\)</span>-test in which the alternative hypothesis corresponds to the full ANOVA model as specified by the user, and the null model just deletes that one term that you’re testing. For instance, in the coffee example, in which our full model was babble ~ sugar + milk + sugar <span class="math inline">\(\times\)</span> milk, the test for a main effect of sugar would correspond to a comparison between the following two models (<a href="#tbl-tab14-19">Table&nbsp;<span>14.19</span></a>).</p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-19" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-19"><caption>Table&nbsp;14.19:  <p>Null and alternative hypotheses with the outcome variable “babble”,
with type III sum of squares</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim  milk + sugar * milk\)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim  sugar + milk +sugar * milk \)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Similarly the main effect of milk is evaluated by testing the full model against a null model that removes the milk term, like in <a href="#tbl-tab14-20">Table&nbsp;<span>14.20</span></a>.</p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-20" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-20"><caption>Table&nbsp;14.20:  <p>Further null and alternative hypotheses with the outcome variable
‘babble’, with type III sum of squares</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim  sugar + sugar * milk\)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim  sugar + milk +sugar * milk \)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Finally, the interaction term sugar <span class="math inline">\(\times\)</span> milk is evaluated in exactly the same way. Once again, we test the full model against a null model that removes the sugar <span class="math inline">\(\times\)</span> milk interaction term, like in <a href="#tbl-tab14-21">Table&nbsp;<span>14.21</span></a>.</p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-21" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-21"><caption>Table&nbsp;14.21:  <p>Removing the interaction term from hypotheses with the outcome
variable ‘babble’, with type III sum of squares</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim  sugar + milk\)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim  sugar + milk +sugar * milk \)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>The basic idea generalises to higher order ANOVAs. For instance, suppose that we were trying to run an ANOVA with three factors, A, B and C, and we wanted to consider all possible main effects and all possible interactions, including the three way interaction A <span class="math inline">\(\times\)</span> B <span class="math inline">\(\times\)</span> C. (<a href="#tbl-tab14-22">Table&nbsp;<span>14.22</span></a>) shows you what the Type III tests look like for this situation).</p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-22" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-22"><caption>Table&nbsp;14.22:  <p>Type III tests with three factors and all main effect and interaction
term</p> </caption>
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Term being tested is</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Null model is outcome ~ ...</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">Alternative model is outcome ~ ...</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(B + C + A*B + A*C + B*C + A*B*C \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">B</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + C + A*B + A*C + B*C + A*B*C \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C\)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">C</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + A*B + A*C + B*C + A*B*C \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A*B</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*C + B*C + A*B*C \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A*C</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + B*C + A*B*C \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">B*C</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + A*B*C \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A*B*C</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C \)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>As ugly as that table looks, it’s pretty simple. In all cases, the alternative hypothesis corresponds to the full model which contains three main effect terms (e.g., A), three two-way interactions (e.g., A*B) and one three-way interaction (i.e., A*B*C). The null model always contains 6 of these 7 terms, and the missing one is the one whose significance we’re trying to test.</p>
<p>At first pass, type III tests seem like a nice idea. Firstly, we’ve removed the asymmetry that caused us to have problems when running type I tests. And because we’re now treating all terms the same way, the results of the hypothesis tests do not depend on the order in which we specify them. This is definitely a good thing. However, there is a big problem when interpreting the results of the tests, especially for main effect terms. Consider the <em>coffee</em> data. Suppose it turns out that the main effect of milk is not significant according to the type III tests. What this is telling us is that babble ~ sugar + sugar*milk is a better model for the data than the full model. But what does that even mean? If the interaction term sugar*milk was also non significant, we’d be tempted to conclude that the data are telling us that the only thing that matters is sugar. But suppose we have a significant interaction term, but a non-significant main effect of milk. In this case, are we to assume that there really is an “effect of sugar”, an “interaction between milk and sugar”, but no “effect of milk”? That seems crazy. The right answer simply must be that it’s meaningless<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> to talk about the main effect if the interaction is significant. In general, this seems to be what most statisticians advise us to do, and I think that’s the right advice. But if it really is meaningless to talk about non-significant main effects in the presence of a significant interaction, then it’s not at all obvious why type III tests should allow the null hypothesis to rely on a model that includes the interaction but omits one of the main effects that make it up. When characterised in this fashion, the null hypotheses really don’t make much sense at all.</p>
<p>Later on, we’ll see that type III tests can be redeemed in some contexts, but first let’s take a look at the ANOVA results table using type III sum of squares, see <a href="#fig-fig14-29">Figure&nbsp;<span>14.29</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-29" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-29.png" class="img-fluid figure-img" style="width:80.0%" alt="A jamovi table titled &quot;ANOVA - babble&quot; shows statistical data with columns:- Sum of Squares, df, Mean Square, F, and p. Rows include milk, sugar, milk ✻ sugar, and Residuals. Notable values include F = 11.28 for milk ✻ sugar, and p = 0.00175 for the same interaction."></p>
<figcaption class="figure-caption">Figure&nbsp;14.29: ANOVA results table using type III sum of squares in jamovi</figcaption>
</figure>
</div>
</div>
</div>
<p>But be aware, one of the perverse features of the type III testing strategy is that typically the results turn out to depend on the contrasts that you use to encode your factors (see the <a href="#different-ways-to-specify-contrasts">Different ways to specify contrasts</a> section if you’ve forgotten what the different types of contrasts are).<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a></p>
<p>Okay, so if the <span class="math inline">\(p\)</span>-values that typically come out of type III analyses (but not in jamovi) are so sensitive to the choice of contrasts, does that mean that type III tests are essentially arbitrary and not to be trusted? To some extent that’s true, and when we turn to a discussion of type II tests we’ll see that type II analyses avoid this arbitrariness entirely, but I think that’s too strong a conclusion. Firstly, it’s important to recognise that some choices of contrasts will always produce the same answers (ah, so this is what is happening in jamovi). Of particular importance is the fact that if the columns of our contrast matrix are all constrained to sum to zero, then the type III analysis will always give the same answers.</p>
</section>
<section id="type-ii-sum-of-squares" class="level3" data-number="14.10.5">
<h3 data-number="14.10.5" class="anchored" data-anchor-id="type-ii-sum-of-squares"><span class="header-section-number">14.10.5</span> Type II sum of squares</h3>
<p>Okay, so we’ve seen type I and III tests now, and both are pretty straightforward. Type I tests are performed by gradually adding terms one at a time, whereas type III tests are performed by taking the full model and looking to see what happens when you remove each term. However, both can have some limitations. Type I tests are dependent on the order in which you enter the terms, and type III tests are dependent on how you code up your contrasts. Type II tests are a little harder to describe, but they avoid both of these problems, and as a result they are a little easier to interpret.</p>
<p>Type II tests are broadly similar to type III tests. Start with a “full” model, and test a particular term by deleting it from that model. However, type II tests are based on the marginality principle which states that you should not omit a lower order term from your model if there are any higher order ones that depend on it. So, for instance, if your model contains the two-way interaction A <span class="math inline">\(\times\)</span> B (a 2nd order term), then it really ought to contain the main effects A and B (1st order terms). Similarly, if it contains a three-way interaction term A <span class="math inline">\(\times\)</span> B <span class="math inline">\(\times\)</span> C, then the model must also include the main effects A, B and C as well as the simpler interactions A <span class="math inline">\(\times\)</span> B, A <span class="math inline">\(\times\)</span> C and B <span class="math inline">\(\times\)</span> C. Type III tests routinely violate the marginality principle. For instance, consider the test of the main effect of A in the context of a three-way ANOVA that includes all possible interaction terms. According to type III tests, our null and alternative models are in <a href="#tbl-tab14-23">Table&nbsp;<span>14.23</span></a>.</p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-23" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-23"><caption>Table&nbsp;14.23:  <p>Type III tests for a main effect, A, in a three-way ANOVA with all
possible interaction terms</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(outcome \sim B + C + A*B + A*C + B*C + A*B*C\)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(outcome \sim A + B + C + A*B + A*C + B*C + A*B*C\)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Notice that the null hypothesis omits A, but includes A <span class="math inline">\(\times\)</span> B, A <span class="math inline">\(\times\)</span> C and A <span class="math inline">\(\times\)</span> B <span class="math inline">\(\times\)</span> C as part of the model. This, according to the type II tests, is not a good choice of null hypothesis. What we should do instead, if we want to test the null hypothesis that A is not relevant to our outcome, is to specify the null hypothesis that is the most complicated model that does not rely on A in any form, even as an interaction. The alternative hypothesis corresponds to this null model plus a main effect term of A. This is a lot closer to what most people would intuitively think of as a “main effect of A”, and it yields the following as our type II test of the main effect of A (<a href="#tbl-tab14-24">Table&nbsp;<span>14.24</span></a>).<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a></p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-24" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-24"><caption>Table&nbsp;14.24:  <p>Type II tests for a main effect, A, in a three-way ANOVA with all
possible interaction terms</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(outcome \sim B + C + B*C\)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(outcome \sim A + B + C + B*C\)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Anyway, just to give you a sense of how the type II tests play out, see the full table (<a href="#tbl-tab14-25">Table&nbsp;<span>14.25</span></a>) of tests that would be applied in a three-way factorial ANOVA.</p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-25" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-25"><caption>Table&nbsp;14.25:  <p>Type II tests for a three-way factorial model</p> </caption>
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Term being tested is</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Null model is outcome ~ ...</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">Alternative model is outcome ~ ...</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(B + C + B*C \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + B*C \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">B</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + C + A*C \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*C\)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">C</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + A*B \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B\)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A*B</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*C + B*C  \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A*C</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + B*C  \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">B*C</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C \)</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A*B*C</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C \)</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C \)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>In the context of the two way ANOVA that we’ve been using in the <em>coffee</em> data, the hypothesis tests are even simpler. The main effect of sugar corresponds to an <span class="math inline">\(F\)</span>-test comparing these two models (<a href="#tbl-tab14-26">Table&nbsp;<span>14.26</span></a>).</p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-26" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-26"><caption>Table&nbsp;14.26:  <p>Type II tests for the main effect of sugar in the <em>coffee</em>
data</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim milk \)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim sugar + milk\)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>The test for the main effect of milk is in <a href="#tbl-tab14-27">Table&nbsp;<span>14.27</span></a>.</p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-27" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-27"><caption>Table&nbsp;14.27:  <p>Type II tests for the main effect of milk in the <em>coffee</em>
data</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim  sugar \)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim sugar + milk\)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Finally, the test for the interaction sugar <span class="math inline">\(\times\)</span> milk is in <a href="#tbl-tab14-28">Table&nbsp;<span>14.28</span></a>.</p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-28" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-28"><caption>Table&nbsp;14.28:  <p>Type II tests for the sugar <span class="math inline">×</span> milk
interaction term</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim  sugar + milk \)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim sugar + milk  + sugar*milk \)</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Running the tests are again straightforward. Just select ‘Type 2’ in the ‘Sum of squares’ selection box in the jamovi ‘ANOVA’ – ‘Model’ options, This gives us the ANOVA table shown in <a href="#fig-fig14-30">Figure&nbsp;<span>14.30</span></a>.</p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-30" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-30.png" class="img-fluid figure-img" style="width:80.0%" alt="Table displaying ANOVA results for an interaction between milk and sugar. Columns include Sum of Squares, df, Mean Square, F, p, η², η²p, and ω² for milk, sugar, milk * sugar, and residuals. The interaction shows significant results."></p>
<figcaption class="figure-caption">Figure&nbsp;14.30: ANOVA results table using type II sum of squares in jamovi</figcaption>
</figure>
</div>
</div>
</div>
<p>Type II tests have some clear advantages over type I and type III tests. They don’t depend on the order in which you specify factors (unlike type I), and they don’t depend on the contrasts that you use to specify your factors (unlike type III). And although opinions may differ on this last point, and it will definitely depend on what you’re trying to do with your data, I do think that the hypothesis tests that they specify are more likely to correspond to something that you actually care about. As a consequence, I find that it’s usually easier to interpret the results of a type II test than the results of a type I or type III test. For this reason my tentative advice is that, if you can’t think of any obvious model comparisons that directly map onto your research questions but you still want to run an ANOVA in an unbalanced design, type II tests are probably a better choice than type I or type III.<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a></p>
</section>
<section id="effect-sizes-and-non-additive-sums-of-squares" class="level3" data-number="14.10.6">
<h3 data-number="14.10.6" class="anchored" data-anchor-id="effect-sizes-and-non-additive-sums-of-squares"><span class="header-section-number">14.10.6</span> Effect sizes (and non-additive sums of squares)</h3>
<p>jamovi also provides the effect sizes <span class="math inline">\(\eta^2\)</span> and partial <span class="math inline">\(\eta^2\)</span> when you select these options, as in <a href="#fig-fig14-30">Figure&nbsp;<span>14.30</span></a>. However, when you’ve got an unbalanced design there’s a bit of extra complexity involved.</p>
<p>If you remember back to our very early discussions of ANOVA, one of the key ideas behind the sums of squares calculations is that if we add up all the <span class="math inline">\(SS\)</span> terms associated with the effects in the model, and add that to the residual <span class="math inline">\(SS\)</span>, they’re supposed to add up to the total sum of squares. And, on top of that, the whole idea behind <span class="math inline">\(\eta^2\)</span> is that, because you’re dividing one of the <span class="math inline">\(SS\)</span> terms by the total <span class="math inline">\(SS\)</span> value, an <span class="math inline">\(\eta^2\)</span> value can be interpreted as the proportion of variance accounted for by a particular term. But this is not so straightforward in unbalanced designs because some of the variance goes “missing”.</p>
<p>This seems a bit odd at first, but here’s why. When you have unbalanced designs your factors become correlated with one another, and it becomes difficult to tell the difference between the effect of Factor A and the effect of Factor B. In the extreme case, suppose that we’d run a <span class="math inline">\(2 \times 2\)</span> design in which the number of participants in each group had been as in <a href="#tbl-tab14-29">Table&nbsp;<span>14.29</span></a>.</p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-29" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-29"><caption>Table&nbsp;14.29:  <p><span class="math inline"><em>N</em></span> participants in a 2 x 2
very (very!) unbalanced factorial design</p> </caption>
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">sugar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">no sugar</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">milk</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">100</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">no milk</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">100</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Here we have a spectacularly unbalanced design: 100 people have milk and sugar, 100 people have no milk and no sugar, and that’s all. There are 0 people with milk and no sugar, and 0 people with sugar but no milk. Now suppose that, when we collected the data, it turned out there is a large (and statistically significant) difference between the “milk and sugar” group and the “no-milk and no-sugar” group. Is this a main effect of sugar? A main effect of milk? Or an interaction? It’s impossible to tell, because the presence of sugar has a perfect association with the presence of milk. Now suppose the design had been a little more balanced (<a href="#tbl-tab14-30">Table&nbsp;<span>14.30</span></a>).</p>
<div class="cell" data-layout-align="left" data-tbl-pos="H">
<div class="cell-output-display">
<div id="tbl-tab14-30" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:tbl-tab14-30"><caption>Table&nbsp;14.30:  <p><span class="math inline"><em>N</em></span> participants in a 2 x 2
still very unbalanced factorial design</p> </caption>
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: bold;">sugar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: bold;">no sugar</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">milk</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">100</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">5</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 0pt; font-weight: normal;">no milk</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 12pt 2pt 12pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 12pt; font-weight: normal;">100</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>This time around, it’s technically possible to distinguish between the effect of milk and the effect of sugar, because we have a few people that have one but not the other. However, it will still be pretty difficult to do so, because the association between sugar and milk is still extremely strong, and there are so few observations in two of the groups. Again, we’re very likely to be in the situation where we <em>know</em> that the predictor variables (milk and sugar) are related to the outcome (babbling), but we don’t know if the nature of that relationship is a main effect of one or the other predictor, or the interaction.</p>
</section>
</section>
<section id="summary" class="level2" data-number="14.11">
<h2 data-number="14.11" class="anchored" data-anchor-id="summary"><span class="header-section-number">14.11</span> Summary</h2>
<ul>
<li><a href="#factorial-anova-1-balanced-designs-focus-on-main-effects">Factorial ANOVA 1: balanced designs, focus on main effects</a> and with <a href="Factorial ANOVA: balanced designs, interpreting interactions">interactions</a> considered.</li>
<li><a href="#effect-size">Effect size</a>, estimated means, and confidence intervals in a factorial ANOVA.</li>
<li><a href="#assumption-checking">Assumption checking</a> in ANOVA.</li>
<li><a href="#analysis-of-covariance-ancova">Analysis of Covariance (ANCOVA)</a>.</li>
<li>Understanding <a href="#sec-ANOVA-as-a-linear-model">ANOVA as a linear model</a>, including <a href="#different-ways-to-specify-contrasts">Different ways to specify contrasts</a>.</li>
<li><a href="#sec-Post-hoc-tests">Post hoc tests</a> using Tukey’s HSD and a brief commentary on <a href="#sec-The-method-of-planned-comparisons">The method of planned comparisons</a>.</li>
<li><a href="#factorial-anova-3-unbalanced-designs">Factorial ANOVA 3: unbalanced designs</a>.</li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Everitt1996" class="csl-entry" role="listitem">
Everitt, B. S. (1996). <em>Making sense of statistics in psychology. A second-level course</em>. Oxford University Press.
</div>
<div id="ref-Hsu1996" class="csl-entry" role="listitem">
Hsu, J. C. (1996). <em>Multiple comparisons: Theory and methods</em>. Chapman &amp; Hall. <a href="https://doi.org/10.1201/b15074">https://doi.org/10.1201/b15074</a>
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The nice thing about the subscript notation is that it generalises nicely. If our experiment had involved a third factor, then we could just add a third subscript. In principle, the notation extends to as many factors as you might care to include, but in this book we’ll rarely consider analyses involving more than two factors, and never more than three.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Technically, marginalising isn’t quite identical to a regular mean. It’s a weighted average where you take into account the frequency of the different events that you’re averaging over. However, in a balanced design, all of our cell frequencies are equal by definition so the two are equivalent. We’ll discuss unbalanced designs later, and when we do so you’ll see that all of our calculations become a real headache. But let’s ignore this for now.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>NB There are some rounding errors here, the value of the mean square, to 5 decimal places, is 1.72667. And the value of the residual mean square to 5 decimal places, is 0.05444. jamovi actually uses many more decimal places in its calculations, but the figures shown in the results tables are rounded for clarity. Though you can change the number of decimal places displayed by jamovi if you want.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Now that we’ve got our notation straight, we can compute the sum of squares values for each of the two factors in a relatively familiar way. For Factor A, our between group sum of squares is calculated by assessing the extent to which the (row) marginal means <span class="math inline">\(\bar{Y}_{1.} , \bar{Y}_{2.}\)</span> etc, are different from the grand mean <span class="math inline">\(\bar{Y}_{..}\)</span> We do this in the same way that we did for one-way ANOVA: calculate the sum of squared difference between the <span class="math inline">\(\bar{Y}_{i.}\)</span> values and the <span class="math inline">\(\bar{Y}_{..}\)</span> values. Specifically, if there are <span class="math inline">\(N\)</span> people in each group, then we calculate this: <span class="math display">\[SS_A=(N \times C)\sum_{r=1}^R (\bar{Y}_{r.}-\bar{Y}_{..})^2\]</span> As with one-way ANOVA, the most interesting<span class="math inline">\(^a\)</span> part of this formula is the bit, which corresponds to the squared deviation associated with level <span class="math inline">\(r\)</span>. All that this formula does is calculate this squared deviation for all <span class="math inline">\(R\)</span> levels of the factor, add them up, and then multiply the result by <span class="math inline">\(N \times C\)</span>. The reason for this last part is that there are multiple cells in our design that have level <span class="math inline">\(r\)</span> on Factor A. In fact, there are <span class="math inline">\(C\)</span> of them, one corresponding to each possible level of Factor B. For instance, in our example there are two different cells in the design corresponding to the anxifree drug: one for people with no.therapy and one for the CBT group. Not only that, within each of these cells there are <span class="math inline">\(N\)</span> observations. So, if we want to convert our <span class="math inline">\(SS\)</span> value into a quantity that calculates the between groups sum of squares on a “per observation” basis, we have to multiply by <span class="math inline">\(N \times C\)</span>. The formula for Factor B is of course the same thing, just with some subscripts shuffled around: <span class="math display">\[SS_B=(N \times R)\sum_{c=1}^C (\bar{Y}_{.c}-\bar{Y}_{..})^2\]</span> Now that we have these formulas we can check them against the jamovi output from the earlier section. Once again, a dedicated spreadsheet programme is helpful for these sorts of calculations, so please have a go yourself. You can also take a look at the version I did in Excel in the file <em>clinicaltrial_factorialanova.xls</em>. First, let’s calculate the sum of squares associated with the main effect of drug. There are a total of <span class="math inline">\(N = 3\)</span> people in each group and <span class="math inline">\(C = 2\)</span> different types of therapy. Or, to put it another way, there are <span class="math inline">\(3 \times 2 = 6\)</span> people who received any particular drug. When we do these calculations in a spreadsheet programme, we get a value of 3.45 for the sum of squares associated with the main effect of drug. Not surprisingly, this is the same number that you get when you look up the <span class="math inline">\(SS\)</span> value for the drugs factor in the ANOVA table that I presented earlier, in <a href="#fig-fig14-3">Figure&nbsp;<span>14.3</span></a>. <br> We can repeat the same kind of calculation for the effect of therapy. Again there are <span class="math inline">\(N = 3\)</span> people in each group, but since there are <span class="math inline">\(R = 3\)</span> different drugs, this time around we note that there are <span class="math inline">\(3 \times 3 = 9\)</span> people who received CBT and an additional 9 people who received the placebo. So our calculation in this case gives us a value of <span class="math inline">\(0.47\)</span> for the sum of squares associated with the main effect of therapy. Once again, we are not surprised to see that our calculations are identical to the ANOVA output in <a href="#fig-fig14-3">Figure&nbsp;<span>14.3</span></a>. <br> So that’s how you calculate the <span class="math inline">\(SS\)</span> values for the two main effects. These <span class="math inline">\(SS\)</span> values are analogous to the between group sum of squares values that we calculated when doing one-way ANOVA in <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>Chapter&nbsp;13</span></a>. However, it’s not a good idea to think of them as between groups <span class="math inline">\(SS\)</span> values anymore, just because we have two different grouping variables and it’s easy to get confused. In order to construct an <span class="math inline">\(F\)</span> test, however, we also need to calculate the within groups sum of squares. In keeping with the terminology that we used in <a href="12-Correlation-and-linear-regression.html"><span>Chapter&nbsp;12</span></a> and the terminology that jamovi uses when printing out the ANOVA table, I’ll start referring to the within groups <span class="math inline">\(SS\)</span> value as the residual sum of squares <span class="math inline">\(SS_R\)</span>. <br> The easiest way to think about the residual <span class="math inline">\(SS\)</span> values in this context, I think, is to think of it as the leftover variation in the outcome variable after you take into account the differences in the marginal means (i.e., after you remove <span class="math inline">\(SS_A\)</span> and <span class="math inline">\(SS_B\)</span>). What I mean by that is we can start by calculating the total sum of squares, which I’ll label <span class="math inline">\(SS_T\)</span> . The formula for this is pretty much the same as it was for one-way ANOVA. We take the difference between each observation <span class="math inline">\(Y_{rci}\)</span> and the grand mean <span class="math inline">\(\hat{Y}_{..}\)</span>, square the differences, and add them all: <span class="math display">\[SS_T=\sum_{r=1}^R \sum_{c=1}^C \sum_{i=1}^N (Y_{rci}-\bar{Y}_{..})^2\]</span> The “triple summation” here looks more complicated than it is. In the first two summations, we’re summing across all levels of Factor A (i.e., over all possible rows r in our table) and across all levels of Factor B (i.e., all possible columns <span class="math inline">\(c\)</span>). Each rc combination corresponds to a single group and each group contains <span class="math inline">\(N\)</span> people, so we have to sum across all those people (i.e., all <span class="math inline">\(i\)</span> values) too. In other words, all we’re doing here is summing across all observations in the data set (i.e., all possible <span class="math inline">\(rci\)</span> combinations). At this point, we know the total variability of the outcome variable <span class="math inline">\(SST\)</span> , and we know how much of that variability can be attributed to Factor A (<span class="math inline">\(SS_A\)</span>) and how much of it can be attributed to Factor B (<span class="math inline">\(SS_B\)</span>). The residual sum of squares is thus defined to be the variability in <span class="math inline">\(Y\)</span> that can’t be attributed to either of our two factors (or their interaction if you also calculate the interaction effect, which is the default in jamovi). In other words: <span class="math display">\[SS_R=SS_T-(SS_A+SS_B)\]</span> Of course, there is a formula that you can use to calculate the residual <span class="math inline">\(SS\)</span> directly, but I think that it makes more conceptual sense to think of it like this. The whole point of calling it a residual is that it’s the leftover variation, and the formula above makes that clear. I should also note that, in keeping with the terminology used in the regression chapter, it is commonplace to refer to <span class="math inline">\(SS_A + SS_B\)</span> as the variance attributable to the “ANOVA model”, denoted <span class="math inline">\(SSM\)</span>, and so we often say that the total sum of squares is equal to the model sum of squares plus the residual sum of squares. Later on in this chapter we’ll see that this isn’t just a surface similarity: ANOVA and regression are actually the same thing under the hood. In any case, it’s probably worth taking a moment to check that we can calculate <span class="math inline">\(SS_R\)</span> using this formula and verify that we do obtain the same answer that jamovi produces in its ANOVA table. The calculations are pretty straightforward when done in a spreadsheet (see the clinicaltrial_factorialanova.xls file). <br> — <br> <span class="math inline">\(^a\)</span>English translation: “least tedious”.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>As a consequence, the way that the idea of an interaction effect is formalised in terms of null and alternative hypotheses is slightly difficult, and I’m guessing that a lot of readers of this book probably won’t be all that interested. Even so, I’ll try to give the basic idea here. To start with, we need to be a little more explicit about our main effects. Consider the main effect of Factor A (drug in our running example). We originally formulated this in terms of the null hypothesis that the two marginal means <span class="math inline">\(\mu_r\)</span>. are all equal to each other. Obviously, if all of these are equal to each other, then they must also be equal to the grand mean <span class="math inline">\(\mu_{..}\)</span> as well, right? So what we can do is define the effect of Factor A at level <span class="math inline">\(r\)</span> to be equal to the difference between the marginal mean <span class="math inline">\(\mu_{r.}\)</span> and the grand mean <span class="math inline">\(\mu_{..}\)</span>. Let’s denote this effect by <span class="math inline">\(\alpha_r\)</span>, and note that: <span class="math display">\[\alpha_r=\mu_{r.}-\mu_{..}\]</span> Now, by definition all of the <span class="math inline">\(\alpha_r\)</span> values must sum to zero, for the same reason that the average of the marginal means <span class="math inline">\(\mu_c\)</span> must be the grand mean <span class="math inline">\(\mu_{..}\)</span>. We can similarly define the effect of Factor B at level <span class="math inline">\(i\)</span> to be the difference between the column marginal mean <span class="math inline">\(\mu_{.c}\)</span> and the grand mean <span class="math inline">\(\mu_{..}\)</span>: <span class="math display">\[\beta_c=\mu_{.c}-\mu_{..}\]</span> and once again, these <span class="math inline">\(\beta_c\)</span> values must sum to zero. The reason that statisticians sometimes like to talk about the main effects in terms of these <span class="math inline">\(\alpha_r\)</span> and <span class="math inline">\(\beta_c\)</span> values is that it allows them to be precise about what it means to say that there is no interaction effect. If there is no interaction at all, then these <span class="math inline">\(\alpha_r\)</span> and <span class="math inline">\(\beta_c\)</span> values will perfectly describe the group means <span class="math inline">\(\mu_{rc}\)</span>. Specifically, it means that: <span class="math display">\[\mu_{rc}=\mu_{..}+\alpha_{r}+\beta_{c}\]</span> That is, there’s nothing special about the group means that you couldn’t predict perfectly by knowing all the marginal means. And that’s our null hypothesis, right there. The alternative hypothesis is that: <span class="math display">\[\mu_{rc} \neq \mu_{..}+\alpha_{r}+\beta_{c}\]</span> for at least one group <span class="math inline">\(rc\)</span> in our table. However, statisticians often like to write this slightly differently. They’ll usually define the specific interaction associated with group <span class="math inline">\(rc\)</span> to be some number, awkwardly referred to as <span class="math inline">\((\alpha \beta)_{rc}\)</span>, and then they will say that the alternative hypothesis is that: <span class="math display">\[\mu_{rc}=\mu_{..} +\alpha_{r} +\beta_{c} + (\alpha \beta )_{rc}\]</span> where <span class="math inline">\((\alpha \beta)_{rc}\)</span> is non-zero for at least one group. This notation is kind of ugly to look at, but it is handy as we’ll see when discussing how to calculate the sum of squares. How should we calculate the sum of squares for the interaction terms, <span class="math inline">\(SS_{A:B}\)</span>? Well, first off, it helps to notice how we have just defined the interaction effect in terms of the extent to which the actual group means differ from what you’d expect by just looking at the marginal means. Of course, all of those formulas refer to population parameters rather than sample statistics, so we don’t actually know what they are. However, we can estimate them by using sample means in place of population means. So for Factor A, a good way to estimate the main effect at level <span class="math inline">\(r\)</span> is as the difference between the sample marginal mean <span class="math inline">\(\bar{Y}_{rc}\)</span> and the sample grand mean <span class="math inline">\(\bar{Y}_{..}\)</span>. That is, we would use this as our estimate of the effect: <span class="math display">\[\hat{\alpha}_r = bar{Y}_{r.}-\bar{Y}_{..}\]</span> Similarly, our estimate of the main effect of Factor B at level <span class="math inline">\(c\)</span> can be defined as: <span class="math display">\[\hat{\beta}_{c}=\hat{Y}_{.c}-\bar{Y}_{..}\]</span> Now, if you go back to the formulas that I used to describe the <span class="math inline">\(SS\)</span> values for the two main effects, you’ll notice that these effect terms are exactly the quantities that we were squaring and summing! So, what’s the analog of this for interaction terms? The answer to this can be found by first rearranging the formula for the group means <span class="math inline">\(\mu_{rc}\)</span> under the alternative hypothesis, so that we get this: <span class="math display">\[\begin{aligned} (\alpha \beta)_{rc} &amp; = \mu_{rc} - \mu_{..} - \alpha_r - \beta_c \\ &amp; = \mu_{rc} - \mu_{..} - (\mu_{r.}-\mu_{..})-(\mu_{.c}-\mu_{..}) \\ &amp; = \mu_{rc} - \mu_{r.} - \mu_{.c} +\mu_{..} \end{aligned}\]</span> So, once again if we substitute our sample statistics in place of the population means, we get the following as our estimate of the interaction effect for group <span class="math inline">\(rc\)</span>, which is: <span class="math display">\[(\hat{\alpha \beta})_{rc}=\bar{Y}_{rc}-\hat{Y}_{r.}-\bar{Y}_{.c}+\bar{Y}_{..}\]</span> Now all we have to do is sum all of these estimates across all <span class="math inline">\(R\)</span> levels of Factor A and all <span class="math inline">\(C\)</span> levels of Factor B, and we obtain the following formula for the sum of squares associated with the interaction as a whole: <span class="math display">\[SS_{A:B}=N \sum_{r=1}^R \sum_{c=1}^C (\bar{Y}_{rc}-\bar{Y}_{r.}-\bar{Y}_{.c}+\bar{Y}_{..})^2\]</span> where we multiply by <span class="math inline">\(N\)</span> because there are <span class="math inline">\(N\)</span> observations in each of the groups, and we want our <span class="math inline">\(SS\)</span> values to reflect the variation among observations accounted for by the interaction, not the variation among groups. Now that we have a formula for calculating <span class="math inline">\(SS_{A:B}\)</span>, it’s important to recognise that the interaction term is part of the model (of course), so the total sum of squares associated with the model, <span class="math inline">\(SSM\)</span>, is now equal to the sum of the three relevant <span class="math inline">\(SS\)</span> values, <span class="math inline">\(SS_A + SS_B + SS_{A:B}\)</span>. The residual sum of squares <span class="math inline">\(SSR\)</span> is still defined as the leftover variation, namely <span class="math inline">\(SS_T - SS_M\)</span>, but now that we have the interaction term this becomes: <span class="math display">\[SS_R=SS_T-(SS_A+SS_B+SS_{A:B})\]</span> As a consequence, the residual sum of squares <span class="math inline">\(SS_R\)</span> will be smaller than in our original ANOVA that didn’t include interactions.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>You may have spotted this already when looking at the main effects analysis in jamovi that we described earlier. For the purpose of the explanation in this book I removed the interaction component from the earlier model to keep things clean and simple.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>This chapter seems to be setting a new record for the number of different things that the letter R can stand for. So far we have R referring to the software package, the number of rows in our table of means, the residuals in the model, and now the correlation coefficient in a regression. Sorry. We clearly don’t have enough letters in the alphabet. However, I’ve tried pretty hard to be clear on which thing R is referring to in each case.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Implausibly large, I would think. The artificiality of this data set is really starting to show!<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>What’s the difference between treatment and simple contrasts, I hear you ask? Well, as a basic example consider a gender main effect, with <span class="math inline">\(m=0\)</span> and <span class="math inline">\(f=1\)</span>. The coefficient corresponding to the treatment contrast will measure the difference in mean between females and males, and the intercept would be the mean of the males. However, with a simple contrast, i.e., <span class="math inline">\(m=-1\)</span> and <span class="math inline">\(f=1\)</span>, the intercept is the average of the means and the main effect is the difference of each group mean from the intercept.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>If, for instance, you actually find yourself interested to know if Group A is significantly different from the mean of Group B and Group C, then you need to use a different tool (e.g., Scheffe’s method, which is more conservative, and beyond the scope of this book). However, in most cases you probably are interested in pairwise group differences, so Tukey’s HSD is a pretty useful thing to know about.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>This discrepancy in standard deviations might (and should) make you wonder if we have a violation of the homogeneity of variance assumption. I’ll leave it as an exercise for the reader to double check this using the Levene test option.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>Actually, this is a bit of a lie. ANOVAs can vary in other ways besides the ones I’ve discussed in this book. For instance, I’ve completely ignored the difference between fixed-effect models in which the levels of a factor are “fixed” by the experimenter or the world, and random-effect models in which the levels are random samples from a larger population of possible levels (this book only covers fixed-effect models). Don’t make the mistake of thinking that this book, or any other one, will tell you “everything you need to know” about statistics, any more than a single book could possibly tell you everything you need to know about psychology, physics or philosophy. Life is too complicated for that to ever be true. This isn’t a cause for despair, though. Most researchers get by with a basic working knowledge of ANOVA that doesn’t go any further than this book does. I just want you to keep in mind that this book is only the beginning of a very long story, not the whole story.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>Or, at the very least, rarely of interest.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>However, in jamovi the results for type III sum of squares ANOVA are the same regardless of the contrast selected, so jamovi is obviously doing something different!<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>Note, of course, that this does depend on the model that the user specified. If the original ANOVA model doesn’t contain an interaction term for <span class="math inline">\(B \times C\)</span>, then obviously it won’t appear in either the null or the alternative. But that’s true for types I, II and III. They never include any terms that you didn’t include, but they make different choices about how to construct tests for the ones that you did include.<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p>I find it amusing to note that the default in <span class="math inline">\(R\)</span> is type I and the default in SPSS and jamovi is type III. Neither of these appeals to me all that much. Relatedly, I find it depressing that almost nobody in the psychological literature ever bothers to report which type is used either. The only way I can ever make any sense of what people typically report is to try to guess from auxiliary cues which software they were using, and to assume that they never changed the default settings. Please don’t do this! Now that you know about these issues make sure you indicate what software you used, and if you’re reporting ANOVA results for unbalanced data, then specify what Type of tests you ran, specify order information if you’ve done type I tests and specify contrasts if you’ve done type III tests. Or, even better, do hypotheses tests that correspond to things you really care about and then report those!<a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/davidfoxcroft\.github\.io\/lsj-book\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./13-Comparing-several-means-one-way-ANOVA.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Comparing several means (one-way ANOVA)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./15-Factor-Analysis.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Factor Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left"><a href="https://learnstatswithjamovi.com">learning statistics with jamovi</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>



</body></html>